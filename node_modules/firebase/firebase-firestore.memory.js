!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t=t||self).firebase)}(this,function(af){"use strict";try{(function(){af=af&&Object.prototype.hasOwnProperty.call(af,"default")?af.default:af;var t,u,e,i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function d(t,s,u,a){return new(u=u||Promise)(function(n,e){function i(t){try{o(a.next(t))}catch(t){e(t)}}function r(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(i,r)}o((a=a.apply(t,s||[])).next())})}function y(n,i){var r,o,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=i.call(n,u)}catch(t){e=[6,t],o=0}finally{r=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,r++)i[r]=o[s];return i}(e=u=u||{})[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";u.DEBUG,u.VERBOSE,u.INFO,u.WARN,u.ERROR,u.SILENT;function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var r=(new Date).toISOString(),o=h[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+r+"]  "+t.name+":"],n))}}var a=u.INFO,h=((t={})[u.DEBUG]="log",t[u.VERBOSE]="log",t[u.INFO]="info",t[u.WARN]="warn",t[u.ERROR]="error",t),c=(Object.defineProperty(f.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in u))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!0,configurable:!0}),f.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.DEBUG],t)),this._logHandler.apply(this,s([this,u.DEBUG],t))},f.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.VERBOSE],t)),this._logHandler.apply(this,s([this,u.VERBOSE],t))},f.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.INFO],t)),this._logHandler.apply(this,s([this,u.INFO],t))},f.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.WARN],t)),this._logHandler.apply(this,s([this,u.WARN],t))},f.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,u.ERROR],t)),this._logHandler.apply(this,s([this,u.ERROR],t))},f);function f(t){this.name=t,this._logLevel=a,this._logHandler=o,this._userLogHandler=null}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var l,v=(n(g,l=Error),g);function g(t,e){var n=l.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,m.prototype.create),n}var m=(w.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i,r=e[0]||{},o=this.service+"/"+t,s=this.errors[t],u=s?(i=r,s.replace(b,function(t,e){var n=i[e];return null!=n?n.toString():"<"+e+"?>"})):"Error",a=this.serviceName+": "+u+" ("+o+").",h=new v(o,a),c=0,f=Object.keys(r);c<f.length;c++){var l=f[c];"_"!==l.slice(-1)&&(l in h&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),h[l]=r[l])}return h},w);function w(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var b=/\{\$([^}]+)}/g,E=(I.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},I.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},I.prototype.setServiceProps=function(t){return this.serviceProps=t,this},I);function I(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var A,N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},_=_||{},S=N||self;function R(){}function k(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function D(t){var e=k(t);return"array"==e||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var L="closure_uid_"+(1e9*Math.random()>>>0),V=0;function M(t,e,n){return t.call.apply(t.bind,arguments)}function P(e,n,t){if(!e)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,i),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function C(t,e,n){return(C=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?M:P).apply(null,arguments)}function U(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var j=Date.now||function(){return+new Date};function q(t,e){function n(){}n.prototype=e.prototype,t.M=e.prototype,t.prototype=new n,t.prototype.constructor=t}function F(){this.j=this.j,this.i=this.i}F.prototype.j=!1,F.prototype.da=function(){if(!this.j&&(this.j=!0,this.C(),0))t=this,Object.prototype.hasOwnProperty.call(t,L)&&t[L]||(t[L]=++V);var t},F.prototype.C=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var x=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},G=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};function B(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function H(t){return/^[\s\xa0]*$/.test(t)}var W,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function X(t,e){return t<e?-1:e<t?1:0}t:{var K=S.navigator;if(K){var J=K.userAgent;if(J){W=J;break t}}W=""}function $(t,e,n){for(var i in t)e.call(n,t[i],i,t)}function Z(t){var e={};for(var n in t)e[n]=t[n];return e}var tt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function et(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<tt.length;o++)n=tt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function nt(t){return nt[" "](t),t}nt[" "]=R;var it,rt,ot=Y(W,"Opera"),st=Y(W,"Trident")||Y(W,"MSIE"),ut=Y(W,"Edge"),at=ut||st,ht=Y(W,"Gecko")&&!(Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge"))&&!(Y(W,"Trident")||Y(W,"MSIE"))&&!Y(W,"Edge"),ct=Y(W.toLowerCase(),"webkit")&&!Y(W,"Edge");function ft(){var t=S.document;return t?t.documentMode:void 0}t:{var lt="",pt=(rt=W,ht?/rv:([^\);]+)(\)|;)/.exec(rt):ut?/Edge\/([\d\.]+)/.exec(rt):st?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(rt):ct?/WebKit\/(\S+)/.exec(rt):ot?/(?:Version)[ \/]?(\S+)/.exec(rt):void 0);if(pt&&(lt=pt?pt[1]:""),st){var dt=ft();if(null!=dt&&dt>parseFloat(lt)){it=String(dt);break t}}it=lt}var yt,vt={};function gt(u){return t=u,e=function(){for(var t=0,e=Q(String(it)).split("."),n=Q(String(u)).split("."),i=Math.max(e.length,n.length),r=0;0==t&&r<i;r++){var o=e[r]||"",s=n[r]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=X(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||X(0==o[2].length,0==s[2].length)||X(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t},n=vt,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t);var t,e,n}if(S.document&&st){var mt=ft();yt=mt||(parseInt(it,10)||void 0)}else yt=void 0;var wt=yt,bt=!st||9<=Number(wt),Et=st&&!gt("9"),It=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",R,e),S.removeEventListener("test",R,e)}catch(t){}return t}();function Tt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function At(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(ht){t:{try{nt(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Nt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Tt.prototype.b=function(){this.defaultPrevented=!0},q(At,Tt);var Nt={2:"touch",3:"pen",4:"mouse"};At.prototype.b=function(){At.M.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Et)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var _t="closure_listenable_"+(1e6*Math.random()|0),St=0;function Rt(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.aa=r,this.key=++St,this.V=this.X=!1}function kt(t){t.V=!0,t.listener=null,t.proxy=null,t.src=null,t.aa=null}function Dt(t){this.src=t,this.a={},this.b=0}function Ot(t,e){var n=e.type;if(n in t.a){var i,r=t.a[n],o=x(r,e);(i=0<=o)&&Array.prototype.splice.call(r,o,1),i&&(kt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function Lt(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.V&&o.listener==e&&o.capture==!!n&&o.aa==i)return r}return-1}Dt.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Lt(t,e,i,r);return-1<s?(e=t[s],n||(e.X=!1)):((e=new Rt(e,this.src,o,!!i,r)).X=n,t.push(e)),e};var Vt="closure_lm_"+(1e6*Math.random()|0),Mt={};function Pt(t,e,n,i,r){if(i&&i.once)return function t(e,n,i,r,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);return null}i=Bt(i);return e&&e[_t]?e.sa(n,i,O(r)?!!r.capture:!!r,o):Ct(e,n,i,!0,r,o)}(t,e,n,i,r);if(Array.isArray(e)){for(var o=0;o<e.length;o++)Pt(t,e[o],n,i,r);return null}return n=Bt(n),t&&t[_t]?t.ra(e,n,O(i)?!!i.capture:!!i,r):Ct(t,e,n,!1,i,r)}function Ct(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var s=O(r)?!!r.capture:!!r;if(s&&!bt)return null;var u,a,h=xt(t);if(h||(t[Vt]=h=new Dt(t)),(n=h.add(e,n,i,s,o)).proxy)return n;if(u=Ft,i=a=bt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=i).src=t,i.listener=n,t.addEventListener)It||(r=s),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(jt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function Ut(t){if("number"!=typeof t&&t&&!t.V){var e=t.src;if(e&&e[_t])Ot(e.c,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(jt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=xt(e))?(Ot(n,t),0==n.b&&(n.src=null,e[Vt]=null)):kt(t)}}}function jt(t){return t in Mt?Mt[t]:Mt[t]="on"+t}function qt(t,e){var n=t.listener,i=t.aa||t.src;return t.X&&Ut(t),n.call(i,e)}function Ft(t,e){if(t.V)return!0;if(bt)return qt(t,new At(e,this));if(!e)t:{e=["window","event"];for(var n=S,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}return qt(t,e=new At(e,this))}function xt(t){return(t=t[Vt])instanceof Dt?t:null}var Gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Bt(e){return"function"==k(e)?e:(e[Gt]||(e[Gt]=function(t){return e.handleEvent(t)}),e[Gt])}function zt(){F.call(this),this.c=new Dt(this),(this.J=this).A=null}function Ht(t,e,n,i){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.V&&s.capture==n){var u=s.listener,a=s.aa||s.src;s.X&&Ot(t.c,s),r=!1!==u.call(a,i)&&r}}return r&&!i.defaultPrevented}q(zt,F),zt.prototype[_t]=!0,(A=zt.prototype).addEventListener=function(t,e,n,i){Pt(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){!function t(e,n,i,r,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],i,r,o);else r=O(r)?!!r.capture:!!r,i=Bt(i),e&&e[_t]?(e=e.c,(n=String(n).toString())in e.a&&-1<(i=Lt(s=e.a[n],i,r,o))&&(kt(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&xt(e))&&(n=e.a[n.toString()],e=-1,n&&(e=Lt(n,i,r,o)),(i=-1<e?n[e]:null)&&Ut(i))}(this,t,e,n,i)},A.dispatchEvent=function(t){var e,n=this.A;if(n)for(e=[];n;n=n.A)e.push(n);n=this.J;var i=t.type||t;if("string"==typeof t)t=new Tt(t,n);else if(t instanceof Tt)t.target=t.target||n;else{var r=t;et(t=new Tt(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];r=Ht(s,i,!0,t)&&r}if(r=Ht(s=t.a=n,i,!0,t)&&r,r=Ht(s,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=Ht(s=t.a=e[o],i,!1,t)&&r;return r},A.C=function(){if(zt.M.C.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)kt(n[i]);delete e.a[t],e.b--}}this.A=null},A.ra=function(t,e,n,i){return this.c.add(String(t),e,!1,n,i)},A.sa=function(t,e,n,i){return this.c.add(String(t),e,!0,n,i)};var Wt=S.JSON.stringify;function Qt(){this.b=this.a=null}var Yt,Xt=(Kt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Kt(function(){return new Jt},function(t){t.reset()},100));function Kt(t,e,n){this.f=n,this.c=t,this.g=e,this.b=0,this.a=null}function Jt(){this.next=this.b=this.a=null}function $t(t){S.setTimeout(function(){throw t},0)}function Zt(t,e){var n;Yt||(n=S.Promise.resolve(void 0),Yt=function(){n.then(ne)}),te||(Yt(),te=!0),ee.add(t,e)}Qt.prototype.add=function(t,e){var n=Xt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Jt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var te=!(Jt.prototype.reset=function(){this.next=this.b=this.a=null}),ee=new Qt;function ne(){for(var t;i=n=void 0,i=null,(n=ee).a&&(i=n.a,n.a=n.a.next,n.a||(n.b=null),i.next=null),t=i;){try{t.a.call(t.b)}catch(t){$t(t)}var e=Xt;e.g(t),e.b<e.f&&(e.b++,t.next=e.a,e.a=t)}var n,i;te=!1}function ie(t,e){zt.call(this),this.b=t||1,this.a=e||S,this.f=C(this.Ua,this),this.g=j()}function re(t){t.Z=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function oe(t,e,n){if("function"==k(t))n&&(t=C(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=C(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}function se(t,e,n){F.call(this),this.f=null!=n?C(t,n):t,this.c=e,this.b=C(this.Pa,this),this.a=[]}function ue(t){t.T=oe(t.b,t.c),t.f.apply(null,t.a)}function ae(t){F.call(this),this.b=t,this.a={}}q(ie,zt),(A=ie.prototype).Z=!1,A.L=null,A.Ua=function(){if(this.Z){var t=j()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.Z&&(re(this),this.start()))}},A.start=function(){this.Z=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=j())},A.C=function(){ie.M.C.call(this),re(this),delete this.a},q(se,F),(A=se.prototype).ba=!1,A.T=null,A.Ia=function(t){this.a=arguments,this.T?this.ba=!0:ue(this)},A.C=function(){se.M.C.call(this),this.T&&(S.clearTimeout(this.T),this.T=null,this.ba=!1,this.a=[])},A.Pa=function(){this.T=null,this.ba&&(this.ba=!1,ue(this))},q(ae,F);var he=[];function ce(t,e,n,i){Array.isArray(n)||(n&&(he[0]=n.toString()),n=he);for(var r=0;r<n.length;r++){var o=Pt(e,n[r],i||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function fe(t){$(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ut(t)},t),t.a={}}function le(){}ae.prototype.C=function(){ae.M.C.call(this),fe(this)},ae.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pe=null;function de(){return pe=pe||new zt}function ye(t){Tt.call(this,"serverreachability",t)}function ve(t){var e=de();e.dispatchEvent(new ye(e))}function ge(t){Tt.call(this,"statevent",t)}function me(t){var e=de();e.dispatchEvent(new ge(e))}function we(t){Tt.call(this,"timingevent",t)}function be(t,e){if("function"!=k(t))throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}q(ye,Tt),q(ge,Tt),q(we,Tt);var Ee={NO_ERROR:0,Va:1,bb:2,ab:3,Ya:4,$a:5,cb:6,za:7,TIMEOUT:8,gb:9},Ie={Xa:"complete",kb:"success",Aa:"error",za:"abort",ib:"ready",jb:"readystatechange",TIMEOUT:"timeout",eb:"incrementaldata",hb:"progress",Za:"downloadprogress",lb:"uploadprogress"};function Te(){}function Ae(t){var e;return(e=t.a)||(e=t.a={}),e}function Ne(){}Te.prototype.a=null;var _e,Se={OPEN:"a",Wa:"b",Aa:"c",fb:"d"};function Re(){Tt.call(this,"d")}function ke(){Tt.call(this,"c")}function De(){}function Oe(t,e,n){this.g=t,this.W=e,this.U=n||1,this.G=new ae(this),this.N=Le,t=at?125:void 0,this.O=new ie(t),this.m=null,this.b=!1,this.j=this.A=this.f=this.B=this.s=this.P=this.h=null,this.i=[],this.a=null,this.w=0,this.c=this.v=null,this.H=-1,this.l=!1,this.J=0,this.D=null,this.o=this.R=this.F=!1}q(Re,Tt),q(ke,Tt),q(De,Te),_e=new De;var Le=45e3,Ve={},Me={};function Pe(t,e,n){t.B=1,t.f=rn(Je(e)),t.j=n,t.F=!0,Ce(t,null)}function Ce(t,e){t.s=j(),qe(t),t.A=Je(t.f);var n=t.A,i=t.U;Array.isArray(i)||(i=[String(i)]),gn(n.b,"t",i),t.w=0,t.a=ai(t.g,t.g.w?e:null),0<t.J&&(t.D=new se(C(t.ya,t,t.a),t.J)),ce(t.G,t.a,"readystatechange",t.Sa),e=t.m?Z(t.m):{},t.j?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.$(t.A,t.v,t.j,e)):(t.v="GET",t.a.$(t.A,t.v,null,e)),ve(1)}function Ue(t,e,n){for(var i=!0;!t.l&&t.w<n.length;){var r=je(t,n);if(r==Me){4==e&&(t.c=4,me(14),i=!1);break}if(r==Ve){t.c=4,me(15),i=!1;break}ze(t,r)}4==e&&0==n.length&&(t.c=1,me(16),i=!1),t.b=t.b&&i,i||(Be(t),Ge(t))}function je(t,e){var n=t.w,i=e.indexOf("\n",n);return-1==i?Me:(n=Number(e.substring(n,i)),isNaN(n)?Ve:(i+=1)+n>e.length?Me:(e=e.substr(i,n),t.w=i+n,e))}function qe(t){t.P=j()+t.N,Fe(t,t.N)}function Fe(t,e){if(null!=t.h)throw Error("WatchDog timer not null");t.h=be(C(t.Qa,t),e)}function xe(t){t.h&&(S.clearTimeout(t.h),t.h=null)}function Ge(t){0==t.g.u||t.l||ii(t.g,t)}function Be(t){xe(t);var e=t.D;e&&"function"==typeof e.da&&e.da(),t.D=null,re(t.O),fe(t.G),t.a&&(e=t.a,t.a=null,e.abort(),e.da())}function ze(t,e){try{var n=t.g;if(0!=n.u&&(n.a==t||An(n.b,t)))if(n.A=t.H,!t.o&&An(n.b,t)&&3==n.u){try{var i=n.ja.a.parse(e)}catch(t){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.i){if(n.a){if(!(n.a.s+3e3<t.s))break t;ni(n),n.a.cancel(),n.a=null}ei(n),me(18)}}else n.ia=r[1],0<n.ia-n.G&&r[2]<37500&&n.U&&0==n.m&&!n.l&&(n.l=be(C(n.Na,n),6e3));if(Tn(n.b)<=1&&n.O){try{n.O()}catch(t){}n.O=void 0}}else oi(n,11)}else if(!t.o&&n.a!=t||ni(n),!H(e))for(e=i=n.ja.a.parse(e),i=0;i<e.length;i++)if(r=e[i],n.G=r[0],r=r[1],2==n.u)if("c"==r[0]){n.B=r[1],n.R=r[2];var o=r[3];null!=o&&(n.oa=o);var s=r[5];null!=s&&"number"==typeof s&&0<s&&(n.D=1.5*s);var u=n,a=t.a;if(a){var h=a.a?a.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var c=u.b;!c.a&&(Y(h,"spdy")||Y(h,"quic")||Y(h,"h2"))&&(c.f=c.g,c.a=new Set,c.b&&(Nn(c,c.b),c.b=null))}if(u.s){var f=a.a?a.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.ha=f,nn(u.v,u.s,f))}}n.u=3,n.c&&n.c.na();var l=t;if((u=n).ea=ui(u,u.w?u.R:null,u.P),l.o){_n(u.b,l);var p=l,d=u.D;d&&p.setTimeout(d),p.h&&(xe(p),qe(p)),u.a=l}else ti(u);0<n.f.length&&Kn(n)}else"stop"!=r[0]&&"close"!=r[0]||oi(n,7);else 3==n.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?oi(n,7):Qn(n):"noop"!=r[0]&&n.c&&n.c.ma(r),n.m=0);ve(4)}catch(t){}}function He(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)G(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.I&&"function"==typeof t.I)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;r=(i=function(t){if(t.I&&"function"==typeof t.I)return t.I();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t)).length;for(var o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}}function We(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof We)for(n=t.K(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Ye(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Ye(r,i=t.a[e])||(r[t.a[n++]=i]=1),e++;t.a.length=n}}function Ye(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(A=Oe.prototype).setTimeout=function(t){this.N=t},A.Sa=function(t){t=t.target;var e=this.D;e&&3==Bn(t)?e.Ia():this.ya(t)},A.ya=function(t){try{if(t==this.a)t:{var e=Bn(this.a),n=this.a.qa(),i=this.a.S();if(!(e<3||3==e&&!at&&!this.a.Y())){this.l||4!=e||7==n||ve(8==n||i<=0?3:2),xe(this);var r=this.a.S();this.H=r;var o=this.a.Y();if(this.b=200==r){if(this.R&&!this.o){e:{if(this.a){var s,u=this.a;if((s=u.a?u.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,me(12),Be(this),Ge(this);break t}this.o=!0,ze(this,a)}this.F?(Ue(this,e,o),at&&this.b&&3==e&&(ce(this.G,this.O,"tick",this.Ra),this.O.start())):ze(this,o),4==e&&Be(this),this.b&&!this.l&&(4==e?ii(this.g,this):(this.b=!1,qe(this)))}else 400==r&&0<o.indexOf("Unknown SID")?(this.c=3,me(12)):(this.c=0,me(13)),Be(this),Ge(this)}}}catch(t){}},A.Ra=function(){if(this.a){var t=Bn(this.a),e=this.a.Y();this.w<e.length&&(xe(this),Ue(this,t,e),this.b&&4!=t&&qe(this))}},A.cancel=function(){this.l=!0,Be(this)},A.Qa=function(){this.h=null;var t=j();0<=t-this.P?(2!=this.B&&(ve(3),me(17)),Be(this),this.c=2,Ge(this)):Fe(this,this.P-t)},(A=We.prototype).I=function(){Qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},A.K=function(){return Qe(this),this.a.concat()},A.get=function(t,e){return Ye(this.b,t)?this.b[t]:e},A.set=function(t,e){Ye(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},A.forEach=function(t,e){for(var n=this.K(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke){this.a=void 0!==e?e:t.a,$e(this,t.f),this.j=t.j,Ze(this,t.c),tn(this,t.h),this.g=t.g,e=t.b;var n=new pn;n.c=e.c,e.a&&(n.a=new We(e.a),n.b=e.b),en(this,n),this.i=t.i}else t&&(n=String(t).match(Xe))?(this.a=!!e,$e(this,n[1]||"",!0),this.j=on(n[2]||""),Ze(this,n[3]||"",!0),tn(this,n[4]),this.g=on(n[5]||"",!0),en(this,n[6]||"",!0),this.i=on(n[7]||"")):(this.a=!!e,this.b=new pn(null,this.a))}function Je(t){return new Ke(t)}function $e(t,e,n){t.f=n?on(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ze(t,e,n){t.c=n?on(e,!0):e}function tn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function en(t,e,n){var i,r;e instanceof pn?(t.b=e,i=t.b,(r=t.a)&&!i.f&&(dn(i),i.c=null,i.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(yn(this,e),gn(this,n,t))},i)),i.f=r):(n||(e=sn(e,fn)),t.b=new pn(e,t.a))}function nn(t,e,n){t.b.set(e,n)}function rn(t){return nn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^j()).toString(36)),t}function on(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function sn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,un),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function un(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(sn(e,an,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(sn(e,an,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(sn(n,"/"==n.charAt(0)?cn:hn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",sn(n,ln)),t.join("")};var an=/[#\/\?@]/g,hn=/[#\?:]/g,cn=/[#\?]/g,fn=/[#\?@]/g,ln=/#/g;function pn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function dn(n){n.a||(n.a=new We,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function yn(t,e){dn(t),e=mn(t,e),Ye(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Ye((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Qe(t)))}function vn(t,e){return dn(t),e=mn(t,e),Ye(t.a.b,e)}function gn(t,e,n){yn(t,e),0<n.length&&(t.c=null,t.a.set(mn(t,e),z(n)),t.b+=n.length)}function mn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function wn(t,e){this.b=t,this.a=e}function bn(t){this.g=t||En,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ca&&S.ca.ua&&S.ca.ua()&&S.ca.ua().mb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}(A=pn.prototype).add=function(t,e){dn(this),this.c=null,t=mn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},A.forEach=function(n,i){dn(this),this.a.forEach(function(t,e){G(t,function(t){n.call(i,t,e,this)},this)},this)},A.K=function(){dn(this);for(var t=this.a.I(),e=this.a.K(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},A.I=function(t){dn(this);var e=[];if("string"==typeof t)vn(this,t)&&(e=B(e,this.a.get(mn(this,t))));else{t=this.a.I();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},A.set=function(t,e){return dn(this),this.c=null,vn(this,t=mn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},A.get=function(t,e){return t&&0<(t=this.I(t)).length?String(t[0]):e},A.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.I(i);for(var o=0;o<i.length;o++){var s=r;""!==i[o]&&(s+="="+encodeURIComponent(String(i[o]))),t.push(s)}}return this.c=t.join("&")};var En=10;function In(t){return t.b||t.a&&t.a.size>=t.f}function Tn(t){return t.b?1:t.a?t.a.size:0}function An(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function Nn(t,e){t.a?t.a.add(e):t.b=e}function _n(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Sn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.i);if(null==t.a||0===t.a.size)return z(t.c);var i=t.c;try{for(var r=T(t.a.values()),o=r.next();!o.done;o=r.next()){var s=o.value;i=i.concat(s.i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return i}function Rn(){}function kn(){this.a=new Rn}function Dn(t,i,e){var r=e||"";try{He(t,function(t,e){var n=t;O(t)&&(n=Wt(t)),i.push(r+e+"="+encodeURIComponent(n))})}catch(t){throw i.push(r+"type="+encodeURIComponent("_badmap")),t}}function On(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(t){}}bn.prototype.cancel=function(){var e,t;if(this.c=Sn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),i=n.next();!i.done;i=n.next()){i.value.cancel()}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},Rn.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},Rn.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var Ln=S.JSON.parse;function Vn(t){zt.call(this),this.headers=new We,this.G=t||null,this.b=!1,this.s=this.a=null,this.D="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.H=Mn,this.B=this.F=!1}q(Vn,zt);var Mn="",Pn=/^https?$/i,Cn=["POST","PUT"];function Un(t){return"content-type"==t.toLowerCase()}function jn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,qn(t),xn(t)}function qn(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Fn(t){if(t.b&&void 0!==_&&(!t.s[1]||4!=Bn(t)||2!=t.S()))if(t.l&&4==Bn(t))oe(t.va,0,t);else if(t.dispatchEvent("readystatechange"),4==Bn(t)){t.b=!1;try{var e,n=t.S();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1}if(!(e=i)){var r;if(r=0===n){var o=String(t.D).match(Xe)[1]||null;if(!o&&S.self&&S.self.location){var s=S.self.location.protocol;o=s.substr(0,s.length-1)}r=!Pn.test(o?o.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var u=2<Bn(t)?t.a.statusText:""}catch(t){u=""}t.f=u+" ["+t.S()+"]",qn(t)}}finally{xn(t)}}}function xn(t,e){if(t.a){Gn(t);var n=t.a,i=t.s[0]?R:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(t){}}}function Gn(t){t.a&&t.B&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function Bn(t){return t.a?t.a.readyState:0}function zn(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}var r;i||(r="",$(n,function(t,e){r+=e,r+=":",r+=t,r+="\r\n"}),n=r,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):nn(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Wn(t){this.f=[],this.R=this.ea=this.v=this.P=this.a=this.ha=this.s=this.N=this.h=this.F=this.j=null,this.Fa=this.H=0,this.Ca=Hn("failFast",!1,t),this.U=this.l=this.i=this.g=this.c=null,this.W=!0,this.A=this.ia=this.G=-1,this.J=this.m=this.o=0,this.Ba=Hn("baseRetryDelayMs",5e3,t),this.Ga=Hn("retryDelaySeedMs",1e4,t),this.Da=Hn("forwardChannelMaxRetries",2,t),this.ga=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.Ea=t&&t.nb||void 0,this.D=void 0,this.w=t&&t.supportsCrossDomainXhr||!1,this.B="",this.b=new bn(t&&t.concurrentRequestLimit),this.ja=new kn,this.fa=t&&t.fastHandshake||!1,t&&t.forceLongPolling&&(this.W=!1),this.O=void 0}function Qn(t){if(Yn(t),3==t.u){var e=t.H++,n=Je(t.v);nn(n,"SID",t.B),nn(n,"RID",e),nn(n,"TYPE","terminate"),$n(t,n),(e=new Oe(t,e,void 0)).B=2,e.f=rn(Je(n)),n=!1,S.navigator&&S.navigator.sendBeacon&&(n=S.navigator.sendBeacon(e.f.toString(),"")),!n&&S.Image&&((new Image).src=e.f,n=!0),n||(e.a=ai(e.g,null),e.a.$(e.f)),e.s=j(),qe(e)}si(t)}function Yn(t){t.a&&(t.a.cancel(),t.a=null),t.i&&(S.clearTimeout(t.i),t.i=null),ni(t),t.b.cancel(),t.g&&("number"==typeof t.g&&S.clearTimeout(t.g),t.g=null)}function Xn(t,e){t.f.push(new wn(t.Fa++,e)),3==t.u&&Kn(t)}function Kn(t){In(t.b)||t.g||(t.g=!0,Zt(t.xa,t),t.o=0)}function Jn(t,e){var n;n=e?e.W:t.H++;var i=Je(t.v);nn(i,"SID",t.B),nn(i,"RID",n),nn(i,"AID",t.G),$n(t,i),t.h&&t.j&&zn(i,t.h,t.j),n=new Oe(t,n,t.o+1),null===t.h&&(n.m=t.j),e&&(t.f=e.i.concat(t.f)),e=Zn(t,n,1e3),n.setTimeout(Math.round(.5*t.ga)+Math.round(.5*t.ga*Math.random())),Nn(t.b,n),Pe(n,i,e)}function $n(t,n){t.c&&He({},function(t,e){nn(n,e,t)})}function Zn(t,e,n){n=Math.min(t.f.length,n);var i=t.c?C(t.c.Ha,t.c,t):null;t:for(var r=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=r[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var h=r[a].b,c=r[a].a;if((h-=o)<0)o=Math.max(0,r[a].b-100),u=!1;else try{Dn(c,s,"req"+h+"_")}catch(t){i&&i(c)}}if(u){i=s.join("&");break t}}return t=t.f.splice(0,n),e.i=t,i}function ti(t){t.a||t.i||(t.J=1,Zt(t.wa,t),t.m=0)}function ei(t){return!(t.a||t.i||3<=t.m)&&(t.J++,t.i=be(C(t.wa,t),ri(t,t.m)),t.m++,1)}function ni(t){null!=t.l&&(S.clearTimeout(t.l),t.l=null)}function ii(t,e){var n=null;if(t.a==e){ni(t),t.a=null;var i=2}else{if(!An(t.b,e))return;n=e.i,_n(t.b,e),i=1}if(t.A=e.H,0!=t.u)if(e.b)if(1==i){n=e.j?e.j.length:0,e=j()-e.s;var r=t.o;(i=de()).dispatchEvent(new we(i)),Kn(t)}else ti(t);else if(3==(r=e.c)||0==r&&0<t.A||!(1==i&&function(t,e){if(!(Tn(t.b)>=t.b.f-(t.g?1:0))){if(t.g)return t.f=e.i.concat(t.f),1;if(!(1==t.u||2==t.u||t.o>=(t.Ca?0:t.Da)))return t.g=be(C(t.xa,t,e),ri(t,t.o)),t.o++,1}}(t,e)||2==i&&ei(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),r){case 1:oi(t,5);break;case 4:oi(t,10);break;case 3:oi(t,6);break;default:oi(t,2)}}function ri(t,e){var n=t.Ba+Math.floor(Math.random()*t.Ga);return t.c||(n*=2),n*e}function oi(t,e){if(2==e){var n=null;t.c&&(n=null);var i=C(t.Ta,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||$e(n,"https"),rn(n)),function(t,e){var n=new le;if(S.Image){var i=new Image;i.onload=U(On,n,i,"TestLoadImage: loaded",!0,e),i.onerror=U(On,n,i,"TestLoadImage: error",!1,e),i.onabort=U(On,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=U(On,n,i,"TestLoadImage: timeout",!1,e),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=t}else e(!1)}(n.toString(),i)}else me(2);t.u=0,t.c&&t.c.la(e),si(t),Yn(t)}function si(t){t.u=0,t.A=-1,t.c&&(0==Sn(t.b).length&&0==t.f.length||(t.b.c.length=0,z(t.f),t.f.length=0),t.c.ka())}function ui(t,e,n){var i,r,o,s,u,a,h=(i=n)instanceof Ke?Je(i):new Ke(i,void 0);if(""!=h.c)e&&Ze(h,e+"."+h.c),tn(h,h.h);else{var c=S.location;r=c.protocol,o=e?e+"."+c.hostname:c.hostname,s=+c.port,u=n,a=new Ke(null,void 0),r&&$e(a,r),o&&Ze(a,o),s&&tn(a,s),u&&(a.g=u),h=a}return t.N&&$(t.N,function(t,e){nn(h,e,t)}),e=t.s,n=t.ha,e&&n&&nn(h,e,n),nn(h,"VER",t.oa),$n(t,h),h}function ai(t,e){if(e&&!t.w)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Vn(t.Ea)).F=t.w,e}function hi(){}function ci(){if(st&&!(10<=Number(wt)))throw Error("Environmental error: no available transport.")}function fi(t,e){zt.call(this),this.a=new Wn(e),this.l=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.j=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.pa&&(t?t["X-WebChannel-Client-Profile"]=e.pa:t={"X-WebChannel-Client-Profile":e.pa}),this.a.F=t,(t=e&&e.httpHeadersOverwriteParam)&&!H(t)&&(this.a.h=t),this.h=e&&e.supportsCrossDomainXhr||!1,this.g=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!H(e)&&(this.a.s=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new di(this)}function li(t){Re.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function pi(){ke.call(this),this.status=1}function di(t){this.a=t}(A=Vn.prototype).$=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+t);e=e?e.toUpperCase():"GET",this.D=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.G?Ae(this.G):Ae(_e),this.a.onreadystatechange=C(this.va,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void jn(this,t)}t=n||"";var r,o=new We(this.headers);i&&He(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=Un,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.K()),n=S.FormData&&t instanceof S.FormData,0<=x(Cn,e)&&!i&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.H&&(this.a.responseType=this.H),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Gn(this),0<this.o&&((this.B=(r=this.a,st&&gt(9)&&"number"==typeof r.timeout&&void 0!==r.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=C(this.ta,this)):this.m=oe(this.ta,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){jn(this,t)}},A.ta=function(){void 0!==_&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},A.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),xn(this))},A.C=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),xn(this,!0)),Vn.M.C.call(this)},A.va=function(){this.j||(this.w||this.l||this.g?Fn(this):this.Oa())},A.Oa=function(){Fn(this)},A.S=function(){try{return 2<Bn(this)?this.a.status:-1}catch(t){return-1}},A.Y=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},A.Ja=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Ln(e)}},A.qa=function(){return this.h},A.Ma=function(){return"string"==typeof this.f?this.f:String(this.f)},(A=Wn.prototype).oa=8,A.u=1,A.xa=function(t){if(this.g)if(this.g=null,1==this.u){if(!t){this.H=Math.floor(1e5*Math.random()),t=this.H++;var e,n=new Oe(this,t,void 0),i=this.j;if(this.F&&(i?et(i=Z(i),this.F):i=this.F),null===this.h&&(n.m=i),this.fa)t:{for(var r=e=0;r<this.f.length;r++){var o=this.f[r];if("__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o=o.length:o=void 0,void 0===o)break;if(4096<(e+=o)){e=r;break t}if(4096===e||r===this.f.length-1){e=r+1;break t}}e=1e3}else e=1e3;e=Zn(this,n,e),nn(r=Je(this.v),"RID",t),nn(r,"CVER",22),this.s&&nn(r,"X-HTTP-Session-Id",this.s),$n(this,r),this.h&&i&&zn(r,this.h,i),Nn(this.b,n),this.fa?(nn(r,"$req",e),nn(r,"SID","null"),n.R=!0,Pe(n,r,null)):Pe(n,r,e),this.u=2}}else 3==this.u&&(t?Jn(this,t):0==this.f.length||In(this.b)||Jn(this))},A.wa=function(){this.i=null,this.a=new Oe(this,"rpc",this.J),null===this.h&&(this.a.m=this.j),this.a.J=0;var t=Je(this.ea);nn(t,"RID","rpc"),nn(t,"SID",this.B),nn(t,"CI",this.U?"0":"1"),nn(t,"AID",this.G),$n(this,t),nn(t,"TYPE","xmlhttp"),this.h&&this.j&&zn(t,this.h,this.j),this.D&&this.a.setTimeout(this.D);var e=this.a,n=this.R;e.B=1,e.f=rn(Je(t)),e.j=null,e.F=!0,Ce(e,n)},A.Na=function(){null!=this.l&&(this.l=null,this.a.cancel(),this.a=null,ei(this),me(19))},A.Ta=function(t){me(t?2:1)},(A=hi.prototype).na=function(){},A.ma=function(){},A.la=function(){},A.ka=function(){},A.Ha=function(){},ci.prototype.a=function(t,e){return new fi(t,e)},q(fi,zt),(A=fi.prototype).addEventListener=function(t,e,n,i){fi.M.addEventListener.call(this,t,e,n,i)},A.removeEventListener=function(t,e,n,i){fi.M.removeEventListener.call(this,t,e,n,i)},A.Ka=function(){this.a.c=this.f,this.h&&(this.a.w=!0);var t=this.a,e=this.l,n=this.b||void 0;me(0),t.P=e,t.N=n||{},t.U=t.W,t.v=ui(t,null,t.P),Kn(t)},A.close=function(){Qn(this.a)},A.La=function(t){if("string"==typeof t){var e={};e.__data__=t,Xn(this.a,e)}else this.g?((e={}).__data__=Wt(t),Xn(this.a,e)):Xn(this.a,t)},A.C=function(){this.a.c=null,delete this.f,Qn(this.a),delete this.a,fi.M.C.call(this)},q(li,Re),q(pi,ke),q(di,hi),di.prototype.na=function(){this.a.dispatchEvent("a")},di.prototype.ma=function(t){this.a.dispatchEvent(new li(t))},di.prototype.la=function(t){this.a.dispatchEvent(new pi)},di.prototype.ka=function(){this.a.dispatchEvent("b")},ci.prototype.createWebChannel=ci.prototype.a,fi.prototype.send=fi.prototype.La,fi.prototype.open=fi.prototype.Ka,fi.prototype.close=fi.prototype.close,Ee.NO_ERROR=0,Ee.TIMEOUT=8,Ee.HTTP_ERROR=6,Ie.COMPLETE="complete",(Ne.EventType=Se).OPEN="a",Se.CLOSE="b",Se.ERROR="c",Se.MESSAGE="d",zt.prototype.listen=zt.prototype.ra,Vn.prototype.listenOnce=Vn.prototype.sa,Vn.prototype.getLastError=Vn.prototype.Ma,Vn.prototype.getLastErrorCode=Vn.prototype.qa,Vn.prototype.getStatus=Vn.prototype.S,Vn.prototype.getResponseJson=Vn.prototype.Ja,Vn.prototype.getResponseText=Vn.prototype.Y,Vn.prototype.send=Vn.prototype.$;var yi={createWebChannelTransport:function(){return new ci},ErrorCode:Ee,EventType:Ie,WebChannel:Ne,XhrIo:Vn},vi=yi.createWebChannelTransport,gi=yi.ErrorCode,mi=yi.EventType,wi=yi.WebChannel,bi=yi.XhrIo,Ei=af.SDK_VERSION,Ii=(Ti.prototype.t=function(){return null!=this.uid},Ti.prototype.s=function(){return this.t()?"uid:"+this.uid:"anonymous-user"},Ti.prototype.isEqual=function(t){return t.uid===this.uid},Ti);function Ti(t){this.uid=t}Ii.UNAUTHENTICATED=new Ii(null),Ii.i=new Ii("google-credentials-uid"),Ii.h=new Ii("first-party-uid");function Ai(t,e){this.user=e,this.type="OAuth",this.o={},this.o.Authorization="Bearer "+t}var Ni,_i,Si={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ri=(n(Hi,_i=Error),Hi),ki=(zi.prototype.getToken=function(){return Promise.resolve(null)},zi.prototype.l=function(){},zi.prototype._=function(t){(this.u=t)(Ii.UNAUTHENTICATED)},zi.prototype.T=function(){this.u=null},zi),Di=(Bi.prototype.getToken=function(){var e=this,n=this.R,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.R!==n)throw new Ri(Si.ABORTED,"getToken aborted due to token change.");return t?($s("string"==typeof t.accessToken),new Ai(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Bi.prototype.l=function(){this.forceRefresh=!0},Bi.prototype._=function(t){this.u=t,this.I&&t(this.currentUser)},Bi.prototype.T=function(){this.auth&&this.auth.removeAuthTokenListener(this.m),this.m=null,this.u=null},Bi.prototype.A=function(){var t=this.auth&&this.auth.getUid();return $s(null===t||"string"==typeof t),new Ii(t)},Bi),Oi=(Object.defineProperty(Gi.prototype,"o",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.P.auth.p([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Gi),Li=(xi.prototype.getToken=function(){return Promise.resolve(new Oi(this.P,this.V))},xi.prototype._=function(t){t(Ii.h)},xi.prototype.T=function(){},xi.prototype.l=function(){},xi),Vi=(Fi.now=function(){return Fi.fromMillis(Date.now())},Fi.fromDate=function(t){return Fi.fromMillis(t.getTime())},Fi.fromMillis=function(t){var e=Math.floor(t/1e3);return new Fi(e,1e6*(t-1e3*e))},Fi.prototype.toDate=function(){return new Date(this.toMillis())},Fi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Fi.prototype.g=function(t){return this.seconds===t.seconds?nu(this.nanoseconds,t.nanoseconds):nu(this.seconds,t.seconds)},Fi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Fi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Fi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},Fi),Mi=(qi.v=function(t){return new qi(t)},qi.min=function(){return new qi(new Vi(0,0))},qi.prototype.S=function(t){return this.timestamp.g(t.timestamp)},qi.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},qi.prototype.C=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},qi.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},qi.prototype.D=function(){return this.timestamp},qi),Pi=(Object.defineProperty(ji.prototype,"length",{get:function(){return this.F},enumerable:!0,configurable:!0}),ji.prototype.isEqual=function(t){return 0===ji.N(this,t)},ji.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof ji?t.forEach(function(t){e.push(t)}):e.push(t),this.$(e)},ji.prototype.limit=function(){return this.offset+this.length},ji.prototype.L=function(t){return t=void 0===t?1:t,this.$(this.segments,this.offset+t,this.length-t)},ji.prototype.k=function(){return this.$(this.segments,this.offset,this.length-1)},ji.prototype.O=function(){return this.segments[this.offset]},ji.prototype.M=function(){return this.get(this.length-1)},ji.prototype.get=function(t){return this.segments[this.offset+t]},ji.prototype.q=function(){return 0===this.length},ji.prototype.B=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ji.prototype.U=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},ji.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},ji.prototype.W=function(){return this.segments.slice(this.offset,this.limit())},ji.N=function(t,e){for(var n=Math.min(t.length,e.length),i=0;i<n;i++){var r=t.get(i),o=e.get(i);if(r<o)return-1;if(o<r)return 1}return t.length<e.length?-1:t.length>e.length?1:0},ji),Ci=(n(Ui,Ni=Pi),Ui.prototype.$=function(t,e,n){return new Ui(t,e,n)},Ui.prototype.j=function(){return this.W().join("/")},Ui.prototype.toString=function(){return this.j()},Ui.G=function(t){if(0<=t.indexOf("//"))throw new Ri(Si.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new Ui(t.split("/").filter(function(t){return 0<t.length}))},Ui);function Ui(){return null!==Ni&&Ni.apply(this,arguments)||this}function ji(t,e,n){void 0===e?e=0:e>t.length&&Js(),void 0===n?n=t.length-e:n>t.length-e&&Js(),this.segments=t,this.offset=e,this.F=n}function qi(t){this.timestamp=t}function Fi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Ri(Si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Ri(Si.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Ri(Si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Ri(Si.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function xi(t,e){this.P=t,this.V=e}function Gi(t,e){this.P=t,this.V=e,this.type="FirstParty",this.user=Ii.h}function Bi(t){var e=this;this.m=null,this.currentUser=Ii.UNAUTHENTICATED,this.I=!1,this.R=0,this.u=null,this.forceRefresh=!1,this.m=function(){e.R++,e.currentUser=e.A(),e.I=!0,e.u&&e.u(e.currentUser)},this.R=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.m):(this.m(null),t.get().then(function(t){e.auth=t,e.m&&e.auth.addAuthTokenListener(e.m)},function(){}))}function zi(){this.u=null}function Hi(t,e){var n=this;return(n=_i.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Ci.H=new Ci([]);var Wi,Qi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Yi=(n(Xi,Wi=Pi),Xi.prototype.$=function(t,e,n){return new Xi(t,e,n)},Xi.K=function(t){return Qi.test(t)},Xi.prototype.j=function(){return this.W().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),Xi.K(t)||(t="`"+t+"`"),t}).join(".")},Xi.prototype.toString=function(){return this.j()},Xi.prototype.Y=function(){return 1===this.length&&"__name__"===this.get(0)},Xi.X=function(){return new Xi(["__name__"])},Xi.J=function(t){for(var e=[],n="",i=0,r=function(){if(0===n.length)throw new Ri(Si.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Ri(Si.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Ri(Si.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,i+=2}else"`"===s?o=!o:"."!==s||o?n+=s:r(),i++}if(r(),o)throw new Ri(Si.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Xi(e)},Xi);function Xi(){return null!==Wi&&Wi.apply(this,arguments)||this}Yi.H=new Yi([]);var Ki=(Ji.Z=function(t){return new Ji(Ci.G(t).L(5))},Ji.prototype.tt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},Ji.prototype.isEqual=function(t){return null!==t&&0===Ci.N(this.path,t.path)},Ji.prototype.toString=function(){return this.path.toString()},Ji.N=function(t,e){return Ci.N(t.path,e.path)},Ji.et=function(t){return t.length%2==0},Ji.st=function(t){return new Ji(new Ci(t.slice()))},Ji);function Ji(t){this.path=t}function $i(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function tr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}Ki.EMPTY=new Ki(new Ci([]));var er=(nr.fromBase64String=function(t){return new nr(Bs.nt().atob(t))},nr.fromUint8Array=function(t){return new nr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},nr.prototype.toBase64=function(){return Bs.nt().btoa(this.it)},nr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.it)},nr.prototype.rt=function(){return 2*this.it.length},nr.prototype.S=function(t){return nu(this.it,t.it)},nr.prototype.isEqual=function(t){return this.it===t.it},nr);function nr(t){this.it=t}function ir(t){return null==t}function rr(t){return-0===t&&1/t==-1/0}function or(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function sr(t){var e=dr(t.mapValue.fields.__local_write_time__.timestampValue);return new Vi(e.seconds,e.nanos)}er.ht=new er("");var ur=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ar(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?or(t)?4:10:Js()}function hr(r,t){var e,n,i,o=ar(r);if(o!==ar(t))return!1;switch(o){case 0:return!0;case 1:return r.booleanValue===t.booleanValue;case 4:return sr(r).isEqual(sr(t));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=dr(r.timestampValue),n=dr(t.timestampValue);return e.seconds===n.seconds&&e.nanos===n.nanos}(t);case 5:return r.stringValue===t.stringValue;case 6:return i=t,vr(r.bytesValue).isEqual(vr(i.bytesValue));case 7:return r.referenceValue===t.referenceValue;case 8:return n=t,yr((e=r).geoPointValue.latitude)===yr(n.geoPointValue.latitude)&&yr(e.geoPointValue.longitude)===yr(n.geoPointValue.longitude);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return yr(t.integerValue)===yr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=yr(t.doubleValue),i=yr(e.doubleValue);return n===i?rr(n)===rr(i):isNaN(n)&&isNaN(i)}return!1}(r,t);case 9:return iu(r.arrayValue.values||[],t.arrayValue.values||[],hr);case 10:return function(t){var e=r.mapValue.fields||{},n=t.mapValue.fields||{};if($i(e)!==$i(n))return!1;for(var i in e)if(e.hasOwnProperty(i)&&(void 0===n[i]||!hr(e[i],n[i])))return!1;return!0}(t);default:return Js()}}function cr(t,e){return void 0!==(t.values||[]).find(function(t){return hr(t,e)})}function fr(t,e){var n,i,r,o,s,u,a,h,c,f,l=ar(t),p=ar(e);if(l!==p)return nu(l,p);switch(l){case 0:return 0;case 1:return nu(t.booleanValue,e.booleanValue);case 2:return h=e,c=yr(t.integerValue||t.doubleValue),f=yr(h.integerValue||h.doubleValue),c<f?-1:f<c?1:c===f?0:isNaN(c)?isNaN(f)?0:-1:1;case 3:return lr(t.timestampValue,e.timestampValue);case 4:return lr(sr(t),sr(e));case 5:return nu(t.stringValue,e.stringValue);case 6:return o=t.bytesValue,s=e.bytesValue,u=vr(o),a=vr(s),u.S(a);case 7:return function(t,e){for(var n=t.split("/"),i=e.split("/"),r=0;r<n.length&&r<i.length;r++){var o=nu(n[r],i[r]);if(0!==o)return o}return nu(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=nu(yr(n.latitude),yr(i.latitude)))?r:nu(yr(n.longitude),yr(i.longitude));case 9:return function(t,e){for(var n=t.values||[],i=e.values||[],r=0;r<n.length&&r<i.length;++r){var o=fr(n[r],i[r]);if(o)return o}return nu(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},i=Object.keys(n),r=e.fields||{},o=Object.keys(r);i.sort(),o.sort();for(var s=0;s<i.length&&s<o.length;++s){var u=nu(i[s],o[s]);if(0!==u)return u;var a=fr(n[i[s]],r[o[s]]);if(0!==a)return a}return nu(i.length,o.length)}(t.mapValue,e.mapValue);default:throw Js()}}function lr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return nu(t,e);var n=dr(t),i=dr(e),r=nu(n.seconds,i.seconds);return 0!==r?r:nu(n.nanos,i.nanos)}function pr(t){return function s(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?"time("+(t=dr(r.timestampValue)).seconds+","+t.nanos+")":"stringValue"in r?r.stringValue:"bytesValue"in r?vr(r.bytesValue).toBase64():"referenceValue"in r?(n=r.referenceValue,Ki.Z(n).toString()):"geoPointValue"in r?"geo("+(e=r.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in r?function(){for(var t="[",e=!0,n=0,i=r.arrayValue.values||[];n<i.length;n++){e?e=!1:t+=",",t+=s(i[n])}return t+"]"}():"mapValue"in r?function(t){for(var e="{",n=!0,i=0,r=Object.keys(t.fields||{}).sort();i<r.length;i++){var o=r[i];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(r.mapValue):Js();var t,e,n}(t)}function dr(t){if($s(!!t),"string"!=typeof t)return{seconds:yr(t.seconds),nanos:yr(t.nanos)};var e=0,n=ur.exec(t);if($s(!!n),n[1]){var i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}var r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}function yr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function vr(t){return"string"==typeof t?er.fromBase64String(t):er.fromUint8Array(t)}function gr(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.j()}}function mr(t){return t&&"integerValue"in t}function wr(t){return!!t&&"arrayValue"in t}function br(t){return t&&"nullValue"in t}function Er(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ir(t){return t&&"mapValue"in t}var Tr=(Ar.prototype.ot=function(t,e){return n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}},t&&(n.fields.__previous_value__=t),{mapValue:n};var n},Ar.prototype.at=function(t,e){return e},Ar.prototype.ut=function(t){return null},Ar.prototype.isEqual=function(t){return t instanceof Ar},Ar);function Ar(){}Tr.instance=new Tr;var Nr=(Dr.prototype.ot=function(t,e){return this.apply(t)},Dr.prototype.at=function(t,e){return this.apply(t)},Dr.prototype.apply=function(t){for(var n=Or(t),e=function(e){n.some(function(t){return hr(t,e)})||n.push(e)},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},Dr.prototype.ut=function(t){return null},Dr.prototype.isEqual=function(t){return t instanceof Dr&&iu(this.elements,t.elements,hr)},Dr),_r=(kr.prototype.ot=function(t,e){return this.apply(t)},kr.prototype.at=function(t,e){return this.apply(t)},kr.prototype.apply=function(t){for(var n=Or(t),e=function(e){n=n.filter(function(t){return!hr(t,e)})},i=0,r=this.elements;i<r.length;i++)e(r[i]);return{arrayValue:{values:n}}},kr.prototype.ut=function(t){return null},kr.prototype.isEqual=function(t){return t instanceof kr&&iu(this.elements,t.elements,hr)},kr),Sr=(Rr.prototype.ot=function(t,e){var n=this.ut(t),i=this.asNumber(n)+this.asNumber(this.ct);return mr(n)&&mr(this.ct)?this.serializer.lt(i):this.serializer._t(i)},Rr.prototype.at=function(t,e){return e},Rr.prototype.ut=function(t){return mr(e=t)||e&&"doubleValue"in e?t:{integerValue:0};var e},Rr.prototype.isEqual=function(t){return t instanceof Rr&&hr(this.ct,t.ct)},Rr.prototype.asNumber=function(t){return yr(t.integerValue||t.doubleValue)},Rr);function Rr(t,e){this.serializer=t,this.ct=e}function kr(t){this.elements=t}function Dr(t){this.elements=t}function Or(t){return wr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Lr(t,e){this.version=t,this.transformResults=e}var Vr,Mr,Pr,Cr,Ur,jr=(oo.prototype.ft=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].B(t))return!0;return!1},oo.prototype.isEqual=function(t){return iu(this.fields,t.fields,function(t,e){return t.isEqual(e)})},oo),qr=(ro.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},ro),Fr=(io.dt=function(){return new io},io.exists=function(t){return new io(void 0,t)},io.updateTime=function(t){return new io(t)},Object.defineProperty(io.prototype,"Tt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),io.prototype.wt=function(t){return void 0!==this.updateTime?t instanceof Eo&&t.version.isEqual(this.updateTime):void 0===this.exists||this.exists===t instanceof Eo},io.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},io),xr=(no.prototype.Et=function(t){},no.It=function(t){return t instanceof Eo?t.version:Mi.min()},no),Gr=(n(eo,Ur=xr),eo.prototype.at=function(t,e){this.Et(t);var n=e.version;return new Eo(this.key,n,this.value,{hasCommittedMutations:!0})},eo.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=xr.It(t);return new Eo(this.key,i,this.value,{At:!0})},eo.prototype.Pt=function(t){return null},eo.prototype.isEqual=function(t){return t instanceof eo&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.Rt.isEqual(t.Rt)},eo),Br=(n(to,Cr=xr),to.prototype.at=function(t,e){if(this.Et(t),!this.Rt.wt(t))return new To(this.key,e.version);var n=this.pt(t);return new Eo(this.key,e.version,n,{hasCommittedMutations:!0})},to.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=xr.It(t),r=this.pt(t);return new Eo(this.key,i,r,{At:!0})},to.prototype.Pt=function(t){return null},to.prototype.isEqual=function(t){return t instanceof to&&this.key.isEqual(t.key)&&this.Vt.isEqual(t.Vt)&&this.Rt.isEqual(t.Rt)},to.prototype.pt=function(t){var e;return e=t instanceof Eo?t.data():Qr.empty(),this.yt(e)},to.prototype.yt=function(t){var n=this,i=new Yr(t);return this.Vt.fields.forEach(function(t){if(!t.q()){var e=n.data.field(t);null!==e?i.set(t,e):i.delete(t)}}),i.gt()},to),zr=(n(Zr,Pr=xr),Zr.prototype.at=function(t,e){if(this.Et(t),$s(null!=e.transformResults),!this.Rt.wt(t))return new To(this.key,e.version);var n=this.bt(t),i=this.vt(t,e.transformResults),r=e.version,o=this.St(n.data(),i);return new Eo(this.key,r,o,{hasCommittedMutations:!0})},Zr.prototype.ot=function(t,e,n){if(this.Et(t),!this.Rt.wt(t))return t;var i=this.bt(t),r=this.Ct(n,t,e),o=this.St(i.data(),r);return new Eo(this.key,i.version,o,{At:!0})},Zr.prototype.Pt=function(t){for(var e=null,n=0,i=this.fieldTransforms;n<i.length;n++){var r=i[n],o=t instanceof Eo?t.field(r.field):void 0,s=r.transform.ut(o||null);null!=s&&(e=null==e?(new Yr).set(r.field,s):e.set(r.field,s))}return e?e.gt():null},Zr.prototype.isEqual=function(t){return t instanceof Zr&&this.key.isEqual(t.key)&&iu(this.fieldTransforms,t.fieldTransforms,function(t,e){return t.isEqual(e)})&&this.Rt.isEqual(t.Rt)},Zr.prototype.bt=function(t){return t},Zr.prototype.vt=function(t,e){var n=[];$s(this.fieldTransforms.length===e.length);for(var i=0;i<e.length;i++){var r=this.fieldTransforms[i],o=r.transform,s=null;t instanceof Eo&&(s=t.field(r.field)),n.push(o.at(s,e[i]))}return n},Zr.prototype.Ct=function(t,e,n){for(var i=[],r=0,o=this.fieldTransforms;r<o.length;r++){var s=o[r],u=s.transform,a=null;e instanceof Eo&&(a=e.field(s.field)),null===a&&n instanceof Eo&&(a=n.field(s.field)),i.push(u.ot(a,t))}return i},Zr.prototype.St=function(t,e){for(var n=new Yr(t),i=0;i<this.fieldTransforms.length;i++){var r=this.fieldTransforms[i].field;n.set(r,e[i])}return n.gt()},Zr),Hr=(n($r,Mr=xr),$r.prototype.at=function(t,e){return this.Et(t),new Io(this.key,e.version,{hasCommittedMutations:!0})},$r.prototype.ot=function(t,e,n){return this.Et(t),this.Rt.wt(t)?new Io(this.key,Mi.min()):t},$r.prototype.Pt=function(t){return null},$r.prototype.isEqual=function(t){return t instanceof $r&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},$r),Wr=(n(Jr,Vr=xr),Jr.prototype.at=function(t,e){Js()},Jr.prototype.ot=function(t,e,n){Js()},Jr.prototype.Pt=function(t){Js()},Jr.prototype.isEqual=function(t){return t instanceof Jr&&this.key.isEqual(t.key)&&this.Rt.isEqual(t.Rt)},Jr),Qr=(Kr.empty=function(){return new Kr({mapValue:{}})},Kr.prototype.field=function(t){if(t.q())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!Ir(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.M()])||null},Kr.prototype.isEqual=function(t){return hr(this.proto,t.proto)},Kr),Yr=(Xr.prototype.set=function(t,e){return this.Nt(t,e),this},Xr.prototype.delete=function(t){return this.Nt(t,null),this},Xr.prototype.Nt=function(t,e){for(var n=this.Ft,i=0;i<t.length-1;++i){var r=t.get(i),o=n.get(r);o instanceof Map||(o=o&&10===ar(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(r,o)),n=o}n.set(t.M(),e)},Xr.prototype.gt=function(){var t=this.$t(Yi.H,this.Ft);return null!=t?new Qr(t):this.Dt},Xr.prototype.$t=function(i,t){var r=this,o=!1,e=this.Dt.field(i),s=Ir(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){if(t instanceof Map){var n=r.$t(i.child(e),t);null!=n&&(s[e]=n,o=!0)}else null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Xr);function Xr(t){void 0===t&&(t=Qr.empty()),this.Dt=t,this.Ft=new Map}function Kr(t){this.proto=t}function Jr(t,e){var n=this;return(n=Vr.call(this)||this).key=t,n.Rt=e,n.type=4,n}function $r(t,e){var n=this;return(n=Mr.call(this)||this).key=t,n.Rt=e,n.type=3,n}function Zr(t,e){var n=this;return(n=Pr.call(this)||this).key=t,n.fieldTransforms=e,n.type=2,n.Rt=Fr.exists(!0),n}function to(t,e,n,i){var r=this;return(r=Cr.call(this)||this).key=t,r.data=e,r.Vt=n,r.Rt=i,r.type=1,r}function eo(t,e,n){var i=this;return(i=Ur.call(this)||this).key=t,i.value=e,i.Rt=n,i.type=0,i}function no(){}function io(t,e){this.updateTime=t,this.exists=e}function ro(t,e){this.field=t,this.transform=e}function oo(t){(this.fields=t).sort(Yi.N)}function so(t){var u=[];return Zi(t.fields||{},function(t,e){var n=new Yi([t]);if(Ir(e)){var i=so(e.mapValue).fields;if(0===i.length)u.push(n);else for(var r=0,o=i;r<o.length;r++){var s=o[r];u.push(n.child(s))}}else u.push(n)}),new jr(u)}function uo(t,e){this.key=t,this.version=e}function ao(t){this.count=t}var ho,co,fo,lo,po,yo,vo,go,mo,wo,bo,Eo=(n(Yo,bo=uo),Yo.prototype.field=function(t){return this.Lt.field(t)},Yo.prototype.data=function(){return this.Lt},Yo.prototype.kt=function(){return this.Lt.proto},Yo.prototype.isEqual=function(t){return t instanceof Yo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.At===t.At&&this.hasCommittedMutations===t.hasCommittedMutations&&this.Lt.isEqual(t.Lt)},Yo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.Lt.toString()+", {hasLocalMutations: "+this.At+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(Yo.prototype,"hasPendingWrites",{get:function(){return this.At||this.hasCommittedMutations},enumerable:!0,configurable:!0}),Yo),Io=(n(Qo,wo=uo),Qo.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Qo.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),Qo.prototype.isEqual=function(t){return t instanceof Qo&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Qo),To=(n(Wo,mo=uo),Wo.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Wo.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),Wo.prototype.isEqual=function(t){return t instanceof Wo&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Wo),Ao=(Ho.prototype.canonicalId=function(){if(null===this.Ot){var t=this.path.j();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:",t+=this.filters.map(function(t){return t.canonicalId()}).join(","),t+="|ob:",t+=this.orderBy.map(function(t){return t.canonicalId()}).join(","),ir(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Ot=t}return this.Ot},Ho.prototype.toString=function(){var t=this.path.j();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),ir(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Ho.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var n=0;n<this.filters.length;n++)if(!this.filters[n].isEqual(t.filters[n]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!!(null!==this.startAt?this.startAt.isEqual(t.startAt):null===t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Ho.prototype.Mt=function(){return Ki.et(this.path)&&null===this.collectionGroup&&0===this.filters.length},Ho),No=(zo.Wt=function(t){return new zo(t)},Object.defineProperty(zo.prototype,"orderBy",{get:function(){if(null===this.Bt){this.Bt=[];var t=this.jt(),e=this.Gt();if(null!==t&&null===e)t.Y()||this.Bt.push(new Vo(t)),this.Bt.push(new Vo(Yi.X(),"asc"));else{for(var n=!1,i=0,r=this.qt;i<r.length;i++){var o=r[i];this.Bt.push(o),o.field.Y()&&(n=!0)}if(!n){var s=0<this.qt.length?this.qt[this.qt.length-1].dir:"asc";this.Bt.push(new Vo(Yi.X(),s))}}}return this.Bt},enumerable:!0,configurable:!0}),zo.prototype.Ht=function(t){var e=this.filters.concat([t]);return new zo(this.path,this.collectionGroup,this.qt.slice(),e,this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.Kt=function(t){var e=this.qt.concat([t]);return new zo(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.zt=function(t){return new zo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),t,"F",this.startAt,this.endAt)},zo.prototype.Yt=function(t){return new zo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),t,"L",this.startAt,this.endAt)},zo.prototype.Xt=function(t){return new zo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),this.limit,this.xt,t,this.endAt)},zo.prototype.Jt=function(t){return new zo(this.path,this.collectionGroup,this.qt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,t)},zo.prototype.Zt=function(t){return new zo(t,null,this.qt.slice(),this.filters.slice(),this.limit,this.xt,this.startAt,this.endAt)},zo.prototype.te=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.qt.length||1===this.qt.length&&this.qt[0].field.Y())},zo.prototype.canonicalId=function(){return this.ee().canonicalId()+"|lt:"+this.xt},zo.prototype.toString=function(){return"Query(target="+this.ee().toString()+"; limitType="+this.xt+")"},zo.prototype.isEqual=function(t){return this.ee().isEqual(t.ee())&&this.xt===t.xt},zo.prototype.se=function(t,e){for(var n=!1,i=0,r=this.orderBy;i<r.length;i++){var o=r[i],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.Y()}return 0},zo.prototype.matches=function(t){return this.ie(t)&&this.ne(t)&&this.re(t)&&this.he(t)},zo.prototype.oe=function(){return!ir(this.limit)&&"F"===this.xt},zo.prototype.ae=function(){return!ir(this.limit)&&"L"===this.xt},zo.prototype.Gt=function(){return 0<this.qt.length?this.qt[0].field:null},zo.prototype.jt=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof _o&&n.ue())return n.field}return null},zo.prototype.ce=function(t){for(var e=0,n=this.filters;e<n.length;e++){var i=n[e];if(i instanceof _o&&0<=t.indexOf(i.op))return i.op}return null},zo.prototype.Mt=function(){return this.ee().Mt()},zo.prototype.le=function(){return null!==this.collectionGroup},zo.prototype.ee=function(){if(!this.Ut)if("F"===this.xt)this.Ut=new Ao(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var i=n[e],r="desc"===i.dir?"asc":"desc";t.push(new Vo(i.field,r))}var o=this.endAt?new Lo(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Lo(this.startAt.position,!this.startAt.before):null;this.Ut=new Ao(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Ut},zo.prototype.ie=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.tt(this.collectionGroup)&&this.path.B(e):Ki.et(this.path)?this.path.isEqual(e):this.path.U(e)},zo.prototype.ne=function(t){for(var e=0,n=this.qt;e<n.length;e++){var i=n[e];if(!i.field.Y()&&null===t.field(i.field))return!1}return!0},zo.prototype.re=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},zo.prototype.he=function(t){return!(this.startAt&&!this.startAt._e(this.orderBy,t)||this.endAt&&this.endAt._e(this.orderBy,t))},zo.prototype.Qt=function(t){},zo),_o=(n(Bo,go=function(){}),Bo.create=function(t,e,n){if(t.Y())return"in"===e?new Ro(t,n):new So(t,e,n);if(br(n)){if("=="!==e)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new Bo(t,e,n)}if(Er(n)){if("=="!==e)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new Bo(t,e,n)}return"array-contains"===e?new ko(t,n):"in"===e?new Do(t,n):"array-contains-any"===e?new Oo(t,n):new Bo(t,e,n)},Bo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&ar(this.value)===ar(e)&&this.fe(fr(e,this.value))},Bo.prototype.fe=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case">":return 0<t;case">=":return 0<=t;default:return Js()}},Bo.prototype.ue=function(){return 0<=["<","<=",">",">="].indexOf(this.op)},Bo.prototype.canonicalId=function(){return this.field.j()+this.op.toString()+pr(this.value)},Bo.prototype.isEqual=function(t){return t instanceof Bo&&this.op===t.op&&this.field.isEqual(t.field)&&hr(this.value,t.value)},Bo.prototype.toString=function(){return this.field.j()+" "+this.op+" "+pr(this.value)},Bo),So=(n(Go,vo=_o),Go.prototype.matches=function(t){var e=Ki.N(t.key,this.key);return this.fe(e)},Go),Ro=(n(xo,yo=_o),xo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},xo),ko=(n(Fo,po=_o),Fo.prototype.matches=function(t){var e=t.field(this.field);return wr(e)&&cr(e.arrayValue,this.value)},Fo),Do=(n(qo,lo=_o),qo.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&cr(this.value.arrayValue,e)},qo),Oo=(n(jo,fo=_o),jo.prototype.matches=function(t){var e=this,n=t.field(this.field);return!(!wr(n)||!n.arrayValue.values)&&n.arrayValue.values.some(function(t){return cr(e.value.arrayValue,t)})},jo),Lo=(Uo.prototype.canonicalId=function(){return(this.before?"b":"a")+":"+this.position.map(function(t){return pr(t)}).join(",")},Uo.prototype._e=function(t,e){for(var n=0,i=0;i<this.position.length;i++){var r=t[i],o=this.position[i];if(n=r.field.Y()?Ki.N(Ki.Z(o.referenceValue),e.key):fr(o,e.field(r.field)),"desc"===r.dir&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Uo.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++)if(!hr(this.position[e],t.position[e]))return!1;return!0},Uo),Vo=(Co.prototype.compare=function(t,e){var n,i,r,o,s=this.de?Ki.N(t.key,e.key):(n=this.field,i=e,r=t.field(n),o=i.field(n),null!==r&&null!==o?fr(r,o):Js());switch(this.dir){case"asc":return s;case"desc":return-1*s;default:return Js()}},Co.prototype.canonicalId=function(){return this.field.j()+this.dir.toString()},Co.prototype.toString=function(){return this.field.j()+" ("+this.dir+")"},Co.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},Co),Mo=(Po.prototype.Ee=function(t){return new Po(this.target,this.targetId,this.Te,t,this.we,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Po.prototype.me=function(t,e){return new Po(this.target,this.targetId,this.Te,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Po.prototype.Ie=function(t){return new Po(this.target,this.targetId,this.Te,this.sequenceNumber,this.we,t,this.resumeToken)},Po);function Po(t,e,n,i,r,o,s){void 0===r&&(r=Mi.min()),void 0===o&&(o=Mi.min()),void 0===s&&(s=er.ht),this.target=t,this.targetId=e,this.Te=n,this.sequenceNumber=i,this.we=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function Co(t,e){this.field=t,void 0===e&&(e="asc"),this.dir=e,this.de=t.Y()}function Uo(t,e){this.position=t,this.before=e}function jo(t,e){return fo.call(this,t,"array-contains-any",e)||this}function qo(t,e){return lo.call(this,t,"in",e)||this}function Fo(t,e){return po.call(this,t,"array-contains",e)||this}function xo(t,e){var n=this;return(n=yo.call(this,t,"in",e)||this).keys=(e.arrayValue.values||[]).map(function(t){return Ki.Z(t.referenceValue)}),n}function Go(t,e,n){var i=this;return(i=vo.call(this,t,e,n)||this).key=Ki.Z(n.referenceValue),i}function Bo(t,e,n){var i=this;return(i=go.call(this)||this).field=t,i.op=e,i.value=n,i}function zo(t,e,n,i,r,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.qt=n,this.filters=i,this.limit=r,this.xt=o,this.startAt=s,this.endAt=u,this.Bt=null,this.Ut=null,this.startAt&&this.Qt(this.startAt),this.endAt&&this.Qt(this.endAt)}function Ho(t,e,n,i,r,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===i&&(i=[]),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=o,this.endAt=s,this.Ot=null}function Wo(){return null!==mo&&mo.apply(this,arguments)||this}function Qo(t,e,n){var i=this;return(i=wo.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),i}function Yo(t,e,n,i){var r=this;return(r=bo.call(this,t,e)||this).Lt=n,r.At=!!i.At,r.hasCommittedMutations=!!i.hasCommittedMutations,r}function Xo(t){switch(t){case Si.OK:return Js();case Si.CANCELLED:case Si.UNKNOWN:case Si.DEADLINE_EXCEEDED:case Si.RESOURCE_EXHAUSTED:case Si.INTERNAL:case Si.UNAVAILABLE:case Si.UNAUTHENTICATED:return;case Si.INVALID_ARGUMENT:case Si.NOT_FOUND:case Si.ALREADY_EXISTS:case Si.PERMISSION_DENIED:case Si.FAILED_PRECONDITION:case Si.ABORTED:case Si.OUT_OF_RANGE:case Si.UNIMPLEMENTED:case Si.DATA_LOSS:return 1;default:return Js()}}function Ko(t){if(void 0===t)return Xs("GRPC error has no .code"),Si.UNKNOWN;switch(t){case ho.OK:return Si.OK;case ho.CANCELLED:return Si.CANCELLED;case ho.UNKNOWN:return Si.UNKNOWN;case ho.DEADLINE_EXCEEDED:return Si.DEADLINE_EXCEEDED;case ho.RESOURCE_EXHAUSTED:return Si.RESOURCE_EXHAUSTED;case ho.INTERNAL:return Si.INTERNAL;case ho.UNAVAILABLE:return Si.UNAVAILABLE;case ho.UNAUTHENTICATED:return Si.UNAUTHENTICATED;case ho.INVALID_ARGUMENT:return Si.INVALID_ARGUMENT;case ho.NOT_FOUND:return Si.NOT_FOUND;case ho.ALREADY_EXISTS:return Si.ALREADY_EXISTS;case ho.PERMISSION_DENIED:return Si.PERMISSION_DENIED;case ho.FAILED_PRECONDITION:return Si.FAILED_PRECONDITION;case ho.ABORTED:return Si.ABORTED;case ho.OUT_OF_RANGE:return Si.OUT_OF_RANGE;case ho.UNIMPLEMENTED:return Si.UNIMPLEMENTED;case ho.DATA_LOSS:return Si.DATA_LOSS;default:return Js()}}(co=ho=ho||{})[co.OK=0]="OK",co[co.CANCELLED=1]="CANCELLED",co[co.UNKNOWN=2]="UNKNOWN",co[co.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",co[co.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",co[co.NOT_FOUND=5]="NOT_FOUND",co[co.ALREADY_EXISTS=6]="ALREADY_EXISTS",co[co.PERMISSION_DENIED=7]="PERMISSION_DENIED",co[co.UNAUTHENTICATED=16]="UNAUTHENTICATED",co[co.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",co[co.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",co[co.ABORTED=10]="ABORTED",co[co.OUT_OF_RANGE=11]="OUT_OF_RANGE",co[co.UNIMPLEMENTED=12]="UNIMPLEMENTED",co[co.INTERNAL=13]="INTERNAL",co[co.UNAVAILABLE=14]="UNAVAILABLE",co[co.DATA_LOSS=15]="DATA_LOSS";var Jo=(ns.prototype.Re=function(t,e){return new ns(this.N,this.root.Re(t,e,this.N).Ae(null,null,Zo.Pe,null,null))},ns.prototype.remove=function(t){return new ns(this.N,this.root.remove(t,this.N).Ae(null,null,Zo.Pe,null,null))},ns.prototype.get=function(t){for(var e=this.root;!e.q();){var n=this.N(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ns.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.q();){var i=this.N(t,n.key);if(0===i)return e+n.left.size;n=i<0?n.left:(e+=n.left.size+1,n.right)}return-1},ns.prototype.q=function(){return this.root.q()},Object.defineProperty(ns.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),ns.prototype.Ve=function(){return this.root.Ve()},ns.prototype.pe=function(){return this.root.pe()},ns.prototype.ye=function(t){return this.root.ye(t)},ns.prototype.forEach=function(n){this.ye(function(t,e){return n(t,e),!1})},ns.prototype.toString=function(){var n=[];return this.ye(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ns.prototype.ge=function(t){return this.root.ge(t)},ns.prototype.be=function(){return new $o(this.root,null,this.N,!1)},ns.prototype.ve=function(t){return new $o(this.root,t,this.N,!1)},ns.prototype.Se=function(){return new $o(this.root,null,this.N,!0)},ns.prototype.Ce=function(t){return new $o(this.root,t,this.N,!0)},ns),$o=(es.prototype.Ne=function(){var t=this.Fe.pop(),e={key:t.key,value:t.value};if(this.De)for(t=t.left;!t.q();)this.Fe.push(t),t=t.right;else for(t=t.right;!t.q();)this.Fe.push(t),t=t.left;return e},es.prototype.$e=function(){return 0<this.Fe.length},es.prototype.Le=function(){if(0===this.Fe.length)return null;var t=this.Fe[this.Fe.length-1];return{key:t.key,value:t.value}},es),Zo=(ts.prototype.Ae=function(t,e,n,i,r){return new ts(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)},ts.prototype.q=function(){return!1},ts.prototype.ye=function(t){return this.left.ye(t)||t(this.key,this.value)||this.right.ye(t)},ts.prototype.ge=function(t){return this.right.ge(t)||t(this.key,this.value)||this.left.ge(t)},ts.prototype.min=function(){return this.left.q()?this:this.left.min()},ts.prototype.Ve=function(){return this.min().key},ts.prototype.pe=function(){return this.right.q()?this.key:this.right.pe()},ts.prototype.Re=function(t,e,n){var i=this,r=n(t,i.key);return(i=r<0?i.Ae(null,null,null,i.left.Re(t,e,n),null):0===r?i.Ae(null,e,null,null,null):i.Ae(null,null,null,null,i.right.Re(t,e,n))).ke()},ts.prototype.Oe=function(){if(this.left.q())return ts.EMPTY;var t=this;return t.left.Me()||t.left.left.Me()||(t=t.qe()),(t=t.Ae(null,null,null,t.left.Oe(),null)).ke()},ts.prototype.remove=function(t,e){var n,i=this;if(e(t,i.key)<0)i.left.q()||i.left.Me()||i.left.left.Me()||(i=i.qe()),i=i.Ae(null,null,null,i.left.remove(t,e),null);else{if(i.left.Me()&&(i=i.xe()),i.right.q()||i.right.Me()||i.right.left.Me()||(i=i.Be()),0===e(t,i.key)){if(i.right.q())return ts.EMPTY;n=i.right.min(),i=i.Ae(n.key,n.value,null,null,i.right.Oe())}i=i.Ae(null,null,null,null,i.right.remove(t,e))}return i.ke()},ts.prototype.Me=function(){return this.color},ts.prototype.ke=function(){var t=this;return t.right.Me()&&!t.left.Me()&&(t=t.Ue()),t.left.Me()&&t.left.left.Me()&&(t=t.xe()),t.left.Me()&&t.right.Me()&&(t=t.Qe()),t},ts.prototype.qe=function(){var t=this.Qe();return t.right.left.Me()&&(t=(t=(t=t.Ae(null,null,null,null,t.right.xe())).Ue()).Qe()),t},ts.prototype.Be=function(){var t=this.Qe();return t.left.left.Me()&&(t=(t=t.xe()).Qe()),t},ts.prototype.Ue=function(){var t=this.Ae(null,null,ts.RED,null,this.right.left);return this.right.Ae(null,null,this.color,t,null)},ts.prototype.xe=function(){var t=this.Ae(null,null,ts.RED,this.left.right,null);return this.left.Ae(null,null,this.color,null,t)},ts.prototype.Qe=function(){var t=this.left.Ae(null,null,!this.left.color,null,null),e=this.right.Ae(null,null,!this.right.color,null,null);return this.Ae(null,null,!this.color,t,e)},ts.prototype.We=function(){var t=this.je();return Math.pow(2,t)<=this.size+1},ts.prototype.je=function(){if(this.Me()&&this.left.Me())throw Js();if(this.right.Me())throw Js();var t=this.left.je();if(t!==this.right.je())throw Js();return t+(this.Me()?0:1)},ts);function ts(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:ts.RED,this.left=null!=i?i:ts.EMPTY,this.right=null!=r?r:ts.EMPTY,this.size=this.left.size+1+this.right.size}function es(t,e,n,i){this.De=i,this.Fe=[];for(var r=1;!t.q();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.De?t.left:t.right;else{if(0===r){this.Fe.push(t);break}this.Fe.push(t),t=this.De?t.right:t.left}}function ns(t,e){this.N=t,this.root=e||Zo.EMPTY}function is(){this.size=0}Zo.EMPTY=null,Zo.RED=!0,Zo.Pe=!1,Zo.EMPTY=(Object.defineProperty(is.prototype,"key",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"value",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"color",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"left",{get:function(){throw Js()},enumerable:!0,configurable:!0}),Object.defineProperty(is.prototype,"right",{get:function(){throw Js()},enumerable:!0,configurable:!0}),is.prototype.Ae=function(t,e,n,i,r){return this},is.prototype.Re=function(t,e,n){return new Zo(t,e)},is.prototype.remove=function(t,e){return this},is.prototype.q=function(){return!0},is.prototype.ye=function(t){return!1},is.prototype.ge=function(t){return!1},is.prototype.Ve=function(){return null},is.prototype.pe=function(){return null},is.prototype.Me=function(){return!1},is.prototype.We=function(){return!0},is.prototype.je=function(){return 0},new is);var rs=(as.prototype.has=function(t){return null!==this.data.get(t)},as.prototype.first=function(){return this.data.Ve()},as.prototype.last=function(){return this.data.pe()},Object.defineProperty(as.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),as.prototype.indexOf=function(t){return this.data.indexOf(t)},as.prototype.forEach=function(n){this.data.ye(function(t,e){return n(t),!1})},as.prototype.Ge=function(t,e){for(var n=this.data.ve(t[0]);n.$e();){var i=n.Ne();if(0<=this.N(i.key,t[1]))return;e(i.key)}},as.prototype.He=function(t,e){var n;for(n=void 0!==e?this.data.ve(e):this.data.be();n.$e();)if(!t(n.Ne().key))return},as.prototype.Ke=function(t){var e=this.data.ve(t);return e.$e()?e.Ne().key:null},as.prototype.be=function(){return new os(this.data.be())},as.prototype.ve=function(t){return new os(this.data.ve(t))},as.prototype.add=function(t){return this.Ae(this.data.remove(t).Re(t,!0))},as.prototype.delete=function(t){return this.has(t)?this.Ae(this.data.remove(t)):this},as.prototype.q=function(){return this.data.q()},as.prototype.ze=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},as.prototype.isEqual=function(t){if(!(t instanceof as))return!1;if(this.size!==t.size)return!1;for(var e=this.data.be(),n=t.data.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(0!==this.N(i,r))return!1}return!0},as.prototype.W=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},as.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},as.prototype.Ae=function(t){var e=new as(this.N);return e.data=t,e},as),os=(us.prototype.Ne=function(){return this.Ye.Ne().key},us.prototype.$e=function(){return this.Ye.$e()},us),ss=new Jo(Ki.N);function us(t){this.Ye=t}function as(t){this.N=t,this.data=new Jo(this.N)}function hs(){return ss}function cs(){return hs()}var fs=new Jo(Ki.N);function ls(){return fs}var ps=new Jo(Ki.N);function ds(){return ps}var ys=new rs(Ki.N);function vs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=ys,i=0,r=t;i<r.length;i++){var o=r[i];n=n.add(o)}return n}var gs=new rs(nu);function ms(){return gs}function ws(t,e,n,i){this.ms=t,this.removedTargetIds=e,this.key=n,this.Is=i}function bs(t,e){this.targetId=t,this.Rs=e}function Es(t,e,n,i){void 0===n&&(n=er.ht),void 0===i&&(i=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}var Is=(Ps.Ze=function(t){return new Ps(t.N)},Ps.prototype.has=function(t){return null!=this.Xe.get(t)},Ps.prototype.get=function(t){return this.Xe.get(t)},Ps.prototype.first=function(){return this.Je.Ve()},Ps.prototype.last=function(){return this.Je.pe()},Ps.prototype.q=function(){return this.Je.q()},Ps.prototype.indexOf=function(t){var e=this.Xe.get(t);return e?this.Je.indexOf(e):-1},Object.defineProperty(Ps.prototype,"size",{get:function(){return this.Je.size},enumerable:!0,configurable:!0}),Ps.prototype.forEach=function(n){this.Je.ye(function(t,e){return n(t),!1})},Ps.prototype.add=function(t){var e=this.delete(t.key);return e.Ae(e.Xe.Re(t.key,t),e.Je.Re(t,null))},Ps.prototype.delete=function(t){var e=this.get(t);return e?this.Ae(this.Xe.remove(t),this.Je.remove(e)):this},Ps.prototype.isEqual=function(t){if(!(t instanceof Ps))return!1;if(this.size!==t.size)return!1;for(var e=this.Je.be(),n=t.Je.be();e.$e();){var i=e.Ne().key,r=n.Ne().key;if(!i.isEqual(r))return!1}return!0},Ps.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Ps.prototype.Ae=function(t,e){var n=new Ps;return n.N=this.N,n.Xe=t,n.Je=e,n},Ps),Ts=(Ms.prototype.track=function(t){var e=t.doc.key,n=this.ts.get(e);!n||0!==t.type&&3===n.type?this.ts=this.ts.Re(e,t):3===t.type&&1!==n.type?this.ts=this.ts.Re(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.ts=this.ts.Re(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.ts=this.ts.remove(e):1===t.type&&2===n.type?this.ts=this.ts.Re(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.ts=this.ts.Re(e,{type:2,doc:t.doc}):Js()},Ms.prototype.es=function(){var n=[];return this.ts.ye(function(t,e){n.push(e)}),n},Ms),As=(Vs.os=function(t,e,n,i){var r=[];return e.forEach(function(t){r.push({type:0,doc:t})}),new Vs(t,e,Is.Ze(e),r,n,i,!0,!1)},Object.defineProperty(Vs.prototype,"hasPendingWrites",{get:function(){return!this.ns.q()},enumerable:!0,configurable:!0}),Vs.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.rs===t.rs&&this.ns.isEqual(t.ns)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.ss.isEqual(t.ss)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0},Vs),Ns=(Ls._s=function(t,e){var n=new Map;return n.set(t,_s.fs(t,e)),new Ls(Mi.min(),n,ms(),hs(),vs())},Ls),_s=(Os.fs=function(t,e){return new Os(er.ht,e,vs(),vs(),vs())},Os),Ss=(Object.defineProperty(Ds.prototype,"ds",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(Ds.prototype,"resumeToken",{get:function(){return this.Vs},enumerable:!0,configurable:!0}),Object.defineProperty(Ds.prototype,"gs",{get:function(){return 0!==this.As},enumerable:!0,configurable:!0}),Object.defineProperty(Ds.prototype,"bs",{get:function(){return this.ys},enumerable:!0,configurable:!0}),Ds.prototype.vs=function(t){0<t.rt()&&(this.ys=!0,this.Vs=t)},Ds.prototype.Ss=function(){var n=vs(),i=vs(),r=vs();return this.Ps.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:i=i.add(t);break;case 1:r=r.add(t);break;default:Js()}}),new _s(this.Vs,this.ps,n,i,r)},Ds.prototype.Cs=function(){this.ys=!1,this.Ps=Us()},Ds.prototype.Ds=function(t,e){this.ys=!0,this.Ps=this.Ps.Re(t,e)},Ds.prototype.Fs=function(t){this.ys=!0,this.Ps=this.Ps.remove(t)},Ds.prototype.Ns=function(){this.As+=1},Ds.prototype.$s=function(){--this.As},Ds.prototype.Ls=function(){this.ys=!0,this.ps=!0},Ds),Rs=(ks.prototype.Bs=function(t){for(var e=0,n=t.ms;e<n.length;e++){var i=n[e];t.Is instanceof Eo?this.Us(i,t.Is):t.Is instanceof Io&&this.Qs(i,t.key,t.Is)}for(var r=0,o=t.removedTargetIds;r<o.length;r++){var s=o[r];this.Qs(s,t.key,t.Is)}},ks.prototype.Ws=function(n){var i=this;this.js(n,function(t){var e=i.Gs(t);switch(n.state){case 0:i.Hs(t)&&e.vs(n.resumeToken);break;case 1:e.$s(),e.gs||e.Cs(),e.vs(n.resumeToken);break;case 2:e.$s(),e.gs||i.removeTarget(t);break;case 3:i.Hs(t)&&(e.Ls(),e.vs(n.resumeToken));break;case 4:i.Hs(t)&&(i.Ks(t),e.vs(n.resumeToken));break;default:Js()}})},ks.prototype.js=function(t,n){var i=this;0<t.targetIds.length?t.targetIds.forEach(n):this.Os.forEach(function(t,e){i.Hs(e)&&n(e)})},ks.prototype.zs=function(t){var e=t.targetId,n=t.Rs.count,i=this.Ys(e);if(i){var r=i.target;if(r.Mt())if(0===n){var o=new Ki(r.path);this.Qs(e,o,new Io(o,Mi.min()))}else $s(1===n);else this.Xs(e)!==n&&(this.Ks(e),this.xs=this.xs.add(e))}},ks.prototype.Js=function(r){var o=this,s=new Map;this.Os.forEach(function(t,e){var n=o.Ys(e);if(n){if(t.ds&&n.target.Mt()){var i=new Ki(n.target.path);null!==o.Ms.get(i)||o.Zs(e,i)||o.Qs(e,i,new Io(i,r))}t.bs&&(s.set(e,t.Ss()),t.Cs())}});var i=vs();this.qs.forEach(function(t,e){var n=!0;e.He(function(t){var e=o.Ys(t);return!e||2===e.Te||(n=!1)}),n&&(i=i.add(t))});var t=new Ns(r,s,this.xs,this.Ms,i);return this.Ms=hs(),this.qs=Cs(),this.xs=new rs(nu),t},ks.prototype.Us=function(t,e){if(this.Hs(t)){var n=this.Zs(t,e.key)?2:0;this.Gs(t).Ds(e.key,n),this.Ms=this.Ms.Re(e.key,e),this.qs=this.qs.Re(e.key,this.ti(e.key).add(t))}},ks.prototype.Qs=function(t,e,n){if(this.Hs(t)){var i=this.Gs(t);this.Zs(t,e)?i.Ds(e,1):i.Fs(e),this.qs=this.qs.Re(e,this.ti(e).delete(t)),n&&(this.Ms=this.Ms.Re(e,n))}},ks.prototype.removeTarget=function(t){this.Os.delete(t)},ks.prototype.Xs=function(t){var e=this.Gs(t).Ss();return this.ks.ei(t).size+e.Ts.size-e.Es.size},ks.prototype.Ns=function(t){this.Gs(t).Ns()},ks.prototype.Gs=function(t){var e=this.Os.get(t);return e||(e=new Ss,this.Os.set(t,e)),e},ks.prototype.ti=function(t){var e=this.qs.get(t);return e||(e=new rs(nu),this.qs=this.qs.Re(t,e)),e},ks.prototype.Hs=function(t){var e=null!==this.Ys(t);return e||Ys("WatchChangeAggregator","Detected inactive target",t),e},ks.prototype.Ys=function(t){var e=this.Os.get(t);return e&&e.gs?null:this.ks.si(t)},ks.prototype.Ks=function(e){var n=this;this.Os.set(e,new Ss),this.ks.ei(e).forEach(function(t){n.Qs(e,t,null)})},ks.prototype.Zs=function(t,e){return this.ks.ei(t).has(e)},ks);function ks(t){this.ks=t,this.Os=new Map,this.Ms=hs(),this.qs=Cs(),this.xs=new rs(nu)}function Ds(){this.As=0,this.Ps=Us(),this.Vs=er.ht,this.ps=!1,this.ys=!0}function Os(t,e,n,i,r){this.resumeToken=t,this.ds=e,this.Ts=n,this.ws=i,this.Es=r}function Ls(t,e,n,i,r){this.we=t,this.as=e,this.us=n,this.cs=i,this.ls=r}function Vs(t,e,n,i,r,o,s,u){this.query=t,this.docs=e,this.ss=n,this.docChanges=i,this.ns=r,this.fromCache=o,this.rs=s,this.hs=u}function Ms(){this.ts=new Jo(Ki.N)}function Ps(n){this.N=n?function(t,e){return n(t,e)||Ki.N(t.key,e.key)}:function(t,e){return Ki.N(t.key,e.key)},this.Xe=ls(),this.Je=new Jo(this.N)}function Cs(){return new Jo(Ki.N)}function Us(){return new Jo(Ki.N)}var js={asc:"ASCENDING",desc:"DESCENDING"},qs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Fs=(xs.prototype.ni=function(t){var e=void 0===t.code?Si.UNKNOWN:Ko(t.code);return new Ri(e,t.message||"")},xs.prototype.ri=function(t){return this.options.hi||ir(t)?t:{value:t}},xs.prototype.oi=function(t){var e;return ir(e="object"==typeof t?t.value:t)?null:e},xs.prototype.lt=function(t){return{integerValue:""+t}},xs.prototype._t=function(t){if(this.options.hi){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rr(t)?"-0":t}},xs.prototype.ai=function(t){return"number"==typeof(e=t)&&Number.isInteger(e)&&!rr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER?this.lt(t):this._t(t);var e},xs.prototype.D=function(t){return this.options.hi?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},xs.prototype.v=function(t){var e=dr(t);return new Vi(e.seconds,e.nanos)},xs.prototype.ui=function(t){return this.options.hi?t.toBase64():t.toUint8Array()},xs.prototype.ci=function(t){return this.options.hi?($s(void 0===t||"string"==typeof t),er.fromBase64String(t||"")):($s(void 0===t||t instanceof Uint8Array),er.fromUint8Array(t||new Uint8Array))},xs.prototype.toVersion=function(t){return this.D(t.D())},xs.prototype.fromVersion=function(t){return $s(!!t),Mi.v(this.v(t))},xs.prototype.li=function(t,e){return this._i(e||this.ii).child("documents").child(t).j()},xs.prototype.fi=function(t){var e=Ci.G(t);return $s(Gs(e)),e},xs.prototype.di=function(t){return this.li(t.path)},xs.prototype.Z=function(t){var e=this.fi(t);return $s(e.get(1)===this.ii.projectId),$s(!e.get(3)&&!this.ii.database||e.get(3)===this.ii.database),new Ki(this.Ti(e))},xs.prototype.wi=function(t){return this.li(t)},xs.prototype.Ei=function(t){var e=this.fi(t);return 4===e.length?Ci.H:this.Ti(e)},Object.defineProperty(xs.prototype,"mi",{get:function(){return new Ci(["projects",this.ii.projectId,"databases",this.ii.database]).j()},enumerable:!0,configurable:!0}),xs.prototype._i=function(t){return new Ci(["projects",t.projectId,"databases",t.database])},xs.prototype.Ti=function(t){return $s(4<t.length&&"documents"===t.get(4)),t.L(5)},xs.prototype.Ii=function(t,e){return{name:this.di(t),fields:e.proto.mapValue.fields}},xs.prototype.Ri=function(t){return{name:this.di(t.key),fields:t.kt().mapValue.fields,updateTime:this.D(t.version.D())}},xs.prototype.Ai=function(t,e){var n=this.Z(t.name),i=this.fromVersion(t.updateTime),r=new Qr({mapValue:{fields:t.fields}});return new Eo(n,i,r,{hasCommittedMutations:!!e})},xs.prototype.Pi=function(t){$s(!!t.found),t.found.name,t.found.updateTime;var e=this.Z(t.found.name),n=this.fromVersion(t.found.updateTime),i=new Qr({mapValue:{fields:t.found.fields}});return new Eo(e,n,i,{})},xs.prototype.Vi=function(t){$s(!!t.missing),$s(!!t.readTime);var e=this.Z(t.missing),n=this.fromVersion(t.readTime);return new Io(e,n)},xs.prototype.pi=function(t){return"found"in t?this.Pi(t):"missing"in t?this.Vi(t):Js()},xs.prototype.yi=function(t){var e;if("targetChange"in t){t.targetChange;var n=this.gi(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],r=this.ci(t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&this.ni(o);e=new Es(n,i,r,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var a=this.Z(u.document.name),h=this.fromVersion(u.document.updateTime),c=new Qr({mapValue:{fields:u.document.fields}}),f=new Eo(a,h,c,{}),l=u.targetIds||[],p=u.removedTargetIds||[];e=new ws(l,p,f.key,f)}else if("documentDelete"in t){t.documentDelete;var d=t.documentDelete;d.document;var y=this.Z(d.document),v=d.readTime?this.fromVersion(d.readTime):Mi.min(),g=new Io(y,v),m=d.removedTargetIds||[];e=new ws([],m,g.key,g)}else if("documentRemove"in t){t.documentRemove;var w=t.documentRemove;w.document;var b=this.Z(w.document),E=w.removedTargetIds||[];e=new ws([],E,b,null)}else{if(!("filter"in t))return Js();t.filter;var I=t.filter;I.targetId;var T=I.count||0,A=new ao(T),N=I.targetId;e=new bs(N,A)}return e},xs.prototype.gi=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Js()},xs.prototype.bi=function(t){if(!("targetChange"in t))return Mi.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length||!e.readTime?Mi.min():this.fromVersion(e.readTime)},xs.prototype.vi=function(t){var e,n=this;if(t instanceof Gr)e={update:this.Ii(t.key,t.value)};else if(t instanceof Hr)e={delete:this.di(t.key)};else if(t instanceof Br)e={update:this.Ii(t.key,t.data),updateMask:this.Si(t.Vt)};else if(t instanceof zr)e={transform:{document:this.di(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.Ci(t)})}};else{if(!(t instanceof Wr))return Js();e={verify:this.di(t.key)}}return t.Rt.Tt||(e.currentDocument=this.Di(t.Rt)),e},xs.prototype.Fi=function(t){var e=this,n=t.currentDocument?this.Ni(t.currentDocument):Fr.dt();if(t.update){t.update.name;var i=this.Z(t.update.name),r=new Qr({mapValue:{fields:t.update.fields}});if(t.updateMask){var o=this.$i(t.updateMask);return new Br(i,r,o,n)}return new Gr(i,r,n)}if(t.delete){var s=this.Z(t.delete);return new Hr(s,n)}if(t.transform){var u=this.Z(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.Li(t)});return $s(!0===n.exists),new zr(u,a)}if(t.verify){var h=this.Z(t.verify);return new Wr(h,n)}return Js()},xs.prototype.Di=function(t){return void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Js()},xs.prototype.Ni=function(t){return void 0!==t.updateTime?Fr.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Fr.exists(t.exists):Fr.dt()},xs.prototype.ki=function(t,e){var n=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);n.isEqual(Mi.min())&&(n=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults),new Lr(n,i)},xs.prototype.Oi=function(t,e){var n=this;return t&&0<t.length?($s(void 0!==e),t.map(function(t){return n.ki(t,e)})):[]},xs.prototype.Ci=function(t){var e=t.transform;if(e instanceof Tr)return{fieldPath:t.field.j(),setToServerValue:"REQUEST_TIME"};if(e instanceof Nr)return{fieldPath:t.field.j(),appendMissingElements:{values:e.elements}};if(e instanceof _r)return{fieldPath:t.field.j(),removeAllFromArray:{values:e.elements}};if(e instanceof Sr)return{fieldPath:t.field.j(),increment:e.ct};throw Js()},xs.prototype.Li=function(t){var e=null;if("setToServerValue"in t)$s("REQUEST_TIME"===t.setToServerValue),e=Tr.instance;else if("appendMissingElements"in t){var n=t.appendMissingElements.values||[];e=new Nr(n)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];e=new _r(i)}else"increment"in t?e=new Sr(this,t.increment):Js();var r=Yi.J(t.fieldPath);return new qr(r,e)},xs.prototype.Mi=function(t){return{documents:[this.wi(t.path)]}},xs.prototype.qi=function(t){$s(1===t.documents.length);var e=t.documents[0];return No.Wt(this.Ei(e)).ee()},xs.prototype.xi=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(e.parent=this.wi(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(e.parent=this.wi(n.k()),e.structuredQuery.from=[{collectionId:n.M()}]);var i=this.Bi(t.filters);i&&(e.structuredQuery.where=i);var r=this.Ui(t.orderBy);r&&(e.structuredQuery.orderBy=r);var o=this.ri(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Qi(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Qi(t.endAt)),e},xs.prototype.Wi=function(t){var e=this.Ei(t.parent),n=t.structuredQuery,i=n.from?n.from.length:0,r=null;if(0<i){$s(1===i);var o=n.from[0];o.allDescendants?r=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.ji(n.where));var u=[];n.orderBy&&(u=this.Gi(n.orderBy));var a=null;n.limit&&(a=this.oi(n.limit));var h=null;n.startAt&&(h=this.Hi(n.startAt));var c=null;return n.endAt&&(c=this.Hi(n.endAt)),new No(e,r,u,s,a,"F",h,c).ee()},xs.prototype.Ki=function(t){var e=this.zi(t.Te);return null==e?null:{"goog-listen-tags":e}},xs.prototype.zi=function(t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Js()}},xs.prototype.ee=function(t){var e,n=t.target;return(e=n.Mt()?{documents:this.Mi(n)}:{query:this.xi(n)}).targetId=t.targetId,0<t.resumeToken.rt()&&(e.resumeToken=this.ui(t.resumeToken)),e},xs.prototype.Bi=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof _o?e.Yi(t):Js()});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},xs.prototype.ji=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.Xi(t)]:void 0!==t.fieldFilter?[this.Ji(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.ji(t)}).reduce(function(t,e){return t.concat(e)}):Js():[]},xs.prototype.Ui=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.Zi(t)})},xs.prototype.Gi=function(t){var e=this;return t.map(function(t){return e.tn(t)})},xs.prototype.Qi=function(t){return{before:t.before,values:t.position}},xs.prototype.Hi=function(t){var e=!!t.before,n=t.values||[];return new Lo(n,e)},xs.prototype.en=function(t){return js[t]},xs.prototype.sn=function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}},xs.prototype.nn=function(t){return qs[t]},xs.prototype.rn=function(t){switch(t){case"EQUAL":return"==";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Js()}},xs.prototype.hn=function(t){return{fieldPath:t.j()}},xs.prototype.on=function(t){return Yi.J(t.fieldPath)},xs.prototype.Zi=function(t){return{field:this.hn(t.field),direction:this.en(t.dir)}},xs.prototype.tn=function(t){return new Vo(this.on(t.field),this.sn(t.direction))},xs.prototype.Ji=function(t){return _o.create(this.on(t.fieldFilter.field),this.rn(t.fieldFilter.op),t.fieldFilter.value)},xs.prototype.Yi=function(t){if("=="===t.op){if(Er(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NAN"}};if(br(t.value))return{unaryFilter:{field:this.hn(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.hn(t.field),op:this.nn(t.op),value:t.value}}},xs.prototype.Xi=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.on(t.unaryFilter.field);return _o.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=this.on(t.unaryFilter.field);return _o.create(n,"==",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Js()}},xs.prototype.Si=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.j())}),{fieldPaths:e}},xs.prototype.$i=function(t){var e=t.fieldPaths||[];return new jr(e.map(function(t){return Yi.J(t)}))},xs);function xs(t,e){this.ii=t,this.options=e}function Gs(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var Bs=(Hs.an=function(t){Hs.platform&&Js(),Hs.platform=t},Hs.nt=function(){return Hs.platform||Js(),Hs.platform},Hs),zs=new c("@firebase/firestore");function Hs(){}function Ws(){return zs.logLevel}function Qs(t){zs.logLevel=t}function Ys(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=u.DEBUG){var i=e.map(Ks);zs.debug.apply(zs,r(["Firestore ("+Ei+"): "+t],i))}}function Xs(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(zs.logLevel<=u.ERROR){var i=e.map(Ks);zs.error.apply(zs,r(["Firestore ("+Ei+"): "+t],i))}}function Ks(t){if("string"==typeof t)return t;var e=Bs.nt();try{return e.un(t)}catch(e){return t}}function Js(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE ("+Ei+") INTERNAL ASSERTION FAILED: "+t;throw Xs(e),new Error(e)}function $s(t){t||Js()}function Zs(t){return t}var tu=(eu.cn=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var i=Bs.nt().ln(40),r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length));return n},eu);function eu(){}function nu(t,e){return t<e?-1:e<t?1:0}function iu(t,n,i){return t.length===n.length&&t.every(function(t,e){return i(t,n[e])})}function ru(t,e,n,i,r){this.ii=t,this.persistenceKey=e,this.host=n,this.ssl=i,this.forceLongPolling=r}var ou=(Object.defineProperty(Au.prototype,"_n",{get:function(){return"(default)"===this.database},enumerable:!0,configurable:!0}),Au.prototype.isEqual=function(t){return t instanceof Au&&t.projectId===this.projectId&&t.database===this.database},Au.prototype.S=function(t){return nu(this.projectId,t.projectId)||nu(this.database,t.database)},Au),su=(Tu.prototype.get=function(t){var e=this.fn(t),n=this.dn[e];if(void 0!==n)for(var i=0,r=n;i<r.length;i++){var o=r[i],s=o[0],u=o[1];if(s.isEqual(t))return u}},Tu.prototype.has=function(t){return void 0!==this.get(t)},Tu.prototype.set=function(t,e){var n=this.fn(t),i=this.dn[n];if(void 0!==i){for(var r=0;r<i.length;r++)if(i[r][0].isEqual(t))return void(i[r]=[t,e]);i.push([t,e])}else this.dn[n]=[[t,e]]},Tu.prototype.delete=function(t){var e=this.fn(t),n=this.dn[e];if(void 0===n)return!1;for(var i=0;i<n.length;i++)if(n[i][0].isEqual(t))return 1===n.length?delete this.dn[e]:n.splice(i,1),!0;return!1},Tu.prototype.forEach=function(u){Zi(this.dn,function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=r[0],s=r[1];u(o,s)}})},Tu.prototype.q=function(){return tr(this.dn)},Tu),uu=(Iu.prototype.at=function(t,e,n){for(var i=n.wn,r=0;r<this.mutations.length;r++){var o=this.mutations[r];if(o.key.isEqual(t)){var s=i[r];e=o.at(e,s)}}return e},Iu.prototype.ot=function(t,e){for(var n=0,i=this.baseMutations;n<i.length;n++){var r=i[n];r.key.isEqual(t)&&(e=r.ot(e,e,this.Tn))}for(var o=e,s=0,u=this.mutations;s<u.length;s++){var a=u[s];a.key.isEqual(t)&&(e=a.ot(e,o,this.Tn))}return e},Iu.prototype.En=function(n){var i=this,r=n;return this.mutations.forEach(function(t){var e=i.ot(t.key,n.get(t.key));e&&(r=r.Re(t.key,e))}),r},Iu.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},vs())},Iu.prototype.isEqual=function(t){return this.batchId===t.batchId&&iu(this.mutations,t.mutations,function(t,e){return t.isEqual(e)})&&iu(this.baseMutations,t.baseMutations,function(t,e){return t.isEqual(e)})},Iu),au=(Eu.from=function(t,e,n,i){$s(t.mutations.length===n.length);for(var r=ds(),o=t.mutations,s=0;s<o.length;s++)r=r.Re(o[s].key,n[s].version);return new Eu(t,e,n,i,r)},Eu),hu=(bu.prototype.q=function(){return this.Rn.q()},bu.prototype.pn=function(t,e){var n=new cu(t,e);this.Rn=this.Rn.add(n),this.Pn=this.Pn.add(n)},bu.prototype.yn=function(t,e){var n=this;t.forEach(function(t){return n.pn(t,e)})},bu.prototype.gn=function(t,e){this.bn(new cu(t,e))},bu.prototype.vn=function(t,e){var n=this;t.forEach(function(t){return n.gn(t,e)})},bu.prototype.Sn=function(t){var e=this,n=Ki.EMPTY,i=new cu(n,t),r=new cu(n,t+1),o=[];return this.Pn.Ge([i,r],function(t){e.bn(t),o.push(t.key)}),o},bu.prototype.Cn=function(){var e=this;this.Rn.forEach(function(t){return e.bn(t)})},bu.prototype.bn=function(t){this.Rn=this.Rn.delete(t),this.Pn=this.Pn.delete(t)},bu.prototype.Dn=function(t){var e=Ki.EMPTY,n=new cu(e,t),i=new cu(e,t+1),r=vs();return this.Pn.Ge([n,i],function(t){r=r.add(t.key)}),r},bu.prototype.Fn=function(t){var e=new cu(t,0),n=this.Rn.Ke(e);return null!==n&&t.isEqual(n.key)},bu),cu=(wu.An=function(t,e){return Ki.N(t.key,e.key)||nu(t.Nn,e.Nn)},wu.Vn=function(t,e){return nu(t.Nn,e.Nn)||Ki.N(t.key,e.key)},wu),fu=(mu.prototype.catch=function(t){return this.next(void 0,t)},mu.prototype.next=function(i,r){var o=this;return this.On&&Js(),this.On=!0,this.kn?this.error?this.Mn(r,this.error):this.qn(i,this.result):new mu(function(e,n){o.$n=function(t){o.qn(i,t).next(e,n)},o.Ln=function(t){o.Mn(r,t).next(e,n)}})},mu.prototype.xn=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},mu.prototype.Bn=function(t){try{var e=t();return e instanceof mu?e:mu.resolve(e)}catch(t){return mu.reject(t)}},mu.prototype.qn=function(t,e){return t?this.Bn(function(){return t(e)}):mu.resolve(e)},mu.prototype.Mn=function(t,e){return t?this.Bn(function(){return t(e)}):mu.reject(e)},mu.resolve=function(n){return new mu(function(t,e){t(n)})},mu.reject=function(n){return new mu(function(t,e){e(n)})},mu.Un=function(t){return new mu(function(e,n){var i=0,r=0,o=!1;t.forEach(function(t){++i,t.next(function(){++r,o&&r===i&&e()},function(t){return n(t)})}),o=!0,r===i&&e()})},mu.Qn=function(t){for(var n=mu.resolve(!1),e=function(e){n=n.next(function(t){return t?mu.resolve(t):e()})},i=0,r=t;i<r.length;i++)e(r[i]);return n},mu.forEach=function(t,n){var i=this,r=[];return t.forEach(function(t,e){r.push(n.call(i,t,e))}),this.Un(r)},mu),lu=(gu.prototype.Hn=function(e,n){var i=this;return this.jn.Kn(e,n).next(function(t){return i.zn(e,n,t)})},gu.prototype.zn=function(t,i,r){return this.Wn.Yn(t,i).next(function(t){for(var e=0,n=r;e<n.length;e++)t=n[e].ot(i,t);return t})},gu.prototype.Xn=function(t,e,r){var o=cs();return e.forEach(function(t,e){for(var n=0,i=r;n<i.length;n++)e=i[n].ot(t,e);o=o.Re(t,e)}),o},gu.prototype.Jn=function(e,t){var n=this;return this.Wn.getEntries(e,t).next(function(t){return n.Zn(e,t)})},gu.prototype.Zn=function(i,r){var o=this;return this.jn.tr(i,r).next(function(t){var e=o.Xn(i,r,t),n=hs();return e.forEach(function(t,e){e=e||new Io(t,Mi.min()),n=n.Re(t,e)}),n})},gu.prototype.er=function(t,e,n){return e.Mt()?this.sr(t,e.path):e.le()?this.ir(t,e,n):this.nr(t,e,n)},gu.prototype.sr=function(t,e){return this.Hn(t,new Ki(e)).next(function(t){var e=ls();return t instanceof Eo&&(e=e.Re(t.key,t)),e})},gu.prototype.ir=function(n,i,r){var o=this,s=i.collectionGroup,u=ls();return this.Gn.rr(n,s).next(function(t){return fu.forEach(t,function(t){var e=i.Zt(t.child(s));return o.nr(n,e,r).next(function(t){t.forEach(function(t,e){u=u.Re(t,e)})})}).next(function(){return u})})},gu.prototype.nr=function(e,n,t){var c,f,i=this;return this.Wn.er(e,n,t).next(function(t){return c=t,i.jn.hr(e,n)}).next(function(t){return f=t,i.or(e,f,c).next(function(t){c=t;for(var e=0,n=f;e<n.length;e++)for(var i=n[e],r=0,o=i.mutations;r<o.length;r++){var s=o[r],u=s.key,a=c.get(u),h=s.ot(a,a,i.Tn);c=h instanceof Eo?c.Re(u,h):c.remove(u)}})}).next(function(){return c.forEach(function(t,e){n.matches(e)||(c=c.remove(t))}),c})},gu.prototype.or=function(t,e,n){for(var i=vs(),r=0,o=e;r<o.length;r++)for(var s=0,u=o[r].mutations;s<u.length;s++){var a=u[s];a instanceof Br&&null===n.get(a.key)&&(i=i.add(a.key))}var h=n;return this.Wn.getEntries(t,i).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Eo&&(h=h.Re(t,e))}),h})},gu),pu=(vu.cr=function(t,e){for(var n=vs(),i=vs(),r=0,o=e.docChanges;r<o.length;r++){var s=o[r];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new vu(t,e.fromCache,n,i)},vu),du=(yu.prototype._r=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},yu.prototype.next=function(){var t=++this.previousValue;return this.dr&&this.dr(t),t},yu);function yu(t,e){var n=this;this.previousValue=t,e&&(e.lr=function(t){return n._r(t)},this.dr=function(t){return e.Tr(t)})}function vu(t,e,n,i){this.targetId=t,this.fromCache=e,this.ar=n,this.ur=i}function gu(t,e,n){this.Wn=t,this.jn=e,this.Gn=n}function mu(t){var e=this;this.$n=null,this.Ln=null,this.result=void 0,this.error=void 0,this.kn=!1,this.On=!1,t(function(t){e.kn=!0,e.result=t,e.$n&&e.$n(t)},function(t){e.kn=!0,e.error=t,e.Ln&&e.Ln(t)})}function wu(t,e){this.key=t,this.Nn=e}function bu(){this.Rn=new rs(cu.An),this.Pn=new rs(cu.Vn)}function Eu(t,e,n,i,r){this.batch=t,this.mn=e,this.wn=n,this.streamToken=i,this.In=r}function Iu(t,e,n,i){this.batchId=t,this.Tn=e,this.baseMutations=n,this.mutations=i}function Tu(t){this.fn=t,this.dn={}}function Au(t,e){this.projectId=t,this.database=e||"(default)"}du.wr=-1;function Nu(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var _u=(Vu.prototype.reset=function(){this.Pr=0},Vu.prototype.yr=function(){this.Pr=this.Ar},Vu.prototype.gr=function(t){var e=this;this.cancel();var n=Math.floor(this.Pr+this.br()),i=Math.max(0,Date.now()-this.pr),r=Math.max(0,n-i);0<r&&Ys("ExponentialBackoff","Backing off for "+r+" ms (base delay: "+this.Pr+" ms, delay with jitter: "+n+" ms, last attempt: "+i+" ms ago)"),this.Vr=this.Er.vr(this.mr,r,function(){return e.pr=Date.now(),t()}),this.Pr*=this.Rr,this.Pr<this.Ir&&(this.Pr=this.Ir),this.Pr>this.Ar&&(this.Pr=this.Ar)},Vu.prototype.cancel=function(){null!==this.Vr&&(this.Vr.cancel(),this.Vr=null)},Vu.prototype.br=function(){return(Math.random()-.5)*this.Pr},Vu),Su=(Lu.Nr=function(t,e,n,i,r){var o=new Lu(t,e,Date.now()+n,i,r);return o.start(n),o},Lu.prototype.start=function(t){var e=this;this.$r=setTimeout(function(){return e.Lr()},t)},Lu.prototype.kr=function(){return this.Lr()},Lu.prototype.cancel=function(t){null!==this.$r&&(this.clearTimeout(),this.Fr.reject(new Ri(Si.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},Lu.prototype.Lr=function(){var e=this;this.Sr.Or(function(){return null!==e.$r?(e.clearTimeout(),e.op().then(function(t){return e.Fr.resolve(t)})):Promise.resolve()})},Lu.prototype.clearTimeout=function(){null!==this.$r&&(this.Dr(this),clearTimeout(this.$r),this.$r=null)},Lu),Ru=(Object.defineProperty(Ou.prototype,"Kr",{get:function(){return this.xr},enumerable:!0,configurable:!0}),Ou.prototype.Or=function(t){this.enqueue(t)},Ou.prototype.zr=function(t){this.Yr(),this.Xr(t)},Ou.prototype.Jr=function(t){return this.Yr(),this.Xr(t)},Ou.prototype.Zr=function(n){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.Yr(),this.xr?[3,2]:(this.xr=!0,(e=Bs.nt().window)&&e.removeEventListener("visibilitychange",this.Gr),[4,this.Jr(n)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},Ou.prototype.enqueue=function(t){return this.Yr(),this.xr?new Promise(function(t){}):this.Xr(t)},Ou.prototype.th=function(r){var t=this;this.Yr(),this.xr||(this.qr=this.qr.then(function(){var n=new Nu,i=function(){return d(t,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,r()];case 1:return t.sent(),n.resolve(),this.jr.reset(),[3,3];case 2:if("IndexedDbTransactionError"!==(e=t.sent()).name)throw n.resolve(),e;return Ys("AsyncQueue","Operation failed with retryable error: "+e),this.jr.gr(i),[3,3];case 3:return[2]}})})};return t.Or(i),n.promise}))},Ou.prototype.Xr=function(t){var e=this,n=this.Mr.then(function(){return e.Qr=!0,t().catch(function(t){throw e.Ur=t,e.Qr=!1,Xs("INTERNAL UNHANDLED ERROR: ",t.stack||t.message||""),t}).then(function(t){return e.Qr=!1,t})});return this.Mr=n},Ou.prototype.vr=function(t,e,n){var i=this;this.Yr(),-1<this.Wr.indexOf(t)&&(e=0);var r=Su.Nr(this,t,e,n,function(t){return i.eh(t)});return this.Br.push(r),r},Ou.prototype.Yr=function(){this.Ur&&Js()},Ou.prototype.sh=function(){},Ou.prototype.ih=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return[4,e=this.Mr];case 1:t.sent(),t.label=2;case 2:if(e!==this.Mr)return[3,0];t.label=3;case 3:return[2]}})})},Ou.prototype.nh=function(t){for(var e=0,n=this.Br;e<n.length;e++)if(n[e].mr===t)return!0;return!1},Ou.prototype.Hr=function(i){var r=this;return this.ih().then(function(){r.Br.sort(function(t,e){return t.Cr-e.Cr});for(var t=0,e=r.Br;t<e.length;t++){var n=e[t];if(n.kr(),"all"!==i&&n.mr===i)break}return r.ih()})},Ou.prototype.rh=function(t){this.Wr.push(t)},Ou.prototype.eh=function(t){var e=this.Br.indexOf(t);this.Br.splice(e,1)},Ou),ku=(Du.uh=function(t){return new Du(t,Du.lh,Du._h)},Du);function Du(t,e,n){this.hh=t,this.oh=e,this.ah=n}function Ou(){var t=this;this.Mr=Promise.resolve(),this.qr=Promise.resolve(),this.xr=!1,this.Br=[],this.Ur=null,this.Qr=!1,this.Wr=[],this.jr=new _u(this,"async_queue_retry"),this.Gr=function(){t.Hr("async_queue_retry")};var e=Bs.nt().window;e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Gr)}function Lu(t,e,n,i,r){this.Sr=t,this.mr=e,this.Cr=n,this.op=i,this.Dr=r,this.Fr=new Nu,this.then=this.Fr.promise.then.bind(this.Fr.promise),this.catch=this.Fr.promise.catch.bind(this.Fr.promise),this.Fr.promise.catch(function(t){})}function Vu(t,e,n,i,r){void 0===n&&(n=1e3),void 0===i&&(i=1.5),void 0===r&&(r=6e4),this.Er=t,this.mr=e,this.Ir=n,this.Rr=i,this.Ar=r,this.Pr=0,this.Vr=null,this.pr=Date.now(),this.reset()}ku.fh=-1,ku.dh=1048576,ku.Th=41943040,ku.lh=10,ku._h=1e3,ku.wh=new ku(ku.Th,ku.lh,ku._h),ku.DISABLED=new ku(ku.fh,0,0);var Mu=(xu.prototype.next=function(){return this.Eh+=2,this.Eh},xu.mh=function(){return new xu(0)},xu.Ih=function(){return new xu(-1)},xu),Pu=(Fu.prototype.Ah=function(t,e){return this.Rh.add(e),fu.resolve()},Fu.prototype.rr=function(t,e){return fu.resolve(this.Rh.getEntries(e))},Fu),Cu=(qu.prototype.add=function(t){var e=t.M(),n=t.k(),i=this.index[e]||new rs(Ci.N),r=!i.has(n);return this.index[e]=i.add(n),r},qu.prototype.has=function(t){var e=t.M(),n=t.k(),i=this.index[e];return i&&i.has(n)},qu.prototype.getEntries=function(t){return(this.index[t]||new rs(Ci.N)).W()},qu),Uu=(ju.prototype.start=function(){return Promise.resolve()},ju.prototype.Oh=function(r){return d(this,void 0,void 0,function(){var e,m,n,i=this;return y(this,function(t){switch(t.label){case 0:return e=this.jn,m=this.$h,[4,this.persistence.runTransaction("Handle user change","readonly",function(v){var g;return i.jn.Mh(v).next(function(t){return g=t,e=i.persistence.Sh(r),m=new lu(i.Ch,e,i.persistence.Lh()),e.Mh(v)}).next(function(t){for(var e=[],n=[],i=vs(),r=0,o=g;r<o.length;r++){var s=o[r];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++){var h=a[u];i=i.add(h.key)}}for(var c=0,f=t;c<f.length;c++){var l=f[c];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];i=i.add(y.key)}}return m.Jn(v,i).next(function(t){return{qh:t,xh:e,Bh:n}})})})];case 1:return n=t.sent(),[2,(this.jn=e,this.$h=m,this.Ph.kh(this.$h),n)]}})})},ju.prototype.Uh=function(u){var a,h=this,c=Vi.now(),t=u.reduce(function(t,e){return t.add(e.key)},vs());return this.persistence.runTransaction("Locally write mutations","readwrite",function(s){return h.$h.Jn(s,t).next(function(t){a=t;for(var e=[],n=0,i=u;n<i.length;n++){var r=i[n],o=r.Pt(a.get(r.key));null!=o&&e.push(new Br(r.key,o,so(o.proto.mapValue),Fr.exists(!0)))}return h.jn.Qh(s,c,e,u)})}).then(function(t){var e=t.En(a);return{batchId:t.batchId,Wh:e}})},ju.prototype.jh=function(i){var r=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var e=i.batch.keys(),n=r.Ch.Gh({Hh:!0});return r.jn.jh(t,i.batch,i.streamToken).next(function(){return r.Kh(t,i,n)}).next(function(){return n.apply(t)}).next(function(){return r.jn.zh(t)}).next(function(){return r.$h.Jn(t,e)})})},ju.prototype.Yh=function(t){var i=this;return this.persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.jn.Xh(e,t).next(function(t){return $s(null!==t),n=t.keys(),i.jn.Jh(e,t)}).next(function(){return i.jn.zh(e)}).next(function(){return i.$h.Jn(e,n)})})},ju.prototype.Zh=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.jn.Zh(t)})},ju.prototype.to=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly",function(t){return e.jn.to(t)})},ju.prototype.eo=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary",function(t){return n.jn.eo(t,e)})},ju.prototype.so=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e.Fh.so(t)})},ju.prototype.io=function(a){var h=this,c=a.we,f=this.ph;return this.persistence.runTransaction("Apply remote event","readwrite-primary",function(o){var r=h.Ch.Gh({Hh:!0});f=h.ph;var s=[];a.as.forEach(function(t,e){var n=f.get(e);if(n){s.push(h.Fh.no(o,t.Es,e).next(function(){return h.Fh.ro(o,t.Ts,e)}));var i=t.resumeToken;if(0<i.rt()){var r=n.me(i,c).Ee(o.ho);f=f.Re(e,r),ju.oo(n,r,t)&&s.push(h.Fh.ao(o,r))}}});var u=hs(),n=vs();if(a.cs.forEach(function(t,e){n=n.add(t)}),s.push(r.getEntries(o,n).next(function(i){a.cs.forEach(function(t,e){var n=i.get(t);e instanceof Io&&e.version.isEqual(Mi.min())?(r.uo(t,c),u=u.Re(t,e)):null==n||0<e.version.S(n.version)||0===e.version.S(n.version)&&n.hasPendingWrites?(r.co(e,c),u=u.Re(t,e)):Ys("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),a.ls.has(t)&&s.push(h.persistence.vh.lo(o,t))})})),!c.isEqual(Mi.min())){var t=h.Fh.so(o).next(function(t){return h.Fh._o(o,o.ho,c)});s.push(t)}return fu.Un(s).next(function(){return r.apply(o)}).next(function(){return h.$h.Zn(o,u)})}).then(function(t){return h.ph=f,t})},ju.oo=function(t,e,n){return $s(0<e.resumeToken.rt()),0===t.resumeToken.rt()||e.we.C()-t.we.C()>=this.fo||0<n.Ts.size+n.ws.size+n.Es.size},ju.prototype.do=function(t){for(var n=this,e=0,i=t;e<i.length;e++){var r=i[e],o=r.targetId;if(this.Vh.yn(r.ar,o),this.Vh.vn(r.ur,o),!r.fromCache){var s=this.ph.get(o),u=s.we,a=s.Ie(u);this.ph=this.ph.Re(o,a)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(e){return fu.forEach(t,function(t){return fu.forEach(t.ur,function(t){return n.persistence.vh.gn(e,t)})})})},ju.prototype.To=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===e&&(e=-1),n.jn.wo(t,e)})},ju.prototype.Eo=function(e){var n=this;return this.persistence.runTransaction("read document","readonly",function(t){return n.$h.Hn(t,e)})},ju.prototype.mo=function(i){var r=this;return this.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return r.Fh.Io(e,i).next(function(t){return t?(n=t,fu.resolve(n)):r.Fh.Ro(e).next(function(t){return n=new Mo(i,t,0,e.ho),r.Fh.Ao(e,n).next(function(){return n})})})}).then(function(t){return null===r.ph.get(t.targetId)&&(r.ph=r.ph.Re(t.targetId,t),r.yh.set(i,t.targetId)),t})},ju.prototype.Io=function(t,e){var n=this.yh.get(e);return void 0!==n?fu.resolve(this.ph.get(n)):this.Fh.Io(t,e)},ju.prototype.Po=function(n,i){var r=this,o=this.ph.get(n),t=i?"readwrite":"readwrite-primary";return this.persistence.runTransaction("Release target",t,function(e){var t=r.Vh.Sn(n);return i?fu.resolve():fu.forEach(t,function(t){return r.persistence.vh.gn(e,t)}).next(function(){r.persistence.vh.removeTarget(e,o)})}).then(function(){r.ph=r.ph.remove(n),r.yh.delete(o.target)})},ju.prototype.Vo=function(t,n){var i=this,r=Mi.min(),o=vs();return this.persistence.runTransaction("Execute query","readonly",function(e){return i.Io(e,t.ee()).next(function(t){if(t)return r=t.lastLimboFreeSnapshotVersion,i.Fh.po(e,t.targetId).next(function(t){o=t})}).next(function(){return i.Ph.er(e,t,n?r:Mi.min(),n?o:vs())}).next(function(t){return{documents:t,yo:o}})})},ju.prototype.bo=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly",function(t){return n.Fh.po(t,e)})},ju.prototype.Kh=function(t,r,o){var e=this,s=r.batch,n=s.keys(),u=fu.resolve();return n.forEach(function(i){u=u.next(function(){return o.Yn(t,i)}).next(function(t){var e=t,n=r.In.get(i);$s(null!==n),(!e||e.version.S(n)<0)&&(e=s.at(i,e,r))&&o.co(e,r.mn)})}),u.next(function(){return e.jn.Jh(t,s)})},ju.prototype.vo=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.So(t,n.ph)})},ju);function ju(t,e,n){this.persistence=t,this.Ph=e,this.Vh=new hu,this.ph=new Jo(nu),this.yh=new su(function(t){return t.canonicalId()}),this.gh=Mi.min(),this.persistence.vh.bh(this.Vh),this.jn=t.Sh(n),this.Ch=t.Dh(),this.Fh=t.Nh(),this.$h=new lu(this.Ch,this.jn,this.persistence.Lh()),this.Ph.kh(this.$h)}function qu(){this.index={}}function Fu(){this.Rh=new Cu}function xu(t){this.Eh=t}function Gu(e){return d(this,void 0,void 0,function(){return y(this,function(t){if(e.code!==Si.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;return Ys("LocalStore","Unexpectedly lost primary lease"),[2]})})}function Bu(t,e){if(0!==e.length)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+sa(e.length,"argument")+".")}function zu(t,e,n){if(e.length!==n)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires "+sa(n,"argument")+", but was called with "+sa(e.length,"argument")+".")}function Hu(t,e,n){if(e.length<n)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires at least "+sa(n,"argument")+", but was called with "+sa(e.length,"argument")+".")}function Wu(t,e,n,i){if(e.length<n||e.length>i)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+i+" arguments, but was called with "+sa(e.length,"argument")+".")}function Qu(t,e,n,i){$u(t,e,oa(n)+" argument",i)}function Yu(t,e,n,i){void 0!==i&&Qu(t,e,n,i)}function Xu(t,e,n,i){$u(t,e,n+" option",i)}function Ku(t,e,n,i){void 0!==i&&Xu(t,e,n,i)}function Ju(t,e,n,i,a){void 0!==i&&function(t,e,n){for(var i=[],r=0,o=a;r<o.length;r++){var s=o[r];if(s===n)return;i.push(ta(s))}var u=ta(n);throw new Ri(Si.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+e+'". Acceptable values: '+i.join(", "))}(t,n,i)}function $u(t,e,n,i){if(!("object"===e?Zu(i):"non-empty string"===e?"string"==typeof i&&""!==i:typeof i===e)){var r=ta(i);throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+r)}}function Zu(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function ta(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Js();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function ea(t,e,n){if(void 0===n)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+oa(e)+" argument, but it was undefined.")}function na(n,t,i){Zi(t,function(t,e){if(i.indexOf(t)<0)throw new Ri(Si.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+i.join(", "))})}function ia(t,e,n,i){var r=ta(i);return new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires its "+oa(n)+" argument to be a "+e+", but it was: "+r)}function ra(t,e,n){if(n<=0)throw new Ri(Si.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+oa(e)+" argument to be a positive number, but it was: "+n+".")}function oa(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function sa(t,e){return t+" "+e+(1===t?"":"s")}function ua(){if("undefined"==typeof Uint8Array)throw new Ri(Si.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function aa(){if(!Bs.nt().Co)throw new Ri(Si.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}Uu.fo=3e8;var ha=(la.fromBase64String=function(t){zu("Blob.fromBase64String",arguments,1),Qu("Blob.fromBase64String","string",1,t),aa();try{return new la(er.fromBase64String(t))}catch(t){throw new Ri(Si.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},la.fromUint8Array=function(t){if(zu("Blob.fromUint8Array",arguments,1),ua(),!(t instanceof Uint8Array))throw ia("Blob.fromUint8Array","Uint8Array",1,t);return new la(er.fromUint8Array(t))},la.prototype.toBase64=function(){return zu("Blob.toBase64",arguments,0),aa(),this.Do.toBase64()},la.prototype.toUint8Array=function(){return zu("Blob.toUint8Array",arguments,0),ua(),this.Do.toUint8Array()},la.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},la.prototype.isEqual=function(t){return this.Do.isEqual(t.Do)},la),ca=(fa.documentId=function(){return fa.No},fa.prototype.isEqual=function(t){if(!(t instanceof fa))throw ia("isEqual","FieldPath",1,t);return this.Fo.isEqual(t.Fo)},fa);function fa(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new Ri(Si.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least 1 element.")}();for(var n=0;n<t.length;++n)if(Qu("FieldPath","string",n,t[n]),0===t[n].length)throw new Ri(Si.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fo=new Yi(t)}function la(t){aa(),this.Do=t}ca.No=new ca(Yi.X().j());var pa,da,ya,va,ga,ma=new RegExp("[~\\*/\\[\\]]"),wa=function(t){this.$o=t},ba=(n(Ca,ga=wa),Ca.prototype.Ci=function(t){if(2!==t.Lo)throw 1===t.Lo?t.ko("FieldValue.delete() can only appear at the top level of your update data"):t.ko("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");return t.Vt.push(t.path),null},Ca.prototype.isEqual=function(t){return t instanceof Ca},Ca),Ea=(n(Pa,va=wa),Pa.prototype.Ci=function(t){return new qr(t.path,Tr.instance)},Pa.prototype.isEqual=function(t){return t instanceof Pa},Pa),Ia=(n(Ma,ya=wa),Ma.prototype.Ci=function(t){var n=t.Mo({Lo:3,methodName:this.$o}),e=this.Oo.map(function(t,e){return Ga(t,n.qo(e))}),i=new Nr(e);return new qr(t.path,i)},Ma.prototype.isEqual=function(t){return this===t},Ma),Ta=(n(Va,da=wa),Va.prototype.Ci=function(t){var n=t.Mo({Lo:3,methodName:this.$o}),e=this.Oo.map(function(t,e){return Ga(t,n.qo(e))}),i=new _r(e);return new qr(t.path,i)},Va.prototype.isEqual=function(t){return this===t},Va),Aa=(n(La,pa=wa),La.prototype.Ci=function(t){t.Mo({methodName:this.$o});var e=Ga(this.xo,t),n=new Sr(t.serializer,e);return new qr(t.path,n)},La.prototype.isEqual=function(t){return this===t},La),Na=(Object.defineProperty(Oa.prototype,"latitude",{get:function(){return this.Bo},enumerable:!0,configurable:!0}),Object.defineProperty(Oa.prototype,"longitude",{get:function(){return this.Uo},enumerable:!0,configurable:!0}),Oa.prototype.isEqual=function(t){return this.Bo===t.Bo&&this.Uo===t.Uo},Oa.prototype.g=function(t){return nu(this.Bo,t.Bo)||nu(this.Uo,t.Uo)},Oa),_a=/^__.*__$/,Sa=(Da.prototype.Qo=function(t,e){var n=[];return null!==this.Vt?n.push(new Br(t,this.data,this.Vt,e)):n.push(new Gr(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new zr(t,this.fieldTransforms)),n},Da),Ra=(ka.prototype.Qo=function(t,e){var n=[new Br(t,this.data,this.Vt,e)];return 0<this.fieldTransforms.length&&n.push(new zr(t,this.fieldTransforms)),n},ka);function ka(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Da(t,e,n){this.data=t,this.Vt=e,this.fieldTransforms=n}function Oa(t,e){if(zu("GeoPoint",arguments,2),Qu("GeoPoint","number",1,t),Qu("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new Ri(Si.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Ri(Si.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.Bo=t,this.Uo=e}function La(t){var e=this;return(e=pa.call(this,"FieldValue.increment")||this).xo=t,e}function Va(t){var e=this;return(e=da.call(this,"FieldValue.arrayRemove")||this).Oo=t,e}function Ma(t){var e=this;return(e=ya.call(this,"FieldValue.arrayUnion")||this).Oo=t,e}function Pa(){return va.call(this,"FieldValue.serverTimestamp")||this}function Ca(){return ga.call(this,"FieldValue.delete")||this}function Ua(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Js()}}var ja=(Object.defineProperty(xa.prototype,"path",{get:function(){return this.settings.path},enumerable:!0,configurable:!0}),Object.defineProperty(xa.prototype,"Lo",{get:function(){return this.settings.Lo},enumerable:!0,configurable:!0}),xa.prototype.Mo=function(t){return new xa(Object.assign(Object.assign({},this.settings),t),this.ii,this.serializer,this.fieldTransforms,this.Vt)},xa.prototype.jo=function(t){var e=null==this.path?null:this.path.child(t),n=this.Mo({path:e,Go:!1});return n.Ho(t),n},xa.prototype.Ko=function(t){var e=null==this.path?null:this.path.child(t),n=this.Mo({path:e,Go:!1});return n.Wo(),n},xa.prototype.qo=function(t){return this.Mo({path:null,Go:!0})},xa.prototype.ko=function(t){var e=null===this.path||this.path.q()?"":" (found in field "+this.path.toString()+")";return new Ri(Si.INVALID_ARGUMENT,"Function "+this.settings.methodName+"() called with invalid data. "+t+e)},xa.prototype.contains=function(e){return void 0!==this.Vt.find(function(t){return e.B(t)})||void 0!==this.fieldTransforms.find(function(t){return e.B(t.field)})},xa.prototype.Wo=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Ho(this.path.get(t))},xa.prototype.Ho=function(t){if(0===t.length)throw this.ko("Document fields must not be empty");if(Ua(this.Lo)&&_a.test(t))throw this.ko('Document fields cannot begin and end with "__"')},xa),qa=(Fa.prototype.Yo=function(t,e){var n=this.Xo(0,t);Ha("Data must be an object, but it was:",n,e);var i=Ba(e,n);return new Sa(new Qr(i),null,n.fieldTransforms)},Fa.prototype.Jo=function(t,e,n){var i=this.Xo(2,t);Ha("Data must be an object, but it was:",i,e);var r,o,s=Ba(e,i);if(n){for(var u=[],a=0,h=n;a<h.length;a++){var c=h[a],f=void 0;if(c instanceof ca)f=c.Fo;else{if("string"!=typeof c)throw Js();f=Qa(t,c)}if(!i.contains(f))throw new Ri(Si.INVALID_ARGUMENT,"Field '"+f+"' is specified in your field mask but missing from your input data.");Ya(u,f)||u.push(f)}r=new jr(u),o=i.fieldTransforms.filter(function(t){return r.ft(t.field)})}else r=new jr(i.Vt),o=i.fieldTransforms;return new Sa(new Qr(s),r,o)},Fa.prototype.Zo=function(o,t){var s=this.Xo(1,o);Ha("Data must be an object, but it was:",s,t);var u=[],a=new Yr;Zi(t,function(t,e){var n=Qa(o,t),i=s.Ko(n);if(e instanceof ba)u.push(n);else{var r=Ga(e,i);null!=r&&(u.push(n),a.set(n,r))}});var e=new jr(u);return new Ra(a.gt(),e,s.fieldTransforms)},Fa.prototype.ta=function(t,e,n,i){var r=this.Xo(1,t),o=[Wa(t,e)],s=[n];if(i.length%2!=0)throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var u=0;u<i.length;u+=2)o.push(Wa(t,i[u])),s.push(i[u+1]);for(var a=[],h=new Yr,c=o.length-1;0<=c;--c)if(!Ya(a,o[c])){var f=o[c],l=s[c],p=r.Ko(f);if(l instanceof ba)a.push(f);else{var d=Ga(l,p);null!=d&&(a.push(f),h.set(f,d))}}var y=new jr(a);return new Ra(h.gt(),y,r.fieldTransforms)},Fa.prototype.Xo=function(t,e){return new ja({Lo:t,methodName:e,path:Yi.H,Go:!1},this.ii,this.serializer)},Fa.prototype.ea=function(t,e,n){return void 0===n&&(n=!1),Ga(e,this.Xo(n?4:3,t))},Fa);function Fa(t,e){this.ii=t,this.serializer=e||Bs.nt().zo(t)}function xa(t,e,n,i,r){this.settings=t,this.ii=e,this.serializer=n,void 0===i&&this.Wo(),this.fieldTransforms=i||[],this.Vt=r||[]}function Ga(s,t){if(za(s))return Ha("Unsupported field value:",t,s),Ba(s,t);if(s instanceof wa)return function(t,e){if(!Ua(e.Lo))throw e.ko(t.$o+"() can only be used with update() and set()");if(null===e.path)throw e.ko(t.$o+"() is not currently supported inside arrays");var n=t.Ci(e);n&&e.fieldTransforms.push(n)}(s,t),null;if(t.path&&t.Vt.push(t.path),s instanceof Array){if(t.settings.Go&&4!==t.Lo)throw t.ko("Nested arrays are not supported");return function(t){for(var e=[],n=0,i=0,r=s;i<r.length;i++){var o=Ga(r[i],t.qo(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===t)return{nullValue:"NULL_VALUE"};if("number"==typeof t)return e.serializer.ai(t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Vi.fromDate(t);return{timestampValue:e.serializer.D(n)}}if(t instanceof Vi){var i=new Vi(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:e.serializer.D(i)}}if(t instanceof Na)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof ha)return{bytesValue:e.serializer.ui(t)};if(t instanceof fc){var r=e.ii,o=t.firestore.sa;if(!o.isEqual(r))throw e.ko("Document reference is for database "+o.projectId+"/"+o.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:e.serializer.li(t.ia.path,t.firestore.sa)}}throw e.ko("Unsupported field value: "+ta(t))}(s,t)}function Ba(t,i){var r={};return tr(t)?i.path&&0<i.path.length&&i.Vt.push(i.path):Zi(t,function(t,e){var n=Ga(e,i.jo(t));null!=n&&(r[t]=n)}),{mapValue:{fields:r}}}function za(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Vi||t instanceof Na||t instanceof ha||t instanceof fc||t instanceof wa)}function Ha(t,e,n){if(!za(n)||!Zu(n)){var i=ta(n);throw"an object"===i?e.ko(t+" a custom object"):e.ko(t+" "+i)}}function Wa(t,e){if(e instanceof ca)return e.Fo;if("string"==typeof e)return Qa(t,e);throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function Qa(t,e){try{return function(e){if(0<=e.search(ma))throw new Ri(Si.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ca.bind.apply(ca,r([void 0],e.split("."))))}catch(t){throw new Ri(Si.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(e).Fo}catch(e){var n=e instanceof Error?e.message:e.toString();throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Ya(t,e){return t.some(function(t){return t.isEqual(e)})}function Xa(t){this.key=t}function Ka(t){this.key=t}function Ja(t,e,n){this.query=t,this.targetId=e,this.view=n}function $a(t){this.key=t,this.Dc=!1}function Za(){this.al=void 0,this.ul=[]}var th,eh,nh,ih,rh=(Uh.prototype.ua=function(){return 1===this.state||2===this.state||4===this.state},Uh.prototype.ca=function(){return 2===this.state},Uh.prototype.start=function(){3!==this.state?this.auth():this.la()},Uh.prototype.stop=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.ua()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Uh.prototype._a=function(){this.state=0,this.jr.reset()},Uh.prototype.fa=function(){var t=this;this.ca()&&null===this.aa&&(this.aa=this.Er.vr(this.na,6e4,function(){return t.da()}))},Uh.prototype.Ta=function(t){this.wa(),this.stream.send(t)},Uh.prototype.da=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.ca()?[2,this.close(0)]:[2]})})},Uh.prototype.wa=function(){this.aa&&(this.aa.cancel(),this.aa=null)},Uh.prototype.close=function(e,n){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.wa(),this.jr.cancel(),this.oa++,3!==e?this.jr.reset():n&&n.code===Si.RESOURCE_EXHAUSTED?(Xs(n.toString()),Xs("Using maximum backoff delay to prevent overloading the backend."),this.jr.yr()):n&&n.code===Si.UNAUTHENTICATED&&this.ha.l(),null!==this.stream&&(this.Ea(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ma(n)];case 1:return t.sent(),[2]}})})},Uh.prototype.Ea=function(){},Uh.prototype.auth=function(){var n=this;this.state=1;var t=this.Ia(this.oa),e=this.oa;this.ha.getToken().then(function(t){n.oa===e&&n.Ra(t)},function(e){t(function(){var t=new Ri(Si.UNKNOWN,"Fetching auth token failed: "+e.message);return n.Aa(t)})})},Uh.prototype.Ra=function(t){var e=this,n=this.Ia(this.oa);this.stream=this.Pa(t),this.stream.Va(function(){n(function(){return e.state=2,e.listener.Va()})}),this.stream.ma(function(t){n(function(){return e.Aa(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Uh.prototype.la=function(){var t=this;this.state=4,this.jr.gr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){return this.state=0,this.start(),[2]})})})},Uh.prototype.Aa=function(t){return Ys("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Uh.prototype.Ia=function(e){var n=this;return function(t){n.Er.Or(function(){return n.oa===e?t():(Ys("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Uh),oh=(n(Ch,nh=rh),Ch.prototype.Pa=function(t){return this.ra.pa("Listen",t)},Ch.prototype.onMessage=function(t){this.jr.reset();var e=this.serializer.yi(t),n=this.serializer.bi(t);return this.listener.ya(e,n)},Ch.prototype.ga=function(t){var e={};e.database=this.serializer.mi,e.addTarget=this.serializer.ee(t);var n=this.serializer.Ki(t);n&&(e.labels=n),this.Ta(e)},Ch.prototype.ba=function(t){var e={};e.database=this.serializer.mi,e.removeTarget=t,this.Ta(e)},Ch),sh=(n(Ph,eh=rh),Object.defineProperty(Ph.prototype,"Sa",{get:function(){return this.va},enumerable:!0,configurable:!0}),Ph.prototype.start=function(){this.va=!1,eh.prototype.start.call(this)},Ph.prototype.Ea=function(){this.va&&this.Ca([])},Ph.prototype.Pa=function(t){return this.ra.pa("Write",t)},Ph.prototype.onMessage=function(t){if($s(!!t.streamToken),this.lastStreamToken=this.serializer.ci(t.streamToken),this.va){this.jr.reset();var e=this.serializer.Oi(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Da(n,e)}return $s(!t.writeResults||0===t.writeResults.length),this.va=!0,this.listener.Fa()},Ph.prototype.Na=function(){var t={};t.database=this.serializer.mi,this.Ta(t)},Ph.prototype.Ca=function(t){var e=this,n={streamToken:this.serializer.ui(this.lastStreamToken),writes:t.map(function(t){return e.serializer.vi(t)})};this.Ta(n)},Ph),uh=(n(Mh,th=function(){this.$a=void 0}),Mh.prototype.La=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.ra.La(e,n,t)}).catch(function(t){throw t.code===Si.UNAUTHENTICATED&&i.credentials.l(),t})},Mh.prototype.ka=function(e,n){var i=this;return this.credentials.getToken().then(function(t){return i.ra.ka(e,n,t)}).catch(function(t){throw t.code===Si.UNAUTHENTICATED&&i.credentials.l(),t})},Mh),ah=(Vh.prototype.Ua=function(i){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Qa(),0<this.mutations.length)throw new Ri(Si.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return d(this,void 0,void 0,function(){var n,e,i,r,o;return y(this,function(t){switch(t.label){case 0:return n=Zs(s),e={database:n.serializer.mi,documents:u.map(function(t){return n.serializer.di(t)})},[4,n.ka("BatchGetDocuments",e)];case 1:return i=t.sent(),r=new Map,i.forEach(function(t){var e=n.serializer.pi(t);r.set(e.key.toString(),e)}),o=[],[2,(u.forEach(function(t){var e=r.get(t.toString());$s(!!e),o.push(e)}),o)]}})})}(this.Oa,i)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Io||t instanceof Eo?n.Wa(t):Js()}),e)]}})})},Vh.prototype.set=function(t,e){this.write(e.Qo(t,this.Rt(t))),this.Ba.add(t)},Vh.prototype.update=function(t,e){try{this.write(e.Qo(t,this.ja(t)))}catch(t){this.xa=t}this.Ba.add(t)},Vh.prototype.delete=function(t){this.write([new Hr(t,this.Rt(t))]),this.Ba.add(t)},Vh.prototype.commit=function(){return d(this,void 0,void 0,function(){var e,n=this;return y(this,function(t){switch(t.label){case 0:if(this.Qa(),this.xa)throw this.xa;return e=this.Ma,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new Wr(t,n.Rt(t)))}),[4,function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return e=Zs(r),n={database:e.serializer.mi,writes:o.map(function(t){return e.serializer.vi(t)})},[4,e.La("Commit",n)];case 1:return i=t.sent(),[2,e.serializer.Oi(i.writeResults,i.commitTime)]}})})}(this.Oa,this.mutations)];case 1:return t.sent(),this.qa=!0,[2]}})})},Vh.prototype.Wa=function(t){var e;if(t instanceof Eo)e=t.version;else{if(!(t instanceof Io))throw Js();e=Mi.min()}var n=this.Ma.get(t.key);if(null!==n){if(!e.isEqual(n))throw new Ri(Si.ABORTED,"Document version changed between two reads.")}else this.Ma=this.Ma.Re(t.key,e)},Vh.prototype.Rt=function(t){var e=this.Ma.get(t);return!this.Ba.has(t)&&e?Fr.updateTime(e):Fr.dt()},Vh.prototype.ja=function(t){var e=this.Ma.get(t);if(this.Ba.has(t)||!e)return Fr.exists(!0);if(e.isEqual(Mi.min()))throw new Ri(Si.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Fr.updateTime(e)},Vh.prototype.write=function(t){this.Qa(),this.mutations=this.mutations.concat(t)},Vh.prototype.Qa=function(){},Vh),hh=(Lh.prototype.Ya=function(){var t=this;0===this.Ha&&(this.Xa("Unknown"),this.Ka=this.Sr.vr("online_state_timeout",1e4,function(){return t.Ka=null,t.Ja("Backend didn't respond within 10 seconds."),t.Xa("Offline"),Promise.resolve()}))},Lh.prototype.Za=function(t){"Online"===this.state?this.Xa("Unknown"):(this.Ha++,1<=this.Ha&&(this.tu(),this.Ja("Connection failed 1 times. Most recent error: "+t.toString()),this.Xa("Offline")))},Lh.prototype.set=function(t){this.tu(),this.Ha=0,"Online"===t&&(this.za=!1),this.Xa(t)},Lh.prototype.Xa=function(t){t!==this.state&&(this.state=t,this.Ga(t))},Lh.prototype.Ja=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.za?(Xs(e),this.za=!1):Ys("OnlineStateTracker",e)},Lh.prototype.tu=function(){null!==this.Ka&&(this.Ka.cancel(),this.Ka=null)},Lh),ch=(Oh.prototype.start=function(){return this.enableNetwork()},Oh.prototype.enableNetwork=function(){return this.networkEnabled=!0,this.Iu()},Oh.prototype.Iu=function(){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:return this.au()?(e=this.Tu,[4,this.eu.to()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Ru()?this.Au():this.cu.set("Unknown"),[4,this.Pu()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},Oh.prototype.disableNetwork=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),[2]}})})},Oh.prototype.Vu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.Tu.stop()];case 1:return t.sent(),[4,this.lu.stop()];case 2:return t.sent(),0<this.su.length&&(Ys("RemoteStore","Stopping write stream with "+this.su.length+" pending writes"),this.su=[]),this.pu(),[2]}})})},Oh.prototype.yu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Ys("RemoteStore","RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.hu.yu(),this.cu.set("Unknown"),[2]}})})},Oh.prototype.listen=function(t){this.iu.has(t.targetId)||(this.iu.set(t.targetId,t),this.Ru()?this.Au():this.lu.ca()&&this.gu(t))},Oh.prototype.bu=function(t){this.iu.delete(t),this.lu.ca()&&this.vu(t),0===this.iu.size&&(this.lu.ca()?this.lu.fa():this.au()&&this.cu.set("Unknown"))},Oh.prototype.si=function(t){return this.iu.get(t)||null},Oh.prototype.ei=function(t){return this.Su.ei(t)},Oh.prototype.gu=function(t){this.nu.Ns(t.targetId),this.lu.ga(t)},Oh.prototype.vu=function(t){this.nu.Ns(t),this.lu.ba(t)},Oh.prototype.Au=function(){this.nu=new Rs(this),this.lu.start(),this.cu.Ya()},Oh.prototype.Ru=function(){return this.au()&&!this.lu.ua()&&0<this.iu.size},Oh.prototype.au=function(){return!this.ru&&this.isPrimary&&this.networkEnabled},Oh.prototype.pu=function(){this.nu=null},Oh.prototype._u=function(){return d(this,void 0,void 0,function(){var n=this;return y(this,function(t){return this.iu.forEach(function(t,e){n.gu(t)}),[2]})})},Oh.prototype.fu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return this.pu(),this.Ru()?(this.cu.Za(e),this.Au()):this.cu.set("Unknown"),[2]})})},Oh.prototype.du=function(r,o){return d(this,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:if(this.cu.set("Online"),!(r instanceof Es&&2===r.state&&r.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,this.Cu(r)];case 2:return t.sent(),[3,5];case 3:return e=t.sent(),Ys("RemoteStore","Failed to remove targets %s: %s ",r.targetIds.join(","),e),[4,this.Du(e)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(r instanceof ws?this.nu.Bs(r):r instanceof bs?this.nu.zs(r):this.nu.Ws(r),o.isEqual(Mi.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,this.eu.so()];case 8:return n=t.sent(),0<=o.S(n)?[4,this.Fu(o)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Ys("RemoteStore","Failed to raise snapshot:",i=t.sent()),[4,this.Du(i)];case 12:return t.sent(),[3,13];case 13:return[2]}})})},Oh.prototype.Du=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:if("IndexedDbTransactionError"!==n.name)throw n;return this.ru=!0,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Offline"),this.Sr.th(function(){return d(e,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return Ys("RemoteStore","Retrying IndexedDB access"),[4,this.eu.so()];case 1:return t.sent(),this.ru=!1,[4,this.Iu()];case 2:return t.sent(),[2]}})})}),[2]}})})},Oh.prototype.Fu=function(i){var r=this,t=this.nu.Js(i);return t.as.forEach(function(t,e){if(0<t.resumeToken.rt()){var n=r.iu.get(e);n&&r.iu.set(e,n.me(t.resumeToken,i))}}),t.us.forEach(function(t){var e=r.iu.get(t);if(e){r.iu.set(t,e.me(er.ht,e.we)),r.vu(t);var n=new Mo(e.target,t,1,e.sequenceNumber);r.gu(n)}}),this.Su.io(t)},Oh.prototype.Cu=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){switch(t.label){case 0:e=o.cause,n=0,i=o.targetIds,t.label=1;case 1:return n<i.length?(r=i[n],this.iu.has(r)?[4,this.Su.Nu(r,e)]:[3,3]):[3,5];case 2:t.sent(),this.iu.delete(r),this.nu.removeTarget(r),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})},Oh.prototype.Pu=function(){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.$u()?(e=0<this.su.length?this.su[this.su.length-1].batchId:-1,[4,this.eu.To(e)]):[3,5];case 1:return null!==(n=t.sent())?[3,2]:(0===this.su.length&&this.Tu.fa(),[3,4]);case 2:return this.Lu(n),[4,this.Pu()];case 3:t.sent(),t.label=4;case 4:t.label=5;case 5:return this.ku()&&this.Ou(),[2]}})})},Oh.prototype.$u=function(){return this.au()&&this.su.length<10},Oh.prototype.Mu=function(){return this.su.length},Oh.prototype.Lu=function(t){this.su.push(t),this.Tu.ca()&&this.Tu.Sa&&this.Tu.Ca(t.mutations)},Oh.prototype.ku=function(){return this.au()&&!this.Tu.ua()&&0<this.su.length},Oh.prototype.Ou=function(){this.Tu.start()},Oh.prototype.wu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){return this.Tu.Na(),[2]})})},Oh.prototype.mu=function(){var i=this;return this.eu.eo(this.Tu.lastStreamToken).then(function(){for(var t=0,e=i.su;t<e.length;t++){var n=e[t];i.Tu.Ca(n.mutations)}}).catch(Gu)},Oh.prototype.Da=function(t,e){var n=this,i=this.su.shift(),r=au.from(i,t,e,this.Tu.lastStreamToken);return this.Su.qu(r).then(function(){return n.Pu()})},Oh.prototype.Eu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return e&&0<this.su.length?this.Tu.Sa?[4,this.xu(e)]:[3,2]:[3,5];case 1:return t.sent(),[3,4];case 2:return[4,this.Bu(e)];case 3:t.sent(),t.label=4;case 4:this.ku()&&this.Ou(),t.label=5;case 5:return[2]}})})},Oh.prototype.Bu=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){return Xo(e.code)?[2,(Ys("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.Tu.lastStreamToken),this.Tu.lastStreamToken=er.ht,this.eu.eo(er.ht).catch(Gu))]:[2]})})},Oh.prototype.xu=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return Xo(n=r.code)&&n!==Si.ABORTED?(e=this.su.shift(),[2,(this.Tu._a(),this.Su.Uu(e.batchId,r).then(function(){return i.Pu()}))]):[2]})})},Oh.prototype.Qu=function(){return new ah(this.Oa)},Oh.prototype.uu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Vu()];case 1:return t.sent(),this.cu.set("Unknown"),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},Oh.prototype.Wu=function(){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.au()?(Ys("RemoteStore","RemoteStore restarting streams for new credential"),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Oh.prototype.ju=function(e){return d(this,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,5];case 2:return e?[3,4]:[4,this.Vu()];case 3:t.sent(),this.cu.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})},Oh),fh=(Dh.prototype.Gu=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Dh.prototype.Hu=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Dh.prototype.Ku=function(){var t={activeTargetIds:this.activeTargetIds.W(),updateTimeMs:Date.now()};return JSON.stringify(t)},Dh),lh=(kh.prototype.Xu=function(t){},kh.prototype.Ju=function(t,e,n){},kh.prototype.Zu=function(t){return this.zu.Gu(t),this.Yu[t]||"not-current"},kh.prototype.tc=function(t,e,n){this.Yu[t]=e},kh.prototype.ec=function(t){this.zu.Hu(t)},kh.prototype.sc=function(t){return this.zu.activeTargetIds.has(t)},kh.prototype.ic=function(t){delete this.Yu[t]},kh.prototype.nc=function(){return this.zu.activeTargetIds},kh.prototype.rc=function(t){return this.zu.activeTargetIds.has(t)},kh.prototype.start=function(){return this.zu=new fh,Promise.resolve()},kh.prototype.Oh=function(t,e,n){},kh.prototype.hc=function(t){},kh.prototype.yu=function(){},kh.prototype.Tr=function(t){},kh),ph=(Object.defineProperty(Rh.prototype,"lc",{get:function(){return this.oc},enumerable:!0,configurable:!0}),Rh.prototype._c=function(t,e){var u=this,a=e?e.fc:new Ts,h=e?e.cc:this.cc,c=e?e.ns:this.ns,f=h,l=!1,p=this.query.oe()&&h.size===this.query.limit?h.last():null,d=this.query.ae()&&h.size===this.query.limit?h.first():null;if(t.ye(function(t,e){var n=h.get(t),i=e instanceof Eo?e:null;i=i&&(u.query.matches(i)?i:null);var r=!!n&&u.ns.has(n.key),o=!!i&&(i.At||u.ns.has(i.key)&&i.hasCommittedMutations),s=!1;n&&i?n.data().isEqual(i.data())?r!==o&&(a.track({type:3,doc:i}),s=!0):u.dc(n,i)||(a.track({type:2,doc:i}),s=!0,(p&&0<u.query.se(i,p)||d&&u.query.se(i,d)<0)&&(l=!0)):!n&&i?(a.track({type:0,doc:i}),s=!0):n&&!i&&(a.track({type:1,doc:n}),s=!0,(p||d)&&(l=!0)),s&&(c=i?(f=f.add(i),o?c.add(t):c.delete(t)):(f=f.delete(t),c.delete(t)))}),this.query.oe()||this.query.ae())for(;f.size>this.query.limit;){var n=this.query.oe()?f.last():f.first();f=f.delete(n.key),c=c.delete(n.key),a.track({type:1,doc:n})}return{cc:f,fc:a,Tc:l,ns:c}},Rh.prototype.dc=function(t,e){return t.At&&e.hasCommittedMutations&&!e.At},Rh.prototype.wc=function(t,e,n){var o=this,i=this.cc;this.cc=t.cc,this.ns=t.ns;var r=t.fc.es();r.sort(function(t,e){return i=t.type,r=e.type,n(i)-n(r)||o.query.se(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Js()}}var i,r}),this.Ec(n);var s=e?this.mc():[],u=0===this.uc.size&&this.ds?1:0,a=u!==this.ac;return this.ac=u,0!==r.length||a?{snapshot:new As(this.query,t.cc,i,r,t.ns,0==u,a,!1),Ic:s}:{Ic:s}},Rh.prototype.Rc=function(t){return this.ds&&"Offline"===t?(this.ds=!1,this.wc({cc:this.cc,fc:new Ts,ns:this.ns,Tc:!1},!1)):{Ic:[]}},Rh.prototype.Ac=function(t){return!this.oc.has(t)&&!!this.cc.has(t)&&!this.cc.get(t).At},Rh.prototype.Ec=function(t){var e=this;t&&(t.Ts.forEach(function(t){return e.oc=e.oc.add(t)}),t.ws.forEach(function(t){}),t.Es.forEach(function(t){return e.oc=e.oc.delete(t)}),this.ds=t.ds)},Rh.prototype.mc=function(){var e=this;if(!this.ds)return[];var n=this.uc;this.uc=vs(),this.cc.forEach(function(t){e.Ac(t.key)&&(e.uc=e.uc.add(t.key))});var i=[];return n.forEach(function(t){e.uc.has(t)||i.push(new Ka(t))}),this.uc.forEach(function(t){n.has(t)||i.push(new Xa(t))}),i},Rh.prototype.Pc=function(t){this.oc=t.yo,this.uc=vs();var e=this._c(t.documents);return this.wc(e,!0)},Rh.prototype.Vc=function(){return As.os(this.query,this.cc,this.ns,0===this.ac)},Rh),dh=(Sh.prototype.gc=function(){this.bc()},Sh.prototype.bc=function(){var t=this;this.jr.gr(function(){return d(t,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){return e=this.pc.Qu(),(n=this.vc(e))&&n.then(function(t){i.Sr.Or(function(){return e.commit().then(function(){i.Fr.resolve(t)}).catch(function(t){i.Sc(t)})})}).catch(function(t){i.Sc(t)}),[2]})})})},Sh.prototype.vc=function(t){try{var e=this.updateFunction(t);return!ir(e)&&e.catch&&e.then?e:(this.Fr.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Fr.reject(t),null}},Sh.prototype.Sc=function(t){var e=this;0<this.yc&&this.Cc(t)?(--this.yc,this.Sr.Or(function(){return e.bc(),Promise.resolve()})):this.Fr.reject(t)},Sh.prototype.Cc=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!Xo(e)},Sh),yh=(Object.defineProperty(_h.prototype,"Wc",{get:function(){return!0},enumerable:!0,configurable:!0}),_h.prototype.subscribe=function(t){this.$c=t},_h.prototype.listen=function(s){return d(this,void 0,void 0,function(){var e,n,i,r,o;return y(this,function(t){switch(t.label){case 0:return this.jc("listen()"),(i=this.Lc.get(s))?(e=i.targetId,this.Fc.Zu(e),n=i.view.Vc(),[3,4]):[3,1];case 1:return[4,this.eu.mo(s.ee())];case 2:return r=t.sent(),o=this.Fc.Zu(r.targetId),e=r.targetId,[4,this.Gc(s,e,"current"===o)];case 3:n=t.sent(),this.Wc&&this.pc.listen(r),t.label=4;case 4:return[2,n]}})})},_h.prototype.Gc=function(u,a,h){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:return[4,this.eu.Vo(u,!0)];case 1:return e=t.sent(),n=new ph(u,e.yo),i=n._c(e.documents),r=_s.fs(a,h&&"Offline"!==this.onlineState),o=n.wc(i,this.Wc,r),this.Hc(a,o.Ic),s=new Ja(u,a,n),[2,(this.Lc.set(u,s),this.kc.has(a)?this.kc.get(a).push(u):this.kc.set(a,[u]),o.snapshot)]}})})},_h.prototype.bu=function(r){return d(this,void 0,void 0,function(){var e,n,i=this;return y(this,function(t){switch(t.label){case 0:return this.jc("unlisten()"),e=this.Lc.get(r),1<(n=this.kc.get(e.targetId)).length?[2,(this.kc.set(e.targetId,n.filter(function(t){return!t.isEqual(r)})),void this.Lc.delete(r))]:this.Wc?(this.Fc.ec(e.targetId),this.Fc.rc(e.targetId)?[3,2]:[4,this.eu.Po(e.targetId,!1).then(function(){i.Fc.ic(e.targetId),i.pc.bu(e.targetId),i.Kc(e.targetId)}).catch(Gu)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Kc(e.targetId),[4,this.eu.Po(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},_h.prototype.write=function(i,r){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.jc("write()"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.eu.Uh(i)];case 2:return e=t.sent(),[3,4];case 3:if("IndexedDbTransactionError"===(n=t.sent()).name)return[2,(Xs("SyncEngine","Dropping write that cannot be persisted: "+n),void r.reject(new Ri(Si.UNAVAILABLE,"Failed to persist write: "+n)))];throw n;case 4:return this.Fc.Xu(e.batchId),this.zc(e.batchId,r),[4,this.Yc(e.Wh)];case 5:return t.sent(),[4,this.pc.Pu()];case 6:return t.sent(),[2]}})})},_h.prototype.runTransaction=function(t,e,n){new dh(t,this.pc,e,n).gc()},_h.prototype.io=function(n){return d(this,void 0,void 0,function(){var e,i=this;return y(this,function(t){switch(t.label){case 0:this.jc("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.io(n)];case 2:return e=t.sent(),n.as.forEach(function(t,e){var n=i.qc.get(e);n&&($s(t.Ts.size+t.ws.size+t.Es.size<=1),0<t.Ts.size?n.Dc=!0:0<t.ws.size?$s(n.Dc):0<t.Es.size&&($s(n.Dc),n.Dc=!1))}),[4,this.Yc(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,Gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},_h.prototype.Rc=function(i,t){this.jc("applyOnlineStateChange()");var r=[];this.Lc.forEach(function(t,e){var n=e.view.Rc(i);n.snapshot&&r.push(n.snapshot)}),this.$c.Xc(i),this.$c.ya(r),this.onlineState=i},_h.prototype.Nu=function(u,a){return d(this,void 0,void 0,function(){var e,n,i,r,o,s=this;return y(this,function(t){switch(t.label){case 0:return this.jc("rejectListens()"),this.Fc.tc(u,"rejected",a),e=this.qc.get(u),(n=e&&e.key)?(this.Mc=this.Mc.remove(n),this.qc.delete(u),this.Jc(),i=(i=new Jo(Ki.N)).Re(n,new Io(n,Mi.min())),r=vs().add(n),o=new Ns(Mi.min(),new Map,new rs(nu),i,r),[2,this.io(o)]):[4,this.eu.Po(u,!1).then(function(){return s.Kc(u,a)}).catch(Gu)];case 1:return t.sent(),[2]}})})},_h.prototype.qu=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:this.jc("applySuccessfulWrite()"),e=i.batch.batchId,this.Zc(e,null),this.tl(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.jh(i)];case 2:return n=t.sent(),this.Fc.Ju(e,"acknowledged"),[4,this.Yc(n)];case 3:return t.sent(),[3,6];case 4:return[4,Gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},_h.prototype.Uu=function(n,i){return d(this,void 0,void 0,function(){var e;return y(this,function(t){switch(t.label){case 0:this.jc("rejectFailedWrite()"),this.Zc(n,i),this.tl(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.eu.Yh(n)];case 2:return e=t.sent(),this.Fc.Ju(n,"rejected",i),[4,this.Yc(e)];case 3:return t.sent(),[3,6];case 4:return[4,Gu(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},_h.prototype.el=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return this.pc.au()||Ys("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.eu.Zh()];case 1:return-1===(e=t.sent())?[2,void i.resolve()]:((n=this.Uc.get(e)||[]).push(i),this.Uc.set(e,n),[2])}})})},_h.prototype.tl=function(t){(this.Uc.get(t)||[]).forEach(function(t){t.resolve()}),this.Uc.delete(t)},_h.prototype.sl=function(e){this.Uc.forEach(function(t){t.forEach(function(t){t.reject(new Ri(Si.CANCELLED,e))})}),this.Uc.clear()},_h.prototype.zc=function(t,e){var n=this.Bc[this.currentUser.s()];n=(n=n||new Jo(nu)).Re(t,e),this.Bc[this.currentUser.s()]=n},_h.prototype.Zc=function(t,e){var n=this.Bc[this.currentUser.s()];if(n){var i=n.get(t);i&&(e?i.reject(e):i.resolve(),n=n.remove(t)),this.Bc[this.currentUser.s()]=n}},_h.prototype.Kc=function(t,e){var n=this;void 0===e&&(e=null),this.Fc.ec(t);for(var i=0,r=this.kc.get(t);i<r.length;i++){var o=r[i];this.Lc.delete(o),e&&this.$c.il(o,e)}if(this.kc.delete(t),this.Wc){var s=this.xc.Dn(t);this.xc.Sn(t),s.forEach(function(t){n.xc.Fn(t)||n.nl(t)})}},_h.prototype.nl=function(t){var e=this.Mc.get(t);null!==e&&(this.pc.bu(e),this.Mc=this.Mc.remove(t),this.qc.delete(e),this.Jc())},_h.prototype.Hc=function(t,e){for(var n=0,i=e;n<i.length;n++){var r=i[n];r instanceof Xa?(this.xc.pn(r.key,t),this.rl(r)):r instanceof Ka?(Ys("SyncEngine","Document no longer in limbo: "+r.key),this.xc.gn(r.key,t),this.xc.Fn(r.key)||this.nl(r.key)):Js()}},_h.prototype.rl=function(t){var e=t.key;this.Mc.get(e)||(Ys("SyncEngine","New document in limbo: "+e),this.Oc.push(e),this.Jc())},_h.prototype.Jc=function(){for(;0<this.Oc.length&&this.Mc.size<this.Nc;){var t=this.Oc.shift(),e=this.Qc.next();this.qc.set(e,new $a(t)),this.Mc=this.Mc.Re(t,e),this.pc.listen(new Mo(No.Wt(t.path).ee(),e,2,du.wr))}},_h.prototype.hl=function(){return this.Mc},_h.prototype.ol=function(){return this.Oc},_h.prototype.Yc=function(i,a){return d(this,void 0,void 0,function(){var o,s,e,u=this;return y(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Lc.forEach(function(t,r){e.push(Promise.resolve().then(function(){var n=r.view._c(i);return n.Tc?u.eu.Vo(r.query,!1).then(function(t){var e=t.documents;return r.view._c(e,n)}):n}).then(function(t){var e=a&&a.as.get(r.targetId),n=r.view.wc(t,u.Wc,e);if(u.Hc(r.targetId,n.Ic),n.snapshot){u.Wc&&u.Fc.tc(r.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var i=pu.cr(r.targetId,n.snapshot);s.push(i)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.$c.ya(o),[4,this.eu.do(s)];case 2:return t.sent(),[2]}})})},_h.prototype.jc=function(t){},_h.prototype.Wu=function(i){return d(this,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(i),this.currentUser=i,e?(this.sl("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.eu.Oh(i)]):[3,3];case 1:return n=t.sent(),this.Fc.Oh(i,n.xh,n.Bh),[4,this.Yc(n.qh)];case 2:t.sent(),t.label=3;case 3:return[4,this.pc.Wu()];case 4:return t.sent(),[2]}})})},_h.prototype.enableNetwork=function(){return this.pc.enableNetwork()},_h.prototype.disableNetwork=function(){return this.pc.disableNetwork()},_h.prototype.ei=function(t){var e=this.qc.get(t);if(e&&e.Dc)return vs().add(e.key);var n=vs(),i=this.kc.get(t);if(!i)return n;for(var r=0,o=i;r<o.length;r++){var s=o[r],u=this.Lc.get(s);n=n.ze(u.view.lc)}return n},_h),vh=(Nh.prototype.listen=function(u){return d(this,void 0,void 0,function(){var e,n,i,r,o,s;return y(this,function(t){switch(t.label){case 0:if(e=u.query,n=!1,(i=this.cl.get(e))||(n=!0,i=new Za),!n)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),r=i,[4,this.Su.listen(e)];case 2:return r.al=t.sent(),[3,4];case 3:if(o=t.sent(),Xs("EventManager",s="Initialization of query '"+e+"' failed: "+o),"IndexedDbTransactionError"!==o.name)throw o;return[2,void u.onError(new Ri(Si.UNAVAILABLE,s))];case 4:return this.cl.set(e,i),i.ul.push(u),u.Rc(this.onlineState),i.al&&u._l(i.al)&&this.fl(),[2]}})})},Nh.prototype.bu=function(o){return d(this,void 0,void 0,function(){var e,n,i,r;return y(this,function(t){return e=o.query,n=!1,(i=this.cl.get(e))&&0<=(r=i.ul.indexOf(o))&&(i.ul.splice(r,1),n=0===i.ul.length),n?[2,(this.cl.delete(e),this.Su.bu(e))]:[2]})})},Nh.prototype.ya=function(t){for(var e=!1,n=0,i=t;n<i.length;n++){var r=i[n],o=r.query,s=this.cl.get(o);if(s){for(var u=0,a=s.ul;u<a.length;u++)a[u]._l(r)&&(e=!0);s.al=r}}e&&this.fl()},Nh.prototype.il=function(t,e){var n=this.cl.get(t);if(n)for(var i=0,r=n.ul;i<r.length;i++)r[i].onError(e);this.cl.delete(t)},Nh.prototype.Xc=function(r){this.onlineState=r;var o=!1;this.cl.forEach(function(t,e){for(var n=0,i=e.ul;n<i.length;n++)i[n].Rc(r)&&(o=!0)}),o&&this.fl()},Nh.prototype.dl=function(t){this.ll.add(t),t.next()},Nh.prototype.Tl=function(t){this.ll.delete(t)},Nh.prototype.fl=function(){this.ll.forEach(function(t){t.next()})},Nh),gh=(Ah.prototype._l=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,i=t.docChanges;n<i.length;n++){var r=i[n];3!==r.type&&e.push(r)}t=new As(t.query,t.docs,t.ss,e,t.ns,t.fromCache,t.rs,!0)}var o=!1;return this.El?this.Il(t)&&(this.wl.next(t),o=!0):this.Rl(t,this.onlineState)&&(this.Al(t),o=!0),this.ml=t,o},Ah.prototype.onError=function(t){this.wl.error(t)},Ah.prototype.Rc=function(t){this.onlineState=t;var e=!1;return this.ml&&!this.El&&this.Rl(this.ml,t)&&(this.Al(this.ml),e=!0),e},Ah.prototype.Rl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.Pl&&n||t.docs.q()&&"Offline"!==e)},Ah.prototype.Il=function(t){if(0<t.docChanges.length)return!0;var e=this.ml&&this.ml.hasPendingWrites!==t.hasPendingWrites;return!(!t.rs&&!e)&&!0===this.options.includeMetadataChanges},Ah.prototype.Al=function(t){t=As.os(t.query,t.docs,t.ns,t.fromCache),this.El=!0,this.wl.next(t)},Ah),mh=(Th.prototype.kh=function(t){this.Vl=t},Th.prototype.er=function(e,i,r,o){var s=this;return i.te()||r.isEqual(Mi.min())?this.pl(e,i):this.Vl.Jn(e,o).next(function(t){var n=s.yl(i,t);return(i.oe()||i.ae())&&s.Tc(i.xt,n,o,r)?s.pl(e,i):(Ws()<=u.DEBUG&&Ys("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),i.toString()),s.Vl.er(e,i,r).next(function(e){return n.forEach(function(t){e=e.Re(t.key,t)}),e}))})},Th.prototype.yl=function(n,t){var i=new rs(function(t,e){return n.se(t,e)});return t.forEach(function(t,e){e instanceof Eo&&n.matches(e)&&(i=i.add(e))}),i},Th.prototype.Tc=function(t,e,n,i){if(n.size!==e.size)return!0;var r="F"===t?e.last():e.first();return!!r&&(r.hasPendingWrites||0<r.version.S(i))},Th.prototype.pl=function(t,e){return Ws()<=u.DEBUG&&Ys("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.Vl.er(t,e,Mi.min())},Th),wh=(Ih.prototype.vl=function(t){return fu.resolve(0===this.jn.length)},Ih.prototype.jh=function(t,e,n){var i=e.batchId,r=this.Sl(i,"acknowledged");return $s(0===r),this.jn[r],this.lastStreamToken=n,fu.resolve()},Ih.prototype.to=function(t){return fu.resolve(this.lastStreamToken)},Ih.prototype.eo=function(t,e){return this.lastStreamToken=e,fu.resolve()},Ih.prototype.Qh=function(t,e,n,i){var r=this.gl;this.gl++,0<this.jn.length&&this.jn[this.jn.length-1];var o=new uu(r,e,n,i);this.jn.push(o);for(var s=0,u=i;s<u.length;s++){var a=u[s];this.bl=this.bl.add(new cu(a.key,r)),this.Gn.Ah(t,a.key.path.k())}return fu.resolve(o)},Ih.prototype.Xh=function(t,e){return fu.resolve(this.Cl(e))},Ih.prototype.wo=function(t,e){var n=e+1,i=this.Dl(n),r=i<0?0:i;return fu.resolve(this.jn.length>r?this.jn[r]:null)},Ih.prototype.Zh=function(){return fu.resolve(0===this.jn.length?-1:this.gl-1)},Ih.prototype.Mh=function(t){return fu.resolve(this.jn.slice())},Ih.prototype.Kn=function(t,e){var n=this,i=new cu(e,0),r=new cu(e,Number.POSITIVE_INFINITY),o=[];return this.bl.Ge([i,r],function(t){var e=n.Cl(t.Nn);o.push(e)}),fu.resolve(o)},Ih.prototype.tr=function(t,e){var i=this,r=new rs(nu);return e.forEach(function(t){var e=new cu(t,0),n=new cu(t,Number.POSITIVE_INFINITY);i.bl.Ge([e,n],function(t){r=r.add(t.Nn)})}),fu.resolve(this.Fl(r))},Ih.prototype.hr=function(t,e){var n=e.path,i=n.length+1,r=n;Ki.et(r)||(r=r.child(""));var o=new cu(new Ki(r),0),s=new rs(nu);return this.bl.He(function(t){var e=t.key.path;return!!n.B(e)&&(e.length===i&&(s=s.add(t.Nn)),!0)},o),fu.resolve(this.Fl(s))},Ih.prototype.Fl=function(t){var n=this,i=[];return t.forEach(function(t){var e=n.Cl(t);null!==e&&i.push(e)}),i},Ih.prototype.Jh=function(n,i){var r=this;$s(0===this.Sl(i.batchId,"removed")),this.jn.shift();var o=this.bl;return fu.forEach(i.mutations,function(t){var e=new cu(t.key,i.batchId);return o=o.delete(e),r.vh.Nl(n,t.key)}).next(function(){r.bl=o})},Ih.prototype.$l=function(t){},Ih.prototype.Fn=function(t,e){var n=new cu(e,0),i=this.bl.Ke(n);return fu.resolve(e.isEqual(i&&i.key))},Ih.prototype.zh=function(t){return this.jn.length,fu.resolve()},Ih.prototype.Sl=function(t,e){return this.Dl(t)},Ih.prototype.Dl=function(t){return 0===this.jn.length?0:t-this.jn[0].batchId},Ih.prototype.Cl=function(t){var e=this.Dl(t);return e<0||e>=this.jn.length?null:this.jn[e]},Ih),bh=(Eh.prototype.co=function(t,e,n){var i=e.key,r=this.docs.get(i),o=r?r.size:0,s=this.Ll(e);return this.docs=this.docs.Re(i,{kl:e,size:s,readTime:n}),this.size+=s-o,this.Gn.Ah(t,i.path.k())},Eh.prototype.uo=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Eh.prototype.Yn=function(t,e){var n=this.docs.get(e);return fu.resolve(n?n.kl:null)},Eh.prototype.getEntries=function(t,e){var n=this,i=cs();return e.forEach(function(t){var e=n.docs.get(t);i=i.Re(t,e?e.kl:null)}),fu.resolve(i)},Eh.prototype.er=function(t,e,n){for(var i=ls(),r=new Ki(e.path.child("")),o=this.docs.ve(r);o.$e();){var s=o.Ne(),u=s.key,a=s.value,h=a.kl,c=a.readTime;if(!e.path.B(u.path))break;c.S(n)<=0||h instanceof Eo&&e.matches(h)&&(i=i.Re(h.key,h))}return fu.resolve(i)},Eh.prototype.Ol=function(t,e){return fu.forEach(this.docs,function(t){return e(t)})},Eh.prototype.Gh=function(t){return new Eh.Ml(this)},Eh.prototype.ql=function(t){return fu.resolve(this.size)},Eh);function Eh(t,e){this.Gn=t,this.Ll=e,this.docs=new Jo(Ki.N),this.size=0}function Ih(t,e){this.Gn=t,this.vh=e,this.jn=[],this.gl=1,this.lastStreamToken=er.ht,this.bl=new rs(cu.An)}function Th(){}function Ah(t,e,n){this.query=t,this.wl=e,this.El=!1,this.ml=null,this.onlineState="Unknown",this.options=n||{}}function Nh(t){this.Su=t,this.cl=new su(function(t){return t.canonicalId()}),this.onlineState="Unknown",this.ll=new Set,this.Su.subscribe(this)}function _h(t,e,n,i,r){this.eu=t,this.pc=e,this.Fc=n,this.currentUser=i,this.Nc=r,this.$c=null,this.Lc=new su(function(t){return t.canonicalId()}),this.kc=new Map,this.Oc=[],this.Mc=new Jo(Ki.N),this.qc=new Map,this.xc=new hu,this.Bc={},this.Uc=new Map,this.Qc=Mu.Ih(),this.onlineState="Unknown"}function Sh(t,e,n,i){this.Sr=t,this.pc=e,this.updateFunction=n,this.Fr=i,this.yc=5,this.jr=new _u(this.Sr,"transaction_retry")}function Rh(t,e){this.query=t,this.oc=e,this.ac=null,this.ds=!1,this.uc=vs(),this.ns=vs(),this.cc=new Is(t.se.bind(t))}function kh(){this.zu=new fh,this.Yu={},this.Su=null,this.Ga=null,this.lr=null}function Dh(){this.activeTargetIds=ms()}function Oh(t,e,n,i,r){var o,s,u,a,h,c,f,l,p=this;this.eu=t,this.Oa=e,this.Sr=n,this.su=[],this.iu=new Map,this.nu=null,this.networkEnabled=!1,this.isPrimary=!1,this.ru=!1,this.hu=r,this.hu.ou(function(t){n.Or(function(){return d(p,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.au()?(Ys("RemoteStore","Restarting streams for network reachability change."),[4,this.uu()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.cu=new hh(n,i),this.lu=(h=this.Oa,c=n,f={Va:this._u.bind(this),ma:this.fu.bind(this),ya:this.du.bind(this)},l=Zs(h),new oh(c,l.ra,l.credentials,l.serializer,f)),this.Tu=(o=this.Oa,s=n,u={Va:this.wu.bind(this),ma:this.Eu.bind(this),Fa:this.mu.bind(this),Da:this.Da.bind(this)},a=Zs(o),new sh(s,a.ra,a.credentials,a.serializer,u))}function Lh(t,e){this.Sr=t,this.Ga=e,this.state="Unknown",this.Ha=0,this.Ka=null,this.za=!0}function Vh(t){this.Oa=t,this.Ma=ds(),this.mutations=[],this.qa=!1,this.xa=null,this.Ba=new Set}function Mh(t,e,n){var i=this;return(i=th.call(this)||this).ra=t,i.credentials=e,i.serializer=n,i}function Ph(t,e,n,i,r){var o=this;return(o=eh.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,r)||this).serializer=i,o.va=!1,o.lastStreamToken=er.ht,o}function Ch(t,e,n,i,r){var o=this;return(o=nh.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,r)||this).serializer=i,o}function Uh(t,e,n,i,r,o){this.Er=t,this.na=n,this.ra=i,this.ha=r,this.listener=o,this.state=0,this.oa=0,this.aa=null,this.stream=null,this.jr=new _u(t,e)}function jh(t){var e=this;return(e=ih.call(this)||this).jl=t,e}function qh(){this.Wh=new su(function(t){return t.toString()}),this.xl=!1}bh.Ml=(Object.defineProperty(qh.prototype,"readTime",{get:function(){return this.Bl},set:function(t){this.Bl=t},enumerable:!0,configurable:!0}),qh.prototype.co=function(t,e){this.Ul(),this.readTime=e,this.Wh.set(t.key,t)},qh.prototype.uo=function(t,e){this.Ul(),e&&(this.readTime=e),this.Wh.set(t,null)},qh.prototype.Yn=function(t,e){this.Ul();var n=this.Wh.get(e);return void 0!==n?fu.resolve(n):this.Ql(t,e)},qh.prototype.getEntries=function(t,e){return this.Wl(t,e)},qh.prototype.apply=function(t){return this.Ul(),this.xl=!0,this.wc(t)},qh.prototype.Ul=function(){},n(jh,ih=qh),jh.prototype.wc=function(n){var i=this,r=[];return this.Wh.forEach(function(t,e){e?r.push(i.jl.co(n,e,i.readTime)):i.jl.uo(t)}),fu.Un(r)},jh.prototype.Ql=function(t,e){return this.jl.Yn(t,e)},jh.prototype.Wl=function(t,e){return this.jl.getEntries(t,e)},jh);var Fh,xh=(ec.prototype.js=function(t,n){return this.Gl.forEach(function(t,e){return n(e)}),fu.resolve()},ec.prototype.so=function(t){return fu.resolve(this.lastRemoteSnapshotVersion)},ec.prototype.Yl=function(t){return fu.resolve(this.Hl)},ec.prototype.Ro=function(t){return this.highestTargetId=this.zl.next(),fu.resolve(this.highestTargetId)},ec.prototype._o=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Hl&&(this.Hl=e),fu.resolve()},ec.prototype.Xl=function(t){this.Gl.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.zl=new Mu(e),this.highestTargetId=e),t.sequenceNumber>this.Hl&&(this.Hl=t.sequenceNumber)},ec.prototype.Ao=function(t,e){return this.Xl(e),this.targetCount+=1,fu.resolve()},ec.prototype.ao=function(t,e){return this.Xl(e),fu.resolve()},ec.prototype.Jl=function(t,e){return this.Gl.delete(e.target),this.Kl.Sn(e.targetId),--this.targetCount,fu.resolve()},ec.prototype.Zl=function(n,i,r){var o=this,s=0,u=[];return this.Gl.forEach(function(t,e){e.sequenceNumber<=i&&null===r.get(e.targetId)&&(o.Gl.delete(t),u.push(o.t_(n,e.targetId)),s++)}),fu.Un(u).next(function(){return s})},ec.prototype.e_=function(t){return fu.resolve(this.targetCount)},ec.prototype.Io=function(t,e){var n=this.Gl.get(e)||null;return fu.resolve(n)},ec.prototype.ro=function(e,t,n){this.Kl.yn(t,n);var i=this.persistence.vh,r=[];return i&&t.forEach(function(t){r.push(i.pn(e,t))}),fu.Un(r)},ec.prototype.no=function(e,t,n){this.Kl.vn(t,n);var i=this.persistence.vh,r=[];return i&&t.forEach(function(t){r.push(i.gn(e,t))}),fu.Un(r)},ec.prototype.t_=function(t,e){return this.Kl.Sn(e),fu.resolve()},ec.prototype.po=function(t,e){var n=this.Kl.Dn(e);return fu.resolve(n)},ec.prototype.Fn=function(t,e){return fu.resolve(this.Kl.Fn(e))},ec),Gh=(tc.prototype.start=function(){return Promise.resolve()},tc.prototype.yu=function(){return this.n_=!1,Promise.resolve()},Object.defineProperty(tc.prototype,"h_",{get:function(){return this.n_},enumerable:!0,configurable:!0}),tc.prototype.o_=function(){},tc.prototype.Lh=function(){return this.Gn},tc.prototype.Sh=function(t){var e=this.s_[t.s()];return e||(e=new wh(this.Gn,this.vh),this.s_[t.s()]=e),e},tc.prototype.Nh=function(){return this.Fh},tc.prototype.Dh=function(){return this.Wn},tc.prototype.runTransaction=function(t,e,n){var i=this;Ys("MemoryPersistence","Starting transaction:",t);var r=new Bh(this.i_.next());return this.vh.a_(),n(r).next(function(t){return i.vh.u_(r).next(function(){return t})}).xn().then(function(t){return r.c_(),t})},tc.prototype.l_=function(e,n){return fu.Qn(Object.values(this.s_).map(function(t){return function(){return t.Fn(e,n)}}))},tc),Bh=(Zh.prototype.f_=function(t){this.__.push(t)},Zh.prototype.c_=function(){this.__.forEach(function(t){return t()})},n($h,Fh=Zh),$h),zh=(Jh.w_=function(t){return new Jh(t)},Object.defineProperty(Jh.prototype,"E_",{get:function(){if(this.T_)return this.T_;throw Js()},enumerable:!0,configurable:!0}),Jh.prototype.bh=function(t){this.d_=t},Jh.prototype.pn=function(t,e){return this.E_.delete(e),fu.resolve()},Jh.prototype.gn=function(t,e){return this.E_.add(e),fu.resolve()},Jh.prototype.Nl=function(t,e){return this.E_.add(e),fu.resolve()},Jh.prototype.removeTarget=function(t,e){var n=this,i=this.persistence.Nh();return i.po(t,e.targetId).next(function(t){t.forEach(function(t){return n.E_.add(t)})}).next(function(){return i.Jl(t,e)})},Jh.prototype.a_=function(){this.T_=new Set},Jh.prototype.u_=function(t){var n=this,i=this.persistence.Dh().Gh();return fu.forEach(this.E_,function(e){return n.m_(t,e).next(function(t){t||i.uo(e)})}).next(function(){return n.T_=null,i.apply(t)})},Jh.prototype.lo=function(t,e){var n=this;return this.m_(t,e).next(function(t){t?n.E_.delete(e):n.E_.add(e)})},Jh.prototype.r_=function(t){return 0},Jh.prototype.m_=function(t,e){var n=this;return fu.Qn([function(){return n.persistence.Nh().Fn(t,e)},function(){return n.persistence.l_(t,e)},function(){return fu.resolve(n.d_.Fn(e))}])},Jh),Hh=(Kh.prototype.initialize=function(n){return d(this,void 0,void 0,function(){var e=this;return y(this,function(t){switch(t.label){case 0:return this.Fc=this.I_(n),this.persistence=this.R_(n),[4,this.persistence.start()];case 1:return t.sent(),this.A_=this.P_(n),this.eu=this.V_(n),this.pc=this.p_(n),this.Su=this.y_(n),this.g_=this.b_(n),this.Fc.Ga=function(t){return e.Su.Rc(t,1)},this.pc.Su=this.Su,[4,this.eu.start()];case 2:return t.sent(),[4,this.Fc.start()];case 3:return t.sent(),[4,this.pc.start()];case 4:return t.sent(),[4,this.pc.ju(this.Su.Wc)];case 5:return t.sent(),[2]}})})},Kh.prototype.b_=function(t){return new vh(this.Su)},Kh.prototype.P_=function(t){return null},Kh.prototype.V_=function(t){return new Uu(this.persistence,new mh,t.v_)},Kh.prototype.R_=function(t){return new Gh(zh.w_)},Kh.prototype.p_=function(t){var e=this;return new ch(this.eu,t.Oa,t.Sr,function(t){return e.Su.Rc(t,0)},t.platform.S_())},Kh.prototype.I_=function(t){return new lh},Kh.prototype.y_=function(t){return new yh(this.eu,this.pc,this.Fc,t.v_,t.Nc)},Kh.prototype.clearPersistence=function(t){throw new Ri(Si.FAILED_PRECONDITION,"You are using the memory-only build of Firestore. Persistence support is only available via the @firebase/firestore bundle or the firebase-firestore.js build.")},Kh),Wh=(Xh.prototype.start=function(e,n){var i=this;this.D_();var r=new Nu,o=new Nu,s=!1;return this.credentials._(function(t){if(!s)return s=!0,Ys("FirestoreClient","Initializing. user=",t.uid),i.F_(e,n,t,o).then(r.resolve,r.reject);i.Sr.Or(function(){return i.Wu(t)})}),this.Sr.Or(function(){return r.promise}),o.promise},Xh.prototype.enableNetwork=function(){var t=this;return this.D_(),this.Sr.enqueue(function(){return t.Su.enableNetwork()})},Xh.prototype.F_=function(a,h,c,f){return d(this,void 0,void 0,function(){var i,r,o,s,u=this;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,this.platform.N_(this.C_)];case 1:return i=t.sent(),r=this.platform.zo(this.C_.ii),e=i,n=this.credentials,o=new uh(e,n,r),[4,a.initialize({Sr:this.Sr,C_:this.C_,platform:this.platform,Oa:o,clientId:this.clientId,v_:c,Nc:100,L_:h})];case 2:return t.sent(),this.persistence=a.persistence,this.Fc=a.Fc,this.eu=a.eu,this.pc=a.pc,this.Su=a.Su,this.A_=a.A_,this.k_=a.g_,this.persistence.o_(function(){return d(u,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})}),f.resolve(),[3,4];case 3:if(s=t.sent(),f.reject(s),!this.O_(s))throw s;return[2,(console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),this.F_(new Hh,{M_:!1},c,f))];case 4:return[2]}var e,n})})},Xh.prototype.O_=function(t){return"FirebaseError"===t.name?t.code===Si.FAILED_PRECONDITION||t.code===Si.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},Xh.prototype.D_=function(){if(this.Sr.Kr)throw new Ri(Si.FAILED_PRECONDITION,"The client has already been terminated.")},Xh.prototype.Wu=function(t){return this.Sr.sh(),Ys("FirestoreClient","Credential Changed. Current user: "+t.uid),this.Su.Wu(t)},Xh.prototype.disableNetwork=function(){var t=this;return this.D_(),this.Sr.enqueue(function(){return t.Su.disableNetwork()})},Xh.prototype.terminate=function(){var t=this;return this.Sr.Zr(function(){return d(t,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.A_&&this.A_.stop(),[4,this.pc.yu()];case 1:return t.sent(),[4,this.Fc.yu()];case 2:return t.sent(),[4,this.persistence.yu()];case 3:return t.sent(),this.credentials.T(),[2]}})})})},Xh.prototype.waitForPendingWrites=function(){var t=this;this.D_();var e=new Nu;return this.Sr.Or(function(){return t.Su.el(e)}),e.promise},Xh.prototype.listen=function(t,e,n){var i=this;this.D_();var r=new gh(t,e,n);return this.Sr.Or(function(){return i.k_.listen(r)}),r},Xh.prototype.bu=function(t){var e=this;this.q_||this.Sr.Or(function(){return e.k_.bu(t)})},Xh.prototype.x_=function(t){var e=this;return this.D_(),this.Sr.enqueue(function(){return e.eu.Eo(t)}).then(function(t){if(t instanceof Eo)return t;if(t instanceof Io)return null;throw new Ri(Si.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},Xh.prototype.B_=function(r){var t=this;return this.D_(),this.Sr.enqueue(function(){return d(t,void 0,void 0,function(){var e,n,i;return y(this,function(t){switch(t.label){case 0:return[4,this.eu.Vo(r,!0)];case 1:return e=t.sent(),n=new ph(r,e.yo),i=n._c(e.documents),[2,n.wc(i,!1).snapshot]}})})})},Xh.prototype.write=function(t){var e=this;this.D_();var n=new Nu;return this.Sr.Or(function(){return e.Su.write(t,n)}),n.promise},Xh.prototype.ii=function(){return this.C_.ii},Xh.prototype.dl=function(t){var e=this;this.D_(),this.Sr.Or(function(){return e.k_.dl(t),Promise.resolve()})},Xh.prototype.Tl=function(t){this.q_||this.k_.Tl(t)},Object.defineProperty(Xh.prototype,"q_",{get:function(){return this.Sr.Kr},enumerable:!0,configurable:!0}),Xh.prototype.transaction=function(t){var e=this;this.D_();var n=new Nu;return this.Sr.Or(function(){return e.Su.runTransaction(e.Sr,t,n),Promise.resolve()}),n.promise},Xh),Qh=(Yh.prototype.next=function(t){this.U_(this.observer.next,t)},Yh.prototype.error=function(t){this.U_(this.observer.error,t)},Yh.prototype.Q_=function(){this.muted=!0},Yh.prototype.U_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},Yh);function Yh(t){this.observer=t,this.muted=!1}function Xh(t,e,n,i){this.platform=t,this.C_=e,this.credentials=n,this.Sr=i,this.clientId=tu.cn()}function Kh(){}function Jh(t){this.persistence=t,this.d_=null,this.T_=null}function $h(t){var e=this;return(e=Fh.call(this)||this).ho=t,e}function Zh(){this.__=[]}function tc(t){var e=this;this.s_={},this.i_=new du(0),this.n_=!1,this.n_=!0,this.vh=t(this),this.Fh=new xh(this),this.Gn=new Pu,this.Wn=new bh(this.Gn,function(t){return e.vh.r_(t)})}function ec(t){this.persistence=t,this.Gl=new su(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=Mi.min(),this.highestTargetId=0,this.Hl=0,this.Kl=new hu,this.targetCount=0,this.zl=Mu.mh()}function nc(r){return function(){if("object"==typeof r&&null!==r)for(var t=r,e=0,n=["next","error","complete"];e<n.length;e++){var i=n[e];if(i in t&&"function"==typeof t[i])return 1}}()}var ic,rc,oc=(kc.prototype.j_=function(t){switch(ar(t)){case 0:return null;case 1:return t.booleanValue;case 2:return yr(t.integerValue||t.doubleValue);case 3:return this.G_(t.timestampValue);case 4:return this.H_(t);case 5:return t.stringValue;case 6:return new ha(vr(t.bytesValue));case 7:return this.K_(t.referenceValue);case 8:return this.z_(t.geoPointValue);case 9:return this.Y_(t.arrayValue);case 10:return this.X_(t.mapValue);default:throw Js()}},kc.prototype.X_=function(t){var n=this,i={};return Zi(t.fields||{},function(t,e){i[t]=n.j_(e)}),i},kc.prototype.z_=function(t){return new Na(yr(t.latitude),yr(t.longitude))},kc.prototype.Y_=function(t){var e=this;return(t.values||[]).map(function(t){return e.j_(t)})},kc.prototype.H_=function(t){switch(this.W_){case"previous":var e=function t(e){var n=e.mapValue.fields.__previous_value__;return or(n)?t(n):n}(t);return null==e?null:this.j_(e);case"estimate":return this.G_(sr(t));default:return null}},kc.prototype.G_=function(t){var e=dr(t),n=new Vi(e.seconds,e.nanos);return this.timestampsInSnapshots?n:n.toDate()},kc.prototype.K_=function(t){var e=Ci.G(t);$s(Gs(e));var n=new ou(e.get(1),e.get(3)),i=new Ki(e.L(5));return n.isEqual(this.firestore.sa)||Xs("Document "+i+" contains a document reference within a different database ("+n.projectId+"/"+n.database+") which is not supported. It will be treated as a reference in the current database ("+this.firestore.sa.projectId+"/"+this.firestore.sa.database+") instead."),new fc(i,this.firestore,this.converter)},kc),sc=ku.fh,uc=(Rc.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},Rc),ac=(Sc.prototype.settings=function(t){zu("Firestore.settings",arguments,1),Qu("Firestore.settings","object",1,t);var e=new uc(t);if(this.ef&&!this.hf.isEqual(e))throw new Ri(Si.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.hf=e).credentials&&(this.nf=function(t){if(!t)return new ki;switch(t.type){case"gapi":var e=t.uf;return $s(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Li(e,t.V||"0");case"provider":return t.uf;default:throw new Ri(Si.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},Sc.prototype.enableNetwork=function(){return this.tf(),this.ef.enableNetwork()},Sc.prototype.disableNetwork=function(){return this.tf(),this.ef.disableNetwork()},Sc.prototype.enablePersistence=function(t){var e,n;if(this.ef)throw new Ri(Si.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var i=!1;return t&&(void 0!==t.experimentalTabSynchronization&&Xs("The 'experimentalTabSynchronization' setting will be removed. Use 'synchronizeTabs' instead."),i=null!==(n=null!==(e=t.synchronizeTabs)&&void 0!==e?e:t.experimentalTabSynchronization)&&void 0!==n&&n),this.cf(this.rf,{M_:!0,cacheSizeBytes:this.hf.cacheSizeBytes,synchronizeTabs:i})},Sc.prototype.clearPersistence=function(){return d(this,void 0,void 0,function(){var i,e=this;return y(this,function(t){if(void 0!==this.ef&&!this.ef.q_)throw new Ri(Si.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return i=new Nu,[2,(this.Z_.zr(function(){return d(e,void 0,void 0,function(){var e,n;return y(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),e=this.lf(),[4,this.rf.clearPersistence(e)];case 1:return t.sent(),i.resolve(),[3,3];case 2:return n=t.sent(),i.reject(n),[3,3];case 3:return[2]}})})}),i.promise)]})})},Sc.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(Sc.prototype,"_f",{get:function(){return this.tf(),this.ef.q_},enumerable:!0,configurable:!0}),Sc.prototype.waitForPendingWrites=function(){return this.tf(),this.ef.waitForPendingWrites()},Sc.prototype.onSnapshotsInSync=function(t){if(this.tf(),nc(t))return this.ff(t);Qu("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.ff(e)},Sc.prototype.ff=function(t){var e=this,n=new Qh({next:function(){t.next&&t.next()},error:function(t){throw Js()}});return this.ef.dl(n),function(){n.Q_(),e.ef.Tl(n)}},Sc.prototype.tf=function(){return this.ef||this.cf(new Hh,{M_:!1}),this.ef},Sc.prototype.lf=function(){return new ru(this.sa,this.if,this.hf.host,this.hf.ssl,this.hf.forceLongPolling)},Sc.prototype.cf=function(t,e){var n=this.lf();return this.ef=new Wh(Bs.nt(),n,this.nf,this.Z_),this.ef.start(t,e)},Sc.sf=function(t){if(e=t.options,!Object.prototype.hasOwnProperty.call(e,"projectId"))throw new Ri(Si.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var e,n=t.options.projectId;if(!n||"string"!=typeof n)throw new Ri(Si.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new ou(n)},Object.defineProperty(Sc.prototype,"app",{get:function(){if(!this.J_)throw new Ri(Si.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.J_},enumerable:!0,configurable:!0}),Sc.prototype.collection=function(t){return zu("Firestore.collection",arguments,1),Qu("Firestore.collection","non-empty string",1,t),this.tf(),new gc(Ci.G(t),this)},Sc.prototype.doc=function(t){return zu("Firestore.doc",arguments,1),Qu("Firestore.doc","non-empty string",1,t),this.tf(),fc.df(Ci.G(t),this)},Sc.prototype.collectionGroup=function(t){if(zu("Firestore.collectionGroup",arguments,1),Qu("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new Ri(Si.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.tf(),new yc(new No(Ci.H,t),this)},Sc.prototype.runTransaction=function(e){var n=this;return zu("Firestore.runTransaction",arguments,1),Qu("Firestore.runTransaction","function",1,e),this.tf().transaction(function(t){return e(new hc(n,t))})},Sc.prototype.batch=function(){return this.tf(),new cc(this)},Object.defineProperty(Sc,"logLevel",{get:function(){switch(Ws()){case u.DEBUG:return"debug";case u.SILENT:return"silent";default:return"error"}},enumerable:!0,configurable:!0}),Sc.setLogLevel=function(t){switch(zu("Firestore.setLogLevel",arguments,1),Qu("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":Qs(u.DEBUG);break;case"error":Qs(u.ERROR);break;case"silent":Qs(u.SILENT);break;default:throw new Ri(Si.INVALID_ARGUMENT,"Invalid log level: "+t)}},Sc.prototype.Tf=function(){return this.hf.timestampsInSnapshots},Sc),hc=(_c.prototype.get=function(t){var n=this;zu("Transaction.get",arguments,1);var i=Vc("Transaction.get",t,this.wf);return this.Ef.Ua([i.ia]).then(function(t){if(!t||1!==t.length)return Js();var e=t[0];if(e instanceof Io)return new pc(n.wf,i.ia,null,!1,!1,i.mf);if(e instanceof Eo)return new pc(n.wf,i.ia,e,!1,!1,i.mf);throw Js()})},_c.prototype.set=function(t,e,n){Wu("Transaction.set",arguments,2,3);var i=Vc("Transaction.set",t,this.wf);n=Dc("Transaction.set",n);var r=Mc(i.mf,e,"Transaction.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.wf.af.Jo(s,o,n.mergeFields):this.wf.af.Yo(s,o);return this.Ef.set(i.ia,u),this},_c.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r="string"==typeof e||e instanceof ca?(Hu("Transaction.update",arguments,3),i=Vc("Transaction.update",t,this.wf),this.wf.af.ta("Transaction.update",e,n,o)):(zu("Transaction.update",arguments,2),i=Vc("Transaction.update",t,this.wf),this.wf.af.Zo("Transaction.update",e)),this.Ef.update(i.ia,r),this},_c.prototype.delete=function(t){zu("Transaction.delete",arguments,1);var e=Vc("Transaction.delete",t,this.wf);return this.Ef.delete(e.ia),this},_c),cc=(Nc.prototype.set=function(t,e,n){Wu("WriteBatch.set",arguments,2,3),this.Af();var i=Vc("WriteBatch.set",t,this.wf);n=Dc("WriteBatch.set",n);var r=Mc(i.mf,e,"WriteBatch.set"),o=r[0],s=r[1],u=n.merge||n.mergeFields?this.wf.af.Jo(s,o,n.mergeFields):this.wf.af.Yo(s,o);return this.If=this.If.concat(u.Qo(i.ia,Fr.dt())),this},Nc.prototype.update=function(t,e,n){for(var i,r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.Af(),r="string"==typeof e||e instanceof ca?(Hu("WriteBatch.update",arguments,3),i=Vc("WriteBatch.update",t,this.wf),this.wf.af.ta("WriteBatch.update",e,n,o)):(zu("WriteBatch.update",arguments,2),i=Vc("WriteBatch.update",t,this.wf),this.wf.af.Zo("WriteBatch.update",e)),this.If=this.If.concat(r.Qo(i.ia,Fr.exists(!0))),this},Nc.prototype.delete=function(t){zu("WriteBatch.delete",arguments,1),this.Af();var e=Vc("WriteBatch.delete",t,this.wf);return this.If=this.If.concat(new Hr(e.ia,Fr.dt())),this},Nc.prototype.commit=function(){return this.Af(),this.Rf=!0,0<this.If.length?this.wf.tf().write(this.If):Promise.resolve()},Nc.prototype.Af=function(){if(this.Rf)throw new Ri(Si.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Nc),fc=(Ac.df=function(t,e,n){if(t.length%2!=0)throw new Ri(Si.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.j()+" has "+t.length);return new Ac(new Ki(t),e,n)},Object.defineProperty(Ac.prototype,"id",{get:function(){return this.ia.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"parent",{get:function(){return new gc(this.ia.path.k(),this.firestore,this.mf)},enumerable:!0,configurable:!0}),Object.defineProperty(Ac.prototype,"path",{get:function(){return this.ia.path.j()},enumerable:!0,configurable:!0}),Ac.prototype.collection=function(t){if(zu("DocumentReference.collection",arguments,1),Qu("DocumentReference.collection","non-empty string",1,t),!t)throw new Ri(Si.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=Ci.G(t);return new gc(this.ia.path.child(e),this.firestore)},Ac.prototype.isEqual=function(t){if(!(t instanceof Ac))throw ia("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.ia.isEqual(t.ia)&&this.mf===t.mf},Ac.prototype.set=function(t,e){Wu("DocumentReference.set",arguments,1,2),e=Dc("DocumentReference.set",e);var n=Mc(this.mf,t,"DocumentReference.set"),i=n[0],r=n[1],o=e.merge||e.mergeFields?this.firestore.af.Jo(r,i,e.mergeFields):this.firestore.af.Yo(r,i);return this.ef.write(o.Qo(this.ia,Fr.dt()))},Ac.prototype.update=function(t,e){for(var n,i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return n="string"==typeof t||t instanceof ca?(Hu("DocumentReference.update",arguments,2),this.firestore.af.ta("DocumentReference.update",t,e,i)):(zu("DocumentReference.update",arguments,1),this.firestore.af.Zo("DocumentReference.update",t)),this.ef.write(n.Qo(this.ia,Fr.exists(!0)))},Ac.prototype.delete=function(){return zu("DocumentReference.delete",arguments,0),this.ef.write([new Hr(this.ia,Fr.dt())])},Ac.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wu("DocumentReference.onSnapshot",arguments,1,4);var n,i={includeMetadataChanges:!1},r=0;"object"!=typeof t[r]||nc(t[r])||(na("DocumentReference.onSnapshot",i=t[r],["includeMetadataChanges"]),Ku("DocumentReference.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++);var o={includeMetadataChanges:i.includeMetadataChanges};return n=nc(t[r])?t[r]:(Qu("DocumentReference.onSnapshot","function",r,t[r]),Yu("DocumentReference.onSnapshot","function",r+1,t[r+1]),Yu("DocumentReference.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Pf(o,n)},Ac.prototype.Pf=function(t,n){var i=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var r=new Qh({next:function(t){if(n.next){var e=t.docs.get(i.ia);n.next(new pc(i.firestore,i.ia,e,t.fromCache,t.hasPendingWrites,i.mf))}},error:e}),o=this.ef.listen(No.Wt(this.ia.path),r,t);return function(){r.Q_(),i.ef.bu(o)}},Ac.prototype.get=function(n){var i=this;return Wu("DocumentReference.get",arguments,0,1),Lc("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().x_(i.ia).then(function(t){e(new pc(i.firestore,i.ia,t,!0,t instanceof Eo&&t.At,i.mf))},t):i.Vf(e,t,n)})},Ac.prototype.Vf=function(e,n,i){var r=this.Pf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),!t.exists&&t.metadata.fromCache?n(new Ri(Si.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&i&&"server"===i.source?n(new Ri(Si.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},Ac.prototype.withConverter=function(t){return new Ac(this.ia,this.firestore,t)},Ac),lc=(Tc.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},Tc),pc=(Ic.prototype.data=function(t){if(Wu("DocumentSnapshot.data",arguments,0,1),t=Oc("DocumentSnapshot.data",t),this.pf){if(this.mf){var e=new dc(this.wf,this.ia,this.pf,this.yf,this.gf);return this.mf.fromFirestore(e,t)}return new oc(this.wf,this.wf.Tf(),t.serverTimestamps,void 0).j_(this.pf.kt())}},Ic.prototype.get=function(t,e){if(Wu("DocumentSnapshot.get",arguments,1,2),e=Oc("DocumentSnapshot.get",e),this.pf){var n=this.pf.data().field(Wa("DocumentSnapshot.get",t));if(null!==n)return new oc(this.wf,this.wf.Tf(),e.serverTimestamps,this.mf).j_(n)}},Object.defineProperty(Ic.prototype,"id",{get:function(){return this.ia.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"ref",{get:function(){return new fc(this.ia,this.wf,this.mf)},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"exists",{get:function(){return null!==this.pf},enumerable:!0,configurable:!0}),Object.defineProperty(Ic.prototype,"metadata",{get:function(){return new lc(this.gf,this.yf)},enumerable:!0,configurable:!0}),Ic.prototype.isEqual=function(t){if(!(t instanceof Ic))throw ia("isEqual","DocumentSnapshot",1,t);return this.wf===t.wf&&this.yf===t.yf&&this.ia.isEqual(t.ia)&&(null===this.pf?null===t.pf:this.pf.isEqual(t.pf))&&this.mf===t.mf},Ic),dc=(n(Ec,rc=pc),Ec.prototype.data=function(t){return rc.prototype.data.call(this,t)},Ec),yc=(bc.prototype.where=function(t,e,n){zu("Query.where",arguments,3),ea("Query.where",3,n);var i,r=function(t,e){if(!t.some(function(t){return t===e}))throw new Ri(Si.INVALID_ARGUMENT,"Invalid value "+ta(e)+" provided to function Query.where() for its "+oa(2)+" argument. Acceptable values: "+t.join(", "));return e}(["<","<=","==",">=",">","array-contains","in","array-contains-any"],e),o=Wa("Query.where",t);if(o.Y()){if("array-contains"===r||"array-contains-any"===r)throw new Ri(Si.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+r+"' queries on FieldPath.documentId().");if("in"===r){this.vf(n,r);for(var s=[],u=0,a=n;u<a.length;u++){var h=a[u];s.push(this.Sf(h))}i={arrayValue:{values:s}}}else i=this.Sf(n)}else"in"!==r&&"array-contains-any"!==r||this.vf(n,r),i=this.firestore.af.ea("Query.where",n,"in"===r);var c=_o.create(o,r,i);return this.Cf(c),new bc(this.bf.Ht(c),this.firestore,this.mf)},bc.prototype.orderBy=function(t,e){var n;if(Wu("Query.orderBy",arguments,1,2),Yu("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n="asc";else{if("desc"!==e)throw new Ri(Si.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n="desc"}if(null!==this.bf.startAt)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.bf.endAt)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Wa("Query.orderBy",t),r=new Vo(i,n);return this.Df(r),new bc(this.bf.Kt(r),this.firestore,this.mf)},bc.prototype.limit=function(t){return zu("Query.limit",arguments,1),Qu("Query.limit","number",1,t),ra("Query.limit",1,t),new bc(this.bf.zt(t),this.firestore,this.mf)},bc.prototype.limitToLast=function(t){return zu("Query.limitToLast",arguments,1),Qu("Query.limitToLast","number",1,t),ra("Query.limitToLast",1,t),new bc(this.bf.Yt(t),this.firestore,this.mf)},bc.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hu("Query.startAt",arguments,1);var i=this.Ff("Query.startAt",t,e,!0);return new bc(this.bf.Xt(i),this.firestore,this.mf)},bc.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hu("Query.startAfter",arguments,1);var i=this.Ff("Query.startAfter",t,e,!1);return new bc(this.bf.Xt(i),this.firestore,this.mf)},bc.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hu("Query.endBefore",arguments,1);var i=this.Ff("Query.endBefore",t,e,!0);return new bc(this.bf.Jt(i),this.firestore,this.mf)},bc.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Hu("Query.endAt",arguments,1);var i=this.Ff("Query.endAt",t,e,!1);return new bc(this.bf.Jt(i),this.firestore,this.mf)},bc.prototype.isEqual=function(t){if(!(t instanceof bc))throw ia("isEqual","Query",1,t);return this.firestore===t.firestore&&this.bf.isEqual(t.bf)},bc.prototype.withConverter=function(t){return new bc(this.bf,this.firestore,t)},bc.prototype.Ff=function(t,e,n,i){if(ea(t,1,e),e instanceof pc){if(0<n.length)throw new Ri(Si.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var r=e;if(!r.exists)throw new Ri(Si.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Nf(r.pf,i)}var o=[e].concat(n);return this.$f(t,o,i)},bc.prototype.Nf=function(t,e){for(var n=[],i=0,r=this.bf.orderBy;i<r.length;i++){var o=r[i];if(o.field.Y())n.push(gr(this.firestore.sa,t.key));else{var s=t.field(o.field);if(or(s))throw new Ri(Si.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===s){var u=o.field.j();throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}n.push(s)}}return new Lo(n,e)},bc.prototype.$f=function(t,e,n){var i=this.bf.qt;if(e.length>i.length)throw new Ri(Si.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var r=[],o=0;o<e.length;o++){var s=e[o];if(i[o].field.Y()){if("string"!=typeof s)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.bf.le()&&-1!==s.indexOf("/"))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var u=this.bf.path.child(Ci.G(s));if(!Ki.et(u))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+u+"' is not because it contains an odd number of segments.");var a=new Ki(u);r.push(gr(this.firestore.sa,a))}else{var h=this.firestore.af.ea(t,s);r.push(h)}}return new Lo(r,n)},bc.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Wu("Query.onSnapshot",arguments,1,4);var n,i={},r=0;return"object"!=typeof t[r]||nc(t[r])||(na("Query.onSnapshot",i=t[r],["includeMetadataChanges"]),Ku("Query.onSnapshot","boolean","includeMetadataChanges",i.includeMetadataChanges),r++),n=nc(t[r])?t[r]:(Qu("Query.onSnapshot","function",r,t[r]),Yu("Query.onSnapshot","function",r+1,t[r+1]),Yu("Query.onSnapshot","function",r+2,t[r+2]),{next:t[r],error:t[r+1],complete:t[r+2]}),this.Lf(this.bf),this.Pf(i,n)},bc.prototype.Pf=function(t,e){var n=this,i=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(i=e.error.bind(e));var r=new Qh({next:function(t){e.next&&e.next(new vc(n.firestore,n.bf,t,n.mf))},error:i}),o=this.firestore.tf(),s=o.listen(this.bf,r,t);return function(){r.Q_(),o.bu(s)}},bc.prototype.Lf=function(t){if(t.ae()&&0===t.qt.length)throw new Ri(Si.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},bc.prototype.get=function(n){var i=this;return Wu("Query.get",arguments,0,1),Lc("Query.get",n),this.Lf(this.bf),new Promise(function(e,t){n&&"cache"===n.source?i.firestore.tf().B_(i.bf).then(function(t){e(new vc(i.firestore,i.bf,t,i.mf))},t):i.Vf(e,t,n)})},bc.prototype.Vf=function(e,n,i){var r=this.Pf({includeMetadataChanges:!0,Pl:!0},{next:function(t){r(),t.metadata.fromCache&&i&&"server"===i.source?n(new Ri(Si.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},bc.prototype.Sf=function(t){if("string"==typeof t){if(""===t)throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.bf.le()&&-1!==t.indexOf("/"))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.bf.path.child(Ci.G(t));if(!Ki.et(e))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return gr(this.firestore.sa,new Ki(e))}if(t instanceof fc){var n=t;return gr(this.firestore.sa,n.ia)}throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+ta(t)+".")},bc.prototype.vf=function(t,e){if(!Array.isArray(t)||0===t.length)throw new Ri(Si.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Ri(Si.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new Ri(Si.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new Ri(Si.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},bc.prototype.Cf=function(t){if(t instanceof _o){var e=["array-contains","array-contains-any"],n=["in","array-contains-any"],i=0<=e.indexOf(t.op),r=0<=n.indexOf(t.op);if(t.ue()){var o=this.bf.jt();if(null!==o&&!o.isEqual(t.field))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.bf.Gt();null!==s&&this.kf(t.field,s)}else if(r||i){var u=null;if(r&&(u=this.bf.ce(n)),null===u&&i&&(u=this.bf.ce(e)),null!=u)throw u===t.op?new Ri(Si.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new Ri(Si.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+u.toString()+"' filters.")}}},bc.prototype.Df=function(t){if(null===this.bf.Gt()){var e=this.bf.jt();null!==e&&this.kf(e,t.field)}},bc.prototype.kf=function(t,e){if(!e.isEqual(t))throw new Ri(Si.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},bc),vc=(Object.defineProperty(wc.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(wc.prototype,"empty",{get:function(){return this.Mf.docs.q()},enumerable:!0,configurable:!0}),Object.defineProperty(wc.prototype,"size",{get:function(){return this.Mf.docs.size},enumerable:!0,configurable:!0}),wc.prototype.forEach=function(e,n){var i=this;Wu("QuerySnapshot.forEach",arguments,1,2),Qu("QuerySnapshot.forEach","function",1,e),this.Mf.docs.forEach(function(t){e.call(n,i.Bf(t))})},Object.defineProperty(wc.prototype,"query",{get:function(){return new yc(this.Of,this.wf,this.mf)},enumerable:!0,configurable:!0}),wc.prototype.docChanges=function(t){t&&(na("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Ku("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Mf.hs)throw new Ri(Si.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.qf&&this.xf===e||(this.qf=function(r,e,o,s){if(o.ss.q()){var n=0;return o.docChanges.map(function(t){var e=new dc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var u=o.ss;return o.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new dc(r,t.doc.key,t.doc,o.fromCache,o.ns.has(t.doc.key),s),n=-1,i=-1;return 0!==t.type&&(n=u.indexOf(t.doc.key),u=u.delete(t.doc.key)),1!==t.type&&(i=(u=u.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Js()}}(t.type),doc:e,oldIndex:n,newIndex:i}})}(this.wf,e,this.Mf,this.mf),this.xf=e),this.qf},wc.prototype.isEqual=function(t){if(!(t instanceof wc))throw ia("isEqual","QuerySnapshot",1,t);return this.wf===t.wf&&this.Of.isEqual(t.Of)&&this.Mf.isEqual(t.Mf)&&this.mf===t.mf},wc.prototype.Bf=function(t){return new dc(this.wf,t.key,t,this.metadata.fromCache,this.Mf.ns.has(t.key),this.mf)},wc),gc=(n(mc,ic=yc),Object.defineProperty(mc.prototype,"id",{get:function(){return this.bf.path.M()},enumerable:!0,configurable:!0}),Object.defineProperty(mc.prototype,"parent",{get:function(){var t=this.bf.path.k();return t.q()?null:new fc(new Ki(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(mc.prototype,"path",{get:function(){return this.bf.path.j()},enumerable:!0,configurable:!0}),mc.prototype.doc=function(t){if(Wu("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=tu.cn()),Qu("CollectionReference.doc","non-empty string",1,t),""===t)throw new Ri(Si.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=Ci.G(t);return fc.df(this.bf.path.child(e),this.firestore,this.mf)},mc.prototype.add=function(t){zu("CollectionReference.add",arguments,1),Qu("CollectionReference.add","object",1,this.mf?this.mf.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},mc.prototype.withConverter=function(t){return new mc(this.Uf,this.firestore,t)},mc);function mc(t,e,n){var i=this;if(((i=ic.call(this,No.Wt(t),e,n)||this).Uf=t).length%2!=1)throw new Ri(Si.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.j()+" has "+t.length);return i}function wc(t,e,n,i){this.wf=t,this.Of=e,this.Mf=n,this.mf=i,this.qf=null,this.xf=null,this.metadata=new lc(n.hasPendingWrites,n.fromCache)}function bc(t,e,n){this.bf=t,this.firestore=e,this.mf=n}function Ec(){return null!==rc&&rc.apply(this,arguments)||this}function Ic(t,e,n,i,r,o){this.wf=t,this.ia=e,this.pf=n,this.yf=i,this.gf=r,this.mf=o}function Tc(t,e){this.hasPendingWrites=t,this.fromCache=e}function Ac(t,e,n){this.ia=t,this.firestore=e,this.mf=n,this.ef=this.firestore.tf()}function Nc(t){this.wf=t,this.If=[],this.Rf=!1}function _c(t,e){this.wf=t,this.Ef=e}function Sc(t,e,n){var i=this;if(void 0===n&&(n=new Hh),this.J_=null,this.Z_=new Ru,this.INTERNAL={delete:function(){return d(i,void 0,void 0,function(){return y(this,function(t){switch(t.label){case 0:return this.tf(),[4,this.ef.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.J_=r,this.sa=Sc.sf(r),this.if=r.name,this.nf=new Di(e)}else{var o=t;if(!o.projectId)throw new Ri(Si.INVALID_ARGUMENT,"Must provide projectId");this.sa=new ou(o.projectId,o.database),this.if="[DEFAULT]",this.nf=new ki}this.rf=n,this.hf=new uc({}),this.af=new qa(this.sa)}function Rc(t){var e,n;if(void 0===t.host){if(void 0!==t.ssl)throw new Ri(Si.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Xu("settings","non-empty string","host",t.host),this.host=t.host,Ku("settings","boolean","ssl",t.ssl),this.ssl=null===(e=t.ssl)||void 0===e||e;if(na("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Ku("settings","object","credentials",t.credentials),this.credentials=t.credentials,Ku("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?Xs("The setting 'timestampsInSnapshots: true' is no longer required and should be removed."):!1===t.timestampsInSnapshots&&Xs("Support for 'timestampsInSnapshots: false' will be removed soon. You must update your code to handle Timestamp objects."),this.timestampsInSnapshots=null===(n=t.timestampsInSnapshots)||void 0===n||n,Ku("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=ku.Th;else{if(t.cacheSizeBytes!==sc&&t.cacheSizeBytes<ku.dh)throw new Ri(Si.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+ku.dh);this.cacheSizeBytes=t.cacheSizeBytes}Ku("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}function kc(t,e,n,i){this.firestore=t,this.timestampsInSnapshots=e,this.W_=n,this.converter=i}function Dc(t,e){if(void 0===e)return{merge:!1};if(na(t,e,["merge","mergeFields"]),Ku(t,"boolean","merge",e.merge),n=t,void 0!==(i=e.mergeFields)&&function(t,e,n,i){if(!(n instanceof Array))throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+ta(n));for(var r=0;r<n.length;++r)if(!i(n[r]))throw new Ri(Si.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be a string or a FieldPath, but the value at index "+r+" was: "+ta(n[r]))}(n,"mergeFields",i,function(t){return"string"==typeof t||t instanceof ca}),void 0!==e.mergeFields&&void 0!==e.merge)throw new Ri(Si.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');var n,i;return e}function Oc(t,e){return void 0===e?{}:(na(t,e,["serverTimestamps"]),Ju(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Lc(t,e){Yu(t,"object",1,e),e&&(na(t,e,["source"]),Ju(t,0,"source",e.source,["default","server","cache"]))}function Vc(t,e,n){if(e instanceof fc){if(e.firestore!==n)throw new Ri(Si.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw ia(t,"DocumentReference",1,e)}function Mc(t,e,n){var i;return t?(i=t.toFirestore(e),n="toFirestore() in "+n):i=e,[i,n]}function Pc(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new Ri(Si.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}var Cc,Uc=Pc(ac,"Use firebase.firestore() instead."),jc=Pc(hc,"Use firebase.firestore().runTransaction() instead."),qc=Pc(cc,"Use firebase.firestore().batch() instead."),Fc=Pc(fc,"Use firebase.firestore().doc() instead."),xc=Pc(pc),Gc=Pc(dc),Bc=Pc(yc),zc=Pc(vc),Hc=Pc(gc,"Use firebase.firestore().collection() instead."),Wc=Pc((sf.delete=function(){return Bu("FieldValue.delete",arguments),new ba},sf.serverTimestamp=function(){return Bu("FieldValue.serverTimestamp",arguments),new Ea},sf.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hu("FieldValue.arrayUnion",arguments,1),new Ia(t)},sf.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Hu("FieldValue.arrayRemove",arguments,1),new Ta(t)},sf.increment=function(t){return Qu("FieldValue.increment","number",1,t),zu("FieldValue.increment",arguments,1),new Aa(t)},sf.prototype.isEqual=function(t){return this===t},sf),"Use FieldValue.<field>() instead."),Qc=Pc(ha,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),Yc={Firestore:Uc,GeoPoint:Na,Timestamp:Vi,Blob:Qc,Transaction:jc,WriteBatch:qc,DocumentReference:Fc,DocumentSnapshot:xc,Query:Bc,QueryDocumentSnapshot:Gc,QuerySnapshot:zc,CollectionReference:Hc,FieldPath:ca,FieldValue:Wc,setLogLevel:ac.setLogLevel,CACHE_SIZE_UNLIMITED:sc},Xc=(of.prototype.ou=function(t){},of.prototype.yu=function(){},of),Kc=(rf.prototype.ou=function(t){this.Hf.push(t)},rf.prototype.yu=function(){window.removeEventListener("online",this.Qf),window.removeEventListener("offline",this.jf)},rf.prototype.Kf=function(){window.addEventListener("online",this.Qf),window.addEventListener("offline",this.jf)},rf.prototype.Wf=function(){Ys("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.Hf;t<e.length;t++)(0,e[t])(0)},rf.prototype.Gf=function(){Ys("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.Hf;t<e.length;t++)(0,e[t])(1)},rf.zf=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},rf),Jc=(nf.prototype.Va=function(t){this.Jf=t},nf.prototype.ma=function(t){this.Zf=t},nf.prototype.onMessage=function(t){this.td=t},nf.prototype.close=function(){this.Xf()},nf.prototype.send=function(t){this.Yf(t)},nf.prototype.ed=function(){this.Jf()},nf.prototype.sd=function(t){this.Zf(t)},nf.prototype.nd=function(t){this.td(t)},nf),$c={BatchGetDocuments:"batchGet",Commit:"commit"},Zc="gl-js/ fire/"+Ei,tf=(ef.prototype.hd=function(t,e){if(e)for(var n in e.o)e.o.hasOwnProperty(n)&&(t[n]=e.o[n]);t["X-Goog-Api-Client"]=Zc},ef.prototype.La=function(a,i,r){var h=this,c=this.od(a);return new Promise(function(o,s){var u=new bi;u.listenOnce(mi.COMPLETE,function(){try{switch(u.getLastErrorCode()){case gi.NO_ERROR:var t=u.getResponseJson();Ys("Connection","XHR received:",JSON.stringify(t)),o(t);break;case gi.TIMEOUT:Ys("Connection",'RPC "'+a+'" timed out'),s(new Ri(Si.DEADLINE_EXCEEDED,"Request time out"));break;case gi.HTTP_ERROR:var e=u.getStatus();if(Ys("Connection",'RPC "'+a+'" failed with status:',e,"response text:",u.getResponseText()),0<e){var n=u.getResponseJson().error;if(n&&n.status&&n.message){var i=(r=n.status.toLowerCase().replace("_","-"),0<=Object.values(Si).indexOf(r)?r:Si.UNKNOWN);s(new Ri(i,n.message))}else s(new Ri(Si.UNKNOWN,"Server responded with status "+u.getStatus()))}else Ys("Connection",'RPC "'+a+'" failed'),s(new Ri(Si.UNAVAILABLE,"Connection failed."));break;default:Js()}}finally{Ys("Connection",'RPC "'+a+'" completed.')}var r});var t=Object.assign({},i);delete t.database;var e=JSON.stringify(t);Ys("Connection","XHR sending: ",c+" "+e);var n={"Content-Type":"text/plain"};h.hd(n,r),u.send(c,"POST",e,n,15)})},ef.prototype.ka=function(t,e,n){return this.La(t,e,n)},ef.prototype.pa=function(t,e){var n,i,r=[this.rd,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=vi(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.ii.projectId+"/databases/"+this.ii.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.hd(s.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(i=p()).indexOf("MSIE ")||0<=i.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(s.httpHeadersOverwriteParam="$httpHeaders");var u=r.join("");function a(t,e){h.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}Ys("Connection","Creating WebChannel: "+u+" "+s);var h=o.createWebChannel(u,s),c=!1,f=!1,l=new Jc({Yf:function(t){f?Ys("Connection","Not sending because WebChannel is closed:",t):(c||(Ys("Connection","Opening WebChannel transport."),h.open(),c=!0),Ys("Connection","WebChannel sending:",t),h.send(t))},Xf:function(){return h.close()}});return a(wi.EventType.OPEN,function(){f||Ys("Connection","WebChannel transport opened.")}),a(wi.EventType.CLOSE,function(){f||(f=!0,Ys("Connection","WebChannel transport closed"),l.sd())}),a(wi.EventType.ERROR,function(t){f||(f=!0,Ys("Connection","WebChannel transport errored:",t),l.sd(new Ri(Si.UNAVAILABLE,"The operation could not be completed")))}),a(wi.EventType.MESSAGE,function(t){var e;if(!f){var n=t.data[0];$s(!!n);var i=n.error||(null===(e=n[0])||void 0===e?void 0:e.error);if(i){Ys("Connection","WebChannel received error:",i);var r=i.status,o=function(){var t=ho[r];if(void 0!==t)return Ko(t)}(),s=i.message;void 0===o&&(o=Si.INTERNAL,s="Unknown error status: "+r+" with message "+i.message),f=!0,l.sd(new Ri(o,s)),h.close()}else Ys("Connection","WebChannel received:",n),l.nd(n)}}),setTimeout(function(){l.ed()},0),l},ef.prototype.od=function(t){var e=$c[t];return this.rd+"/v1/projects/"+this.ii.projectId+"/databases/"+this.ii.database+"/documents:"+e},ef);function ef(t){this.ii=t.ii;var e=t.ssl?"https":"http";this.rd=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function nf(t){this.Yf=t.Yf,this.Xf=t.Xf}function rf(){var t=this;this.Qf=function(){return t.Wf()},this.jf=function(){return t.Gf()},this.Hf=[],this.Kf()}function of(){}function sf(){}function uf(){this.Co="undefined"!=typeof atob}Bs.an((Object.defineProperty(uf.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(uf.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),uf.prototype.N_=function(t){return Promise.resolve(new tf(t))},uf.prototype.S_=function(){return new(Kc.zf()?Kc:Xc)},uf.prototype.zo=function(t){return new Fs(t,{hi:!0})},uf.prototype.un=function(t){return JSON.stringify(t)},uf.prototype.atob=function(t){return atob(t)},uf.prototype.btoa=function(t){return btoa(t)},uf.prototype.ln=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e)e.getRandomValues(n);else for(var i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n},new uf)),(Cc=af).INTERNAL.registerComponent(new E("firestore",function(t){return e=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),new ac(e,n,new Hh);var e,n},"PUBLIC").setServiceProps(Object.assign({},Yc))),Cc.registerVersion("@firebase/firestore","1.14.3")}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.memory.js - be sure to load firebase-app.js first.")}});
//# sourceMappingURL=firebase-firestore.memory.js.map
